{"version":3,"file":"editor.js","mappings":";;;;;;;;;;;;;;;;;;AAAmD;;AAEnD;AACA;AACA;AACkD;AAClD,cAAc,iEAAa,CAAC,sDAAG;AAC/B;AACA;AACA,CAAC,EAAE,iEAAa,CAAC,uDAAI;AACrB;AACA,CAAC;AACD,iEAAe,KAAK,EAAC;AACrB;;;;;;;;;;;;;;;;;;;ACbmD;;AAEnD;AACA;AACA;AACkD;AAClD,gBAAgB,iEAAa,CAAC,sDAAG;AACjC;AACA;AACA,CAAC,EAAE,iEAAa,CAAC,uDAAI;AACrB;AACA,CAAC;AACD,iEAAe,OAAO,EAAC;AACvB;;;;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,gBAAgB;;AAEhB;AACA;;AAEA,kBAAkB,sBAAsB;AACxC;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAK,KAA6B;AAClC;AACA;AACA,GAAG,SAAS,IAA4E;AACxF;AACA,EAAE,iCAAqB,EAAE,mCAAE;AAC3B;AACA,GAAG;AAAA,kGAAC;AACJ,GAAG,KAAK,EAEN;AACF,CAAC;;;;;;;;;;;ACzDD;;AAEA;AACA;AACA;;AAEA,kBAAkB;AAClB,YAAY;AACZ,YAAY;AACZ,iBAAiB;AACjB,eAAe;AACf,eAAe;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,4CAA4C;;AAEvD;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA,iBAAiB,mBAAO,CAAC,0FAAU;;AAEnC,OAAO,YAAY;;AAEnB;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;;;;AC3QA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mBAAO,CAAC,yEAAI;AACpC;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,eAAe;AAC3B;AACA;AACA;AACA;;AAEA,kBAAkB,sBAAsB;AACxC;AACA,cAAc;AACd;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uCAAuC;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,cAAc,SAAS;AACvB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;;AAEA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;;;;;;;;ACjRA;AACA;AACA;AACA;AACA,eAAe,KAAoD,oBAAoB,CAAkH,CAAC,kBAAkB,aAAa,mBAAmB,KAAK,yIAAyI,QAAQ,0HAA0H,IAAI,qIAAqI,IAAI,iCAAiC,cAAc,yGAAyG,UAAU,kDAAkD,+IAA+I,4FAA4F,oZAAoZ,sDAAsD,KAAK,2EAA2E,2BAA2B,mMAAmM,wOAAwO,oEAAoE,yDAAyD,kGAAkG,yCAAyC,WAAW,6BAA6B,mBAAmB,eAAe,GAAG;AAC74E;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,KAA4D;AAChE;AACA,UAAU,CACiC;AAC3C,CAAC;AACD;AACA;AACA,iBAAiB,MAAM,mBAAmB,MAAM;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,OAAO;AAC/C;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA,iCAAiC,IAAI;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,EAAE,wBAAwB,EAAE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C,6BAA6B,IAAI;AACjC;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,QAAQ,KAA6B;AACrC,QAAQ,qBAAqB;AAC7B;AACA,aAAa,IAA0C;AACvD;AACA,QAAQ,iCAAO,EAAE,mCAAE,YAAY,sBAAsB;AAAA,kGAAC;AACtD;AACA;AACA,YAAY;AACZ,CAAC;;;;;;;;;;;;;;;;ACrOD;AACA,iEAAe,CAAC,iFAAiF;;;;;;;;;;;;ACDjG;;;;;;;;;;;;;ACAA;;;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACjKa;;AAEb;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;;;;;;;;;;;;ACrHA;;AAEb;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,QAAQ;AACnB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;ACrCA;AACA;AACA;AACA;AAEO,MAAME,cAAc,gBAC1B,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B8C,CAuC9C;;EACA,MAAMuF,KAAK,GAAG,EAAd;;EACA,IAAK3B,QAAQ,IAAIA,QAAQ,CAAC2F,MAAT,GAAkB,CAA9B,IAAmC,WAAW3F,QAAnD,EAA8D;IAC7D2B,KAAK,CAAC3B,QAAN,GAAiBA,QAAjB;IACA2B,KAAK,CAACO,MAAN,GAAe,MAAf;EACA;;EAED,oBACC,gMAAa2H,UAAb;IAA0B,KAAK,EAAGlI;EAAlC,iBACC;IAAK,SAAS,EAAC;EAAf,GACI,KAAKkH,aAAe;EAAI;EAD5B,CADD,EAKG,CAAExK,qEAAA,CAAkB4B,OAAlB,CAAF,iBACD,oBAAC,qEAAD;IAAkB,OAAO,EAAC,YAA1B;IAAuC,KAAK,EAAGA;EAA/C,EANF,CADD;AAWA;;;;;;;;;;;;;;;AC1ED,MAAMuP,SAAS,GAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CArIA;AAuIA,iEAAelQ,GAAG,CAACC,eAAJ,CAAqB,IAAIN,IAAJ,CAAU,CAAEuQ,SAAF,CAAV,EAAyB;EAAEpQ,IAAI,EAAE;AAAR,CAAzB,CAArB,CAAf;;;;;;;;;;;;;;;;;ACvIA;AAEO,MAAMmJ,gBAAgB,GAAG,CAC/BxB,IAD+B,WAe3B;EAAA,IAbJ;IACC1M,QADD;IAECG,QAFD;IAGCF,IAHD;IAICC,KAJD;IAKCE,WALD;IAMC2B,MAND;IAOC1B,OAPD;IAQC8C,YARD;IASCE,kBATD;IAUCD,mBAVD;IAWC9C;EAXD,CAaI;;EACJ,IAAK,CAAEoM,IAAP,EAAc;IACb,OAAO,IAAP;EACA,CAHG,CAKJ;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;EACA,MAAM2I,OAAO,GAAG;IACfC,cAAc,EAAE,IADD;IAEfC,KAAK,EAAE,IAFQ;IAGf,IAAKvV,QAAQ,IAAI;MAAEwV,QAAQ,EAAE;IAAZ,CAAjB,CAHe;IAIf,IAAK,CAAErV,QAAF,IAAc;MAAEA,QAAQ,EAAE;IAAZ,CAAnB,CAJe;IAKf,IAAKF,IAAI,IAAI;MAAEA,IAAI,EAAE;IAAR,CAAb,CALe;IAMf,IAAKC,KAAK,IAAI;MAAEA,KAAK,EAAE,IAAT;MAAeuV,aAAa,EAAE;IAA9B,CAAd,CANe;IAOf,IAAKrV,WAAW,IAAI;MAAEA,WAAW,EAAE;IAAf,CAApB,CAPe;IAQf,IAAK2B,MAAM,IAAI;MAAE2T,SAAS,EAAE3T;IAAb,CAAf,CARe;IASf,IAAK1B,OAAO,KAAK,MAAZ,IAAsB;MAAEsV,cAAc,EAAEtV;IAAlB,CAA3B,CATe;IAUf,IAAK8C,YAAY,KAAK,EAAjB,IAAuB;MAAEyS,GAAG,EAAEzS;IAAP,CAA5B,CAVe;IAWf,IAAKE,kBAAkB,KAAK,EAAvB,IAA6B;MAAEwS,IAAI,EAAExS;IAAR,CAAlC,CAXe;IAYf,IAAKD,mBAAmB,KAAK,EAAxB,IAA8B;MAAE0S,IAAI,EAAE1S;IAAR,CAAnC,CAZe;IAaf,IAAK9C,eAAe,IAAI;MAAEA,eAAe,EAAE;IAAnB,CAAxB;EAbe,CAAhB;EAeA,OAAO8U,4DAAY,CAAG,4BAA4B1I,IAAM,EAArC,EAAwC2I,OAAxC,CAAnB;AACA,CA5CM;;;;;;;;;;;;;;;;;;;ACFP,kDAAkD,0CAA0C;;AAE5F,4CAA4C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD;;AAE/P,8DAA8D,sEAAsE,8DAA8D;;AAEtJ;AACR;AACA;AACY;;AAEhD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,sDAAS;AACnB,eAAe,4DAAe;AAC9B;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA,6BAA6B;AAC7B;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;;AAEA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;;AAGR;;AAEA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,UAAU,0DAAa;AACvB,eAAe,sDAAS;AACxB;AACA,SAAS;AACT;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;;;;;;;;;;;;;;;;;AChN2C,CAAC;;AAE7C;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,QAAQ;AACnB,WAAW,UAAU;AACrB;;AAEe;AACf,MAAM,0DAAa;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAkB,gBAAgB;AAClC;;AAEA;AACA,kBAAkB;AAClB;;AAEA;AACA;;;;;;;;;;;;;;;ACvCA,kDAAkD,0CAA0C;;AAE5F,4CAA4C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD;;AAE/P,8DAA8D,sEAAsE,8DAA8D;;AAElM;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAEkC;;AAEnC;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjJD,wBAAwB,2BAA2B,2EAA2E,kCAAkC,wBAAwB,OAAO,kCAAkC,mIAAmI;;AAEpW,kDAAkD,0CAA0C;;AAE5F,4CAA4C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD;;AAE/P,8DAA8D,sEAAsE,8DAA8D;;AAElM,2CAA2C,+DAA+D,6EAA6E,yEAAyE,eAAe,uDAAuD,GAAG;;AAEzU,iCAAiC,4EAA4E,iBAAiB,aAAa;;AAE3I,iCAAiC,qBAAqB,8CAA8C,mCAAmC,mDAAmD,2DAA2D,OAAO,yCAAyC;;AAErS,kDAAkD,0EAA0E,eAAe;;AAE3I,wCAAwC,uBAAuB,yFAAyF;;AAExJ,uCAAuC,wEAAwE,0CAA0C,8CAA8C,MAAM,uEAAuE,IAAI,eAAe,YAAY;;AAEnT,8BAA8B,gGAAgG,mDAAmD;;AAEjL,2CAA2C,gCAAgC,oCAAoC,oDAAoD,8DAA8D,iEAAiE,GAAG,kCAAkC;;AAEvU,iCAAiC,gBAAgB,sBAAsB,OAAO,uDAAuD,aAAa,uDAAuD,4CAA4C,KAAK,6CAA6C,6EAA6E,OAAO,iDAAiD,mFAAmF,OAAO;;AAEtgB,4CAA4C,kBAAkB,kCAAkC,oEAAoE,KAAK,OAAO,oBAAoB;;AAEpM;AACmC;AACY;AACJ;AACuB;AAC9B;AACE;AACE;;AAExC,qCAAqC,EAAE,8DAAyB;AAChE,iBAAiB,kDAAS;AAC1B,kBAAkB,mDAAU;AAC5B,cAAc,qDAAY,OAAO,6DAAoB,SAAS,uDAAc;AAC5E,eAAe,oDAAW;AAC1B,CAAC;;AAED;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,8BAA8B,oBAAoB;AAClD;AACA;;AAEA;AACA;AACA;AACA,gCAAgC,oBAAoB;AACpD,aAAa,yDAAoB;AACjC;AACA,GAAG;;AAEH;AACA,CAAC,CAAC,+CAAU;;AAEZ;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACzEA;AACA;AACA;;AAEA,iEAAe,SAAS;;;;;;;;;;;;;;;ACJxB;AACA;AACA;;AAEA,iEAAe,aAAa;;;;;;;;;;;;;;;ACJ5B;AACA;AACA;AACA;AACA;AACe;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;;;;ACtBA,kDAAkD,0CAA0C;;AAE5F,4CAA4C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD;;AAE/P,8DAA8D,sEAAsE,8DAA8D;;AAElM;AACA;;AAEA;AACA,yCAAyC;AACzC;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEO;AACA;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,sBAAsB,yBAAyB;AAC/C;;AAEA;;AAEA;AACA;AACA;AACA;AACA,UAAU,WAAW;AACrB;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;;;;;;;;;;;;;;ACpFD,wBAAwB,2BAA2B,2EAA2E,kCAAkC,wBAAwB,OAAO,kCAAkC,mIAAmI;;AAEpW,kDAAkD,0CAA0C;;AAE5F,2CAA2C,+DAA+D,6EAA6E,yEAAyE,eAAe,uDAAuD,GAAG;;AAEzU,iCAAiC,qBAAqB,8CAA8C,mCAAmC,mDAAmD,2DAA2D,OAAO,yCAAyC;;AAErS,kDAAkD,0EAA0E,eAAe;;AAE3I,wCAAwC,uBAAuB,yFAAyF;;AAExJ,mCAAmC,gEAAgE,sDAAsD,+DAA+D,mCAAmC,6EAA6E,qCAAqC,iDAAiD,8BAA8B,qBAAqB,0EAA0E,qDAAqD,eAAe,yEAAyE,GAAG,2CAA2C;;AAEttB,2CAA2C,mCAAmC,kCAAkC,OAAO,wDAAwD,gBAAgB,uBAAuB,kDAAkD,kCAAkC,uDAAuD,sBAAsB;;AAEvX,uCAAuC,wEAAwE,0CAA0C,8CAA8C,MAAM,uEAAuE,IAAI,eAAe,YAAY;;AAEnT,iCAAiC;;AAEjC,iCAAiC,4EAA4E,iBAAiB,aAAa;;AAE3I,8BAA8B,gGAAgG,mDAAmD;;AAEjL;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC;;AAED,iEAAe,aAAa;;;;;;;;;;;;;;;;AC/D5B;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACA;;;;;;;;;;;;;;;ACRA,kDAAkD,0CAA0C;;AAE5F,4CAA4C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD;;AAE/P,8DAA8D,sEAAsE,8DAA8D;;AAElM;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;;;;;;;;;;;;;;;;;;;;;;;ACnCD,2CAA2C,gCAAgC,oCAAoC,oDAAoD,8DAA8D,iEAAiE,GAAG,kCAAkC;;AAEvU,iCAAiC,gBAAgB,sBAAsB,OAAO,uDAAuD,aAAa,uDAAuD,4CAA4C,KAAK,6CAA6C,6EAA6E,OAAO,iDAAiD,mFAAmF,OAAO;;AAEtgB,4CAA4C,kBAAkB,kCAAkC,oEAAoE,KAAK,OAAO,oBAAoB;;AAEpM,kDAAkD,0CAA0C;;AAE5F,4CAA4C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD;;AAE/P,8DAA8D,sEAAsE,8DAA8D;;AAElM;AACmC;AACP;AACQ;AACL;AACL;AAC1B;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,6HAA6H;AAC7H,MAAM;;;AAGN,4BAA4B;;AAE5B,gDAAgD;;AAEhD,sBAAsB;;AAEtB,qBAAqB;;AAErB,sBAAsB;;AAEtB,8BAA8B;;AAE9B,gCAAgC;;AAEhC,yBAAyB;;AAEzB,2BAA2B;;AAE3B,uBAAuB;AACvB;AACA;;AAEA,yBAAyB;;AAEzB,4BAA4B;;AAE5B,+BAA+B;;AAE/B,iCAAiC;AACjC;;AAEA,kCAAkC;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,cAAc,SAAS;AACvB;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,UAAU,4CAAG;AACb,UAAU;AACV,UAAU,4CAAG;AACb;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,OAAO;AACP,iCAAiC;AACjC;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,yHAAyH;AACzH;;AAEA,8FAA8F;;AAE9F,0DAA0D;AAC1D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,uCAAuC;AACvC;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;AACA;AACA,gEAAgE;;AAEhE;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;;AAEb;AACA,4BAA4B;;AAE5B;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP,eAAe;AACf;;AAEA;AACA;AACA,8CAA8C,iDAAiD;;AAE/F;;AAEA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,QAAQ,4CAAG;;AAEX;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;;;AAGA,6BAA6B;;AAE7B;AACA,QAAQ,4CAAG;;AAEX;;AAEA;AACA,QAAQ;;;AAGR;AACA,QAAQ,4CAAG;AACX;;AAEA;;AAEA;AACA,QAAQ;;;AAGR,MAAM,4CAAG;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB,gBAAgB,SAAS;AACzB;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,8FAA8F;AAC9F,QAAQ;;;AAGR;AACA;AACA;AACA,SAAS;AACT,QAAQ;;;AAGR;AACA;;AAEA;AACA;;AAEA,4BAA4B;;AAE5B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,0BAA0B,8CAAa;AACvC;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,iCAAiC;;AAEjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA,eAAe,QAAQ;AACvB;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;;;AAGR;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,QAAQ,4CAAG;;AAEX;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,UAAU;AACV;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;;AAGA;AACA,8EAA8E;;AAE9E;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;;;AAGZ;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAU;AACV;;;AAGA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe;AACf;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,wEAAwE;AACxE;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,kGAAkG;AAClG,QAAQ;AACR,wDAAwD;;;AAGxD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB,8CAAa;AAC/B,OAAO;AACP,6BAA6B,8CAAa;AAC1C,oBAAoB,8CAAa;AACjC;;AAEA;AACA;AACA,UAAU;AACV;AACA;;;AAGA;AACA;;AAEA,yCAAyC;AACzC;AACA,SAAS;;AAET;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;;AAEA;AACA,4CAA4C,oDAAa;AACzD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oBAAoB,iDAAI;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,aAAa,kDAAG;AAChB;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,UAAU;AACrB,YAAY;AACZ;AACA;;;AAGA;AACA;AACA;;AAEA,kBAAkB,eAAe;AACjC;AACA;AACA;AACA,KAAK;AACL;;AAEA,wCAAwC;;AAExC;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA,iEAAe,UAAU;;;;;;;;;;;;;;;AC5kCzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACe;AACf;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;AClBa;;AAEb,eAAe,mBAAO,CAAC,0GAAe;AACtC,SAAS,mBAAO,CAAC,6GAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,eAAe;;AAEf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA,kBAAkB,MAAM,8BAA8B,MAAM;AAC5D;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yDAAyD;AACzD,IAAI;AACJ,sCAAsC;AACtC;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,QAAQ;AACtB,cAAc,SAAS;AACvB,cAAc,QAAQ;AACtB;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,eAAe;AAC1B,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,yBAAyB;AAClC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA,aAAa,KAAK;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA,kBAAkB,kBAAkB;AACpC;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,UAAU;AACrB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC5kBA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA,kCAAkC,yBAAyB,SAAS,yBAAyB;;;;;;;;;;ACf7F;AACA;AACA,oBAAoB,sBAAsB;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG,EAAE,yBAAyB,SAAS,yBAAyB;AAChE;AACA;;AAEA,2BAA2B,yBAAyB,SAAS,yBAAyB;;;;;;;;;;;;;;;;;UCjBtF;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;ACNA;AACA;AACA","sources":["webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/@wordpress+icons@9.3.0/node_modules/@wordpress/icons/build-module/library/image.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/@wordpress+icons@9.3.0/node_modules/@wordpress/icons/build-module/library/link-off.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/classnames@2.3.1/node_modules/classnames/index.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/common.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/filesize@8.0.6/node_modules/filesize/lib/filesize.min.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/js-base64@2.6.4/node_modules/js-base64/base64.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/poster-image-block-control/style.module.scss?fc60","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/videopress-uploader/style.scss?998c","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/editor.scss?153a","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/style.scss?8dfc","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/ms@2.1.2/node_modules/ms/index.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/querystringify@2.2.0/node_modules/querystringify/index.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/requires-port@1.0.0/node_modules/requires-port/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/icons/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/inspector-controls.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/poster-image-block-control/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/seekbar-color-settings.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/videopress-player/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/components/videopress-uploader/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/edit.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/hooks/use-uploader.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/save.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/scripts/vp-block-bridge/index.js","webpack://@automattic/jetpack-videopress/./src/client/block-editor/blocks/videopress/utils/url.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/fileReader.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/fingerprint.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/httpStack.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/index.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/isCordova.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/isReactNative.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/readAsByteArray.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/uriToBlob.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/browser/urlStorage.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/error.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/logger.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/noopUrlStorage.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/upload.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/tus-js-client@2.3.0/node_modules/tus-js-client/lib.esm/uuid.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/url-parse@1.5.10/node_modules/url-parse/index.js","webpack://@automattic/jetpack-videopress/external window \"React\"","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"blockEditor\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"blocks\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"components\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"coreData\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"data\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"element\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"escapeHtml\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"i18n\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"primitives\"]","webpack://@automattic/jetpack-videopress/external window [\"wp\",\"url\"]","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/@babel+runtime@7.18.6/node_modules/@babel/runtime/helpers/defineProperty.js","webpack://@automattic/jetpack-videopress/../../../node_modules/.pnpm/@babel+runtime@7.18.6/node_modules/@babel/runtime/helpers/extends.js","webpack://@automattic/jetpack-videopress/webpack/bootstrap","webpack://@automattic/jetpack-videopress/webpack/runtime/compat get default export","webpack://@automattic/jetpack-videopress/webpack/runtime/define property getters","webpack://@automattic/jetpack-videopress/webpack/runtime/hasOwnProperty shorthand","webpack://@automattic/jetpack-videopress/webpack/runtime/make namespace object","webpack://@automattic/jetpack-videopress/./src/client/block-editor/index.js"],"sourcesContent":["import { createElement } from \"@wordpress/element\";\n\n/**\n * WordPress dependencies\n */\nimport { Path, SVG } from '@wordpress/primitives';\nconst image = createElement(SVG, {\n  viewBox: \"0 0 24 24\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, createElement(Path, {\n  d: \"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z\"\n}));\nexport default image;\n//# sourceMappingURL=image.js.map","import { createElement } from \"@wordpress/element\";\n\n/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nconst linkOff = createElement(SVG, {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0 0 24 24\"\n}, createElement(Path, {\n  d: \"M15.6 7.3h-.7l1.6-3.5-.9-.4-3.9 8.5H9v1.5h2l-1.3 2.8H8.4c-2 0-3.7-1.7-3.7-3.7s1.7-3.7 3.7-3.7H10V7.3H8.4c-2.9 0-5.2 2.3-5.2 5.2 0 2.9 2.3 5.2 5.2 5.2H9l-1.4 3.2.9.4 5.7-12.5h1.4c2 0 3.7 1.7 3.7 3.7s-1.7 3.7-3.7 3.7H14v1.5h1.6c2.9 0 5.2-2.3 5.2-5.2 0-2.9-2.4-5.2-5.2-5.2z\"\n}));\nexport default linkOff;\n//# sourceMappingURL=link-off.js.map","/*!\n  Copyright (c) 2018 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString === Object.prototype.toString) {\n\t\t\t\t\tfor (var key in arg) {\n\t\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\t\tlet namespacesCache;\n\t\tlet enabledCache;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => {\n\t\t\t\tif (enableOverride !== null) {\n\t\t\t\t\treturn enableOverride;\n\t\t\t\t}\n\t\t\t\tif (namespacesCache !== createDebug.namespaces) {\n\t\t\t\t\tnamespacesCache = createDebug.namespaces;\n\t\t\t\t\tenabledCache = createDebug.enabled(namespace);\n\t\t\t\t}\n\n\t\t\t\treturn enabledCache;\n\t\t\t},\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\t\tcreateDebug.namespaces = namespaces;\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.slice(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","/*!\n 2021 Jason Mulligan <jason.mulligan@avoidwork.com>\n @version 8.0.6\n*/\n!function(i,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(i=\"undefined\"!=typeof globalThis?globalThis:i||self).filesize=t()}(this,(function(){\"use strict\";var i=/^(b|B)$/,t={iec:{bits:[\"bit\",\"Kibit\",\"Mibit\",\"Gibit\",\"Tibit\",\"Pibit\",\"Eibit\",\"Zibit\",\"Yibit\"],bytes:[\"B\",\"KiB\",\"MiB\",\"GiB\",\"TiB\",\"PiB\",\"EiB\",\"ZiB\",\"YiB\"]},jedec:{bits:[\"bit\",\"Kbit\",\"Mbit\",\"Gbit\",\"Tbit\",\"Pbit\",\"Ebit\",\"Zbit\",\"Ybit\"],bytes:[\"B\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"]}},e={iec:[\"\",\"kibi\",\"mebi\",\"gibi\",\"tebi\",\"pebi\",\"exbi\",\"zebi\",\"yobi\"],jedec:[\"\",\"kilo\",\"mega\",\"giga\",\"tera\",\"peta\",\"exa\",\"zetta\",\"yotta\"]},o={floor:Math.floor,ceil:Math.ceil};function n(n){var r,a,b,s,l,c,f,d,p,u,h,B,g,y,M,m,v,x,N,T,j,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=[],P=0;if(isNaN(n))throw new TypeError(\"Invalid number\");if(b=!0===E.bits,M=!0===E.unix,B=!0===E.pad,a=E.base||10,g=void 0!==E.round?E.round:M?1:2,f=void 0!==E.locale?E.locale:\"\",d=E.localeOptions||{},m=void 0!==E.separator?E.separator:\"\",v=void 0!==E.spacer?E.spacer:M?\"\":\" \",N=E.symbols||{},x=2===a?E.standard||\"iec\":\"jedec\",h=E.output||\"string\",l=!0===E.fullform,c=E.fullforms instanceof Array?E.fullforms:[],r=void 0!==E.exponent?E.exponent:-1,T=o[E.roundingMethod]||Math.round,p=(u=Number(n))<0,s=a>2?1e3:1024,j=!1===isNaN(E.precision)?parseInt(E.precision,10):0,p&&(u=-u),(-1===r||isNaN(r))&&(r=Math.floor(Math.log(u)/Math.log(s)))<0&&(r=0),r>8&&(j>0&&(j+=8-r),r=8),\"exponent\"===h)return r;if(0===u)w[0]=0,y=w[1]=M?\"\":t[x][b?\"bits\":\"bytes\"][r];else{P=u/(2===a?Math.pow(2,10*r):Math.pow(1e3,r)),b&&(P*=8)>=s&&r<8&&(P/=s,r++);var k=Math.pow(10,r>0?g:0);w[0]=T(P*k)/k,w[0]===s&&r<8&&void 0===E.exponent&&(w[0]=1,r++),y=w[1]=10===a&&1===r?b?\"kbit\":\"kB\":t[x][b?\"bits\":\"bytes\"][r],M&&(w[1]=w[1].charAt(0),i.test(w[1])&&(w[0]=Math.floor(w[0]),w[1]=\"\"))}if(p&&(w[0]=-w[0]),j>0&&(w[0]=w[0].toPrecision(j)),w[1]=N[w[1]]||w[1],!0===f?w[0]=w[0].toLocaleString():f.length>0?w[0]=w[0].toLocaleString(f,d):m.length>0&&(w[0]=w[0].toString().replace(\".\",m)),B&&!1===Number.isInteger(w[0])&&g>0){var G=m||\".\",K=w[0].toString().split(G),S=K[1]||\"\",Y=S.length,Z=g-Y;w[0]=\"\".concat(K[0]).concat(G).concat(S.padEnd(Y+Z,\"0\"))}return l&&(w[1]=c[r]?c[r]:e[x][r]+(b?\"bit\":\"byte\")+(1===w[0]?\"\":\"s\")),\"array\"===h?w:\"object\"===h?{value:w[0],symbol:w[1],exponent:r,unit:y}:w.join(v)}return n.partial=function(i){return function(t){return n(t,i)}},n}));\n//# sourceMappingURL=filesize.min.js.map\n","/*\n *  base64.js\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n */\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? module.exports = factory(global)\n        : typeof define === 'function' && define.amd\n        ? define(factory) : factory(global)\n}((\n    typeof self !== 'undefined' ? self\n        : typeof window !== 'undefined' ? window\n        : typeof global !== 'undefined' ? global\n: this\n), function(global) {\n    'use strict';\n    // existing version for noConflict()\n    global = global || {};\n    var _Base64 = global.Base64;\n    var version = \"2.6.4\";\n    // constants\n    var b64chars\n        = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n    var b64tab = function(bin) {\n        var t = {};\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\n        return t;\n    }(b64chars);\n    var fromCharCode = String.fromCharCode;\n    // encoder stuff\n    var cb_utob = function(c) {\n        if (c.length < 2) {\n            var cc = c.charCodeAt(0);\n            return cc < 0x80 ? c\n                : cc < 0x800 ? (fromCharCode(0xc0 | (cc >>> 6))\n                                + fromCharCode(0x80 | (cc & 0x3f)))\n                : (fromCharCode(0xe0 | ((cc >>> 12) & 0x0f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        } else {\n            var cc = 0x10000\n                + (c.charCodeAt(0) - 0xD800) * 0x400\n                + (c.charCodeAt(1) - 0xDC00);\n            return (fromCharCode(0xf0 | ((cc >>> 18) & 0x07))\n                    + fromCharCode(0x80 | ((cc >>> 12) & 0x3f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        }\n    };\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n    var utob = function(u) {\n        return u.replace(re_utob, cb_utob);\n    };\n    var cb_encode = function(ccc) {\n        var padlen = [0, 2, 1][ccc.length % 3],\n        ord = ccc.charCodeAt(0) << 16\n            | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\n            | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\n        chars = [\n            b64chars.charAt( ord >>> 18),\n            b64chars.charAt((ord >>> 12) & 63),\n            padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\n            padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\n        ];\n        return chars.join('');\n    };\n    var btoa = global.btoa && typeof global.btoa == 'function'\n        ? function(b){ return global.btoa(b) } : function(b) {\n        if (b.match(/[^\\x00-\\xFF]/)) throw new RangeError(\n            'The string contains invalid characters.'\n        );\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n    };\n    var _encode = function(u) {\n        return btoa(utob(String(u)));\n    };\n    var mkUriSafe = function (b64) {\n        return b64.replace(/[+\\/]/g, function(m0) {\n            return m0 == '+' ? '-' : '_';\n        }).replace(/=/g, '');\n    };\n    var encode = function(u, urisafe) {\n        return urisafe ? mkUriSafe(_encode(u)) : _encode(u);\n    };\n    var encodeURI = function(u) { return encode(u, true) };\n    var fromUint8Array;\n    if (global.Uint8Array) fromUint8Array = function(a, urisafe) {\n        // return btoa(fromCharCode.apply(null, a));\n        var b64 = '';\n        for (var i = 0, l = a.length; i < l; i += 3) {\n            var a0 = a[i], a1 = a[i+1], a2 = a[i+2];\n            var ord = a0 << 16 | a1 << 8 | a2;\n            b64 +=    b64chars.charAt( ord >>> 18)\n                +     b64chars.charAt((ord >>> 12) & 63)\n                + ( typeof a1 != 'undefined'\n                    ? b64chars.charAt((ord >>>  6) & 63) : '=')\n                + ( typeof a2 != 'undefined'\n                    ? b64chars.charAt( ord         & 63) : '=');\n        }\n        return urisafe ? mkUriSafe(b64) : b64;\n    };\n    // decoder stuff\n    var re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\n    var cb_btou = function(cccc) {\n        switch(cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                |    ((0x3f & cccc.charCodeAt(1)) << 12)\n                |    ((0x3f & cccc.charCodeAt(2)) <<  6)\n                |     (0x3f & cccc.charCodeAt(3)),\n            offset = cp - 0x10000;\n            return (fromCharCode((offset  >>> 10) + 0xD800)\n                    + fromCharCode((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return fromCharCode(\n                ((0x0f & cccc.charCodeAt(0)) << 12)\n                    | ((0x3f & cccc.charCodeAt(1)) << 6)\n                    |  (0x3f & cccc.charCodeAt(2))\n            );\n        default:\n            return  fromCharCode(\n                ((0x1f & cccc.charCodeAt(0)) << 6)\n                    |  (0x3f & cccc.charCodeAt(1))\n            );\n        }\n    };\n    var btou = function(b) {\n        return b.replace(re_btou, cb_btou);\n    };\n    var cb_decode = function(cccc) {\n        var len = cccc.length,\n        padlen = len % 4,\n        n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\n            | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\n            | (len > 2 ? b64tab[cccc.charAt(2)] <<  6 : 0)\n            | (len > 3 ? b64tab[cccc.charAt(3)]       : 0),\n        chars = [\n            fromCharCode( n >>> 16),\n            fromCharCode((n >>>  8) & 0xff),\n            fromCharCode( n         & 0xff)\n        ];\n        chars.length -= [0, 0, 2, 1][padlen];\n        return chars.join('');\n    };\n    var _atob = global.atob && typeof global.atob == 'function'\n        ? function(a){ return global.atob(a) } : function(a){\n        return a.replace(/\\S{1,4}/g, cb_decode);\n    };\n    var atob = function(a) {\n        return _atob(String(a).replace(/[^A-Za-z0-9\\+\\/]/g, ''));\n    };\n    var _decode = function(a) { return btou(_atob(a)) };\n    var _fromURI = function(a) {\n        return String(a).replace(/[-_]/g, function(m0) {\n            return m0 == '-' ? '+' : '/'\n        }).replace(/[^A-Za-z0-9\\+\\/]/g, '');\n    };\n    var decode = function(a){\n        return _decode(_fromURI(a));\n    };\n    var toUint8Array;\n    if (global.Uint8Array) toUint8Array = function(a) {\n        return Uint8Array.from(atob(_fromURI(a)), function(c) {\n            return c.charCodeAt(0);\n        });\n    };\n    var noConflict = function() {\n        var Base64 = global.Base64;\n        global.Base64 = _Base64;\n        return Base64;\n    };\n    // export Base64\n    global.Base64 = {\n        VERSION: version,\n        atob: atob,\n        btoa: btoa,\n        fromBase64: decode,\n        toBase64: encode,\n        utob: utob,\n        encode: encode,\n        encodeURI: encodeURI,\n        btou: btou,\n        decode: decode,\n        noConflict: noConflict,\n        fromUint8Array: fromUint8Array,\n        toUint8Array: toUint8Array\n    };\n    // if ES5 is available, make Base64.extendString() available\n    if (typeof Object.defineProperty === 'function') {\n        var noEnum = function(v){\n            return {value:v,enumerable:false,writable:true,configurable:true};\n        };\n        global.Base64.extendString = function () {\n            Object.defineProperty(\n                String.prototype, 'fromBase64', noEnum(function () {\n                    return decode(this)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64', noEnum(function (urisafe) {\n                    return encode(this, urisafe)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64URI', noEnum(function () {\n                    return encode(this, true)\n                }));\n        };\n    }\n    //\n    // export Base64 to the namespace\n    //\n    if (global['Meteor']) { // Meteor.js\n        Base64 = global.Base64;\n    }\n    // module.exports and AMD are mutually exclusive.\n    // module.exports has precedence.\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports.Base64 = global.Base64;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], function(){ return global.Base64 });\n    }\n    // that's it!\n    return {Base64: global.Base64}\n}));\n","// extracted by mini-css-extract-plugin\nexport default {\"dropdown_content\":\"bSYn21_MuQ2nA5w8NofP\",\"current_media\":\"Al49W7929Leiqnk0t4lV\"};","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , undef;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String|Null} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  try {\n    return decodeURIComponent(input.replace(/\\+/g, ' '));\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Attempts to encode a given input.\n *\n * @param {String} input The string that needs to be encoded.\n * @returns {String|Null} The encoded string.\n * @api private\n */\nfunction encode(input) {\n  try {\n    return encodeURIComponent(input);\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?#&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    // In the case if failed decoding, we want to omit the key/value pairs\n    // from the result.\n    //\n    if (key === null || value === null || key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = []\n    , value\n    , key;\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (key in obj) {\n    if (has.call(obj, key)) {\n      value = obj[key];\n\n      //\n      // Edge cases where we actually want to encode the value to an empty\n      // string instead of the stringified value.\n      //\n      if (!value && (value === null || value === undef || isNaN(value))) {\n        value = '';\n      }\n\n      key = encode(key);\n      value = encode(value);\n\n      //\n      // If we failed to encode the strings, we should bail out as we don't\n      // want to add invalid strings to the query.\n      //\n      if (key === null || value === null) continue;\n      pairs.push(key +'='+ value);\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n","/**\n * External dependencies\n */\nimport { Path, SVG } from '@wordpress/components';\n\nexport const VideoPressIcon = (\n\t<SVG width=\"29\" height=\"21\" viewBox=\"0 0 29 21\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<Path\n\t\t\tfillRule=\"evenodd\"\n\t\t\tclipRule=\"evenodd\"\n\t\t\td=\"M2.79037 0.59375C4.0363 0.59375 5.13102 1.41658 5.47215 2.60947L8.8452 14.4044C8.8486 14.4164 8.85411 14.4273 8.86124 14.4368L12.8572 0.59375H15.0927H21.2721C25.6033 0.59375 28.5066 3.39892 28.5066 7.64565C28.5066 11.9411 25.5272 14.6196 21.0818 14.6196H18.1499H14.3719L13.6379 16.8813C12.9796 18.9095 11.0827 20.2839 8.94152 20.2839C6.80035 20.2839 4.90341 18.9095 4.24517 16.8813L0.137069 4.22276C-0.444671 2.43022 0.898038 0.59375 2.79037 0.59375ZM15.7374 10.4119H20.0156C21.8718 10.4119 22.9856 9.35018 22.9856 7.64565C22.9856 5.93137 21.8718 4.91839 20.0156 4.91839H17.5202L15.7374 10.4119Z\"\n\t\t\tfill=\"#000000\"\n\t\t/>\n\t</SVG>\n);\n","/**\n * WordPress dependencies\n */\nimport { InspectorControls } from '@wordpress/block-editor';\nimport { PanelBody, ToggleControl, Tooltip, SelectControl } from '@wordpress/components';\nimport { __, _x } from '@wordpress/i18n';\nimport { useCallback } from 'react';\n/**\n * Internal dependencies\n */\nimport SeekbarColorSettings from './seekbar-color-settings';\n\n/**\n * VideoPress block - Inspector control\n *\n * @param {object} props                 - Component props.\n * @param {object} props.attributes      - Block attributes.\n * @param {Function} props.setAttributes - Function to set block attributes.\n * @returns {object}                     - React component.\n */\nexport default function VideoPressInspectorControls( { attributes, setAttributes } ) {\n\tconst { autoplay, loop, muted, controls, playsinline, preload, useAverageColor } = attributes;\n\n\tconst renderControlLabelWithTooltip = ( label, tooltipText ) => {\n\t\treturn (\n\t\t\t<Tooltip text={ tooltipText } position=\"top\">\n\t\t\t\t<span>{ label }</span>\n\t\t\t</Tooltip>\n\t\t);\n\t};\n\n\tconst handleAttributeChange = useCallback(\n\t\tattributeName => {\n\t\t\treturn newValue => {\n\t\t\t\tsetAttributes( { [ attributeName ]: newValue } );\n\t\t\t};\n\t\t},\n\t\t[ setAttributes ]\n\t);\n\n\treturn (\n\t\t<InspectorControls>\n\t\t\t<PanelBody title={ __( 'Video Settings', 'jetpack-videopress-pkg' ) }>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ renderControlLabelWithTooltip(\n\t\t\t\t\t\t__( 'Autoplay', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t/* translators: Tooltip describing the \"autoplay\" option for the VideoPress player */\n\t\t\t\t\t\t__( 'Start playing the video as soon as the page loads', 'jetpack-videopress-pkg' )\n\t\t\t\t\t) }\n\t\t\t\t\tonChange={ handleAttributeChange( 'autoplay' ) }\n\t\t\t\t\tchecked={ autoplay }\n\t\t\t\t\thelp={\n\t\t\t\t\t\tautoplay\n\t\t\t\t\t\t\t? __(\n\t\t\t\t\t\t\t\t\t'Note: Autoplaying videos may cause usability issues for some visitors.',\n\t\t\t\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t: null\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ renderControlLabelWithTooltip(\n\t\t\t\t\t\t__( 'Loop', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t/* translators: Tooltip describing the \"loop\" option for the VideoPress player */\n\t\t\t\t\t\t__( 'Restarts the video when it reaches the end', 'jetpack-videopress-pkg' )\n\t\t\t\t\t) }\n\t\t\t\t\tonChange={ handleAttributeChange( 'loop' ) }\n\t\t\t\t\tchecked={ loop }\n\t\t\t\t/>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ __( 'Muted', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\tonChange={ handleAttributeChange( 'muted' ) }\n\t\t\t\t\tchecked={ muted }\n\t\t\t\t/>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ renderControlLabelWithTooltip(\n\t\t\t\t\t\t__( 'Playback Controls', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t/* translators: Tooltip describing the \"controls\" option for the VideoPress player */\n\t\t\t\t\t\t__( 'Display the video playback controls', 'jetpack-videopress-pkg' )\n\t\t\t\t\t) }\n\t\t\t\t\tonChange={ handleAttributeChange( 'controls' ) }\n\t\t\t\t\tchecked={ controls }\n\t\t\t\t/>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ renderControlLabelWithTooltip(\n\t\t\t\t\t\t__( 'Play Inline', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t/* translators: Tooltip describing the \"playsinline\" option for the VideoPress player */\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'Play the video inline instead of full-screen on mobile devices',\n\t\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t\t)\n\t\t\t\t\t) }\n\t\t\t\t\tonChange={ handleAttributeChange( 'playsinline' ) }\n\t\t\t\t\tchecked={ playsinline }\n\t\t\t\t/>\n\t\t\t\t<SelectControl\n\t\t\t\t\tlabel={ renderControlLabelWithTooltip(\n\t\t\t\t\t\t__( 'Preload', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t/* translators: Tooltip describing the \"preload\" option for the VideoPress player */\n\t\t\t\t\t\t__( 'Content to dowload before the video is played', 'jetpack-videopress-pkg' )\n\t\t\t\t\t) }\n\t\t\t\t\tvalue={ preload }\n\t\t\t\t\tonChange={ value => setAttributes( { preload: value } ) }\n\t\t\t\t\toptions={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\t\t\tlabel: _x( 'Auto', 'VideoPress preload setting', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'metadata',\n\t\t\t\t\t\t\tlabel: _x( 'Metadata', 'VideoPress preload setting', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'none',\n\t\t\t\t\t\t\tlabel: _x( 'None', 'VideoPress preload setting', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t] }\n\t\t\t\t\thelp={\n\t\t\t\t\t\t'auto' === preload\n\t\t\t\t\t\t\t? __(\n\t\t\t\t\t\t\t\t\t'Note: Automatically downloading videos may cause issues if there are many videos displayed on the same page.',\n\t\t\t\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t: null\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</PanelBody>\n\n\t\t\t<SeekbarColorSettings\n\t\t\t\t{ ...{ attributes, setAttributes, useAverageColor } }\n\t\t\t\ttoggleAttribute={ handleAttributeChange }\n\t\t\t/>\n\t\t</InspectorControls>\n\t);\n}\n","/**\n * WordPress dependencies\n */\nimport { MediaUploadCheck, BlockControls, MediaUpload } from '@wordpress/block-editor';\nimport { ToolbarButton, Dropdown, NavigableMenu, MenuItem } from '@wordpress/components';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { linkOff, image as imageIcon } from '@wordpress/icons';\n/**\n * Internal dependencies\n */\nimport styles from './style.module.scss';\n\nconst VIDEO_POSTER_ALLOWED_MEDIA_TYPES = [ 'image' ];\n\n/**\n * Poster image control react component.\n *\n * @param {object} props                 - Component props.\n * @param {object} props.attributes      - Block attributes.\n * @param {Function} props.setAttributes - Function to set block attributes.\n * @param {string} props.clientId        - Block client ID.\n * @returns {object}                     - React component.\n */\nexport default function PosterImageBlockControl( { attributes, setAttributes, clientId } ) {\n\tconst { poster } = attributes;\n\tconst onSelectPoster = image => {\n\t\tsetAttributes( { poster: image.url } );\n\t};\n\n\tconst onRemovePoster = () => {\n\t\tsetAttributes( { poster: '' } );\n\t};\n\n\tconst currentImage = () => {\n\t\tif ( poster ) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t'You are currently overriding the default Poster image. Remove it if you want to use the default image generated by VideoPress.',\n\t\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t\t) }\n\t\t\t\t\t</span>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ __(\n\t\t\t\t\t'No custom Poster image selected. You can upload or select an image from your media library to override the default video image',\n\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t) }\n\t\t\t</>\n\t\t);\n\t};\n\n\treturn (\n\t\t<BlockControls group=\"block\">\n\t\t\t<Dropdown\n\t\t\t\tcontentClassName={ styles.dropdown_content }\n\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\tlabel={ __( 'Poster image', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t\tshowTooltip\n\t\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\t\tonClick={ onToggle }\n\t\t\t\t\t\ticon={ imageIcon }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\trenderContent={ ( { onClose } ) => {\n\t\t\t\t\tconst videoPosterDescription = `video-block__poster-image-description-${ clientId }`;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<NavigableMenu className=\"block-editor-media-replace-flow__media-upload-menu\">\n\t\t\t\t\t\t\t\t<MediaUploadCheck>\n\t\t\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\t\t\ttitle={ __( 'Select Poster Image', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t\t\t\t\t\tonSelect={ image => {\n\t\t\t\t\t\t\t\t\t\t\tonSelectPoster( image );\n\t\t\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\tallowedTypes={ VIDEO_POSTER_ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\t\t\ticon={ imageIcon }\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t\t\t\t\t\t\taria-describedby={ videoPosterDescription }\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{ ! poster\n\t\t\t\t\t\t\t\t\t\t\t\t\t? __( 'Select Poster Image', 'jetpack-videopress-pkg' )\n\t\t\t\t\t\t\t\t\t\t\t\t\t: __(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace Poster image',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'jetpack-videopress-pkg',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/* dummy arg to avoid bad minification */ 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t  ) }\n\t\t\t\t\t\t\t\t\t\t\t\t<p id={ videoPosterDescription } hidden>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ poster\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? sprintf(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/* translators: Placeholder is an image URL. */\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'The current poster image url is %s',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tposter\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: __(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'There is no poster image currently selected',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ) }\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</MediaUploadCheck>\n\n\t\t\t\t\t\t\t\t{ !! poster && (\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\t\t\tonRemovePoster();\n\t\t\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\ticon={ linkOff }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Remove and use default', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</NavigableMenu>\n\n\t\t\t\t\t\t\t<div className={ styles.current_media }>{ currentImage() }</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t/>\n\t\t</BlockControls>\n\t);\n}\n","import { PanelColorSettings } from '@wordpress/block-editor';\nimport { Button, PanelBody, ToggleControl } from '@wordpress/components';\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport React from 'react';\n\nclass SeekbarColorSettings extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tconst { seekbarColor, seekbarPlayedColor, seekbarLoadingColor } = this.props.attributes;\n\t\tthis.state = { seekbarColor, seekbarPlayedColor, seekbarLoadingColor };\n\t}\n\n\thandleChangeSeekbarColor = newColor => {\n\t\tthis.setState( { seekbarColor: newColor } );\n\t};\n\n\thandleChangeSeekbarLoadingColor = newColor => {\n\t\tthis.setState( { seekbarLoadingColor: newColor } );\n\t};\n\n\thandleChangeSeekbarPlayedColor = newColor => {\n\t\tthis.setState( { seekbarPlayedColor: newColor } );\n\t};\n\n\tsaveColors = () => {\n\t\tconst { seekbarColor, seekbarLoadingColor, seekbarPlayedColor } = this.state;\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( { seekbarColor, seekbarLoadingColor, seekbarPlayedColor } );\n\t};\n\n\trender() {\n\t\tconst { seekbarColor, seekbarPlayedColor, seekbarLoadingColor } = this.state;\n\t\tconst { toggleAttribute, useAverageColor } = this.props;\n\t\tconst showTitle = true;\n\n\t\treturn (\n\t\t\t<PanelBody\n\t\t\t\tclassName=\"seekbar-color-settings__panel\"\n\t\t\t\ttitle={ __( 'Progress Bar Colors', 'jetpack-videopress-pkg' ) }\n\t\t\t\tinitialOpen={ false }\n\t\t\t>\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ __( 'Match video', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\thelp={ __( 'Colors adapt to the video as it plays', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\tonChange={ toggleAttribute( 'useAverageColor' ) }\n\t\t\t\t\tchecked={ useAverageColor }\n\t\t\t\t/>\n\t\t\t\t<PanelColorSettings\n\t\t\t\t\topened={ ! useAverageColor }\n\t\t\t\t\tshowTitle={ false }\n\t\t\t\t\tcolorSettings={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: seekbarColor,\n\t\t\t\t\t\t\tonChange: this.handleChangeSeekbarColor,\n\t\t\t\t\t\t\tlabel: __( 'Main', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t\tshowTitle,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: seekbarLoadingColor,\n\t\t\t\t\t\t\tonChange: this.handleChangeSeekbarLoadingColor,\n\t\t\t\t\t\t\tlabel: __( 'Loaded', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t\tshowTitle,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: seekbarPlayedColor,\n\t\t\t\t\t\t\tonChange: this.handleChangeSeekbarPlayedColor,\n\t\t\t\t\t\t\tlabel: __( 'Progress', 'jetpack-videopress-pkg' ),\n\t\t\t\t\t\t\tshowTitle,\n\t\t\t\t\t\t},\n\t\t\t\t\t] }\n\t\t\t\t>\n\t\t\t\t\t<Button variant=\"secondary\" onClick={ this.saveColors }>\n\t\t\t\t\t\t{ __( 'Save colors', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t</PanelColorSettings>\n\t\t\t</PanelBody>\n\t\t);\n\t}\n}\n\nexport default SeekbarColorSettings;\n","/**\n * External dependencies\n */\nimport { RichText } from '@wordpress/block-editor';\nimport { ResizableBox, SandBox } from '@wordpress/components';\nimport { useCallback, useRef, useEffect, useState } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport debugFactory from 'debug';\n/**\n * Internal dependencies\n */\nimport vpBlockBridge from '../../scripts/vp-block-bridge';\n\n// Global scripts array to be run in the Sandbox context.\nconst globalScripts = [];\n\n// Populate scripts array with videopresAjaxURLBlob blobal var.\nif ( window.videopressAjax ) {\n\tconst videopresAjaxURLBlob = new Blob(\n\t\t[ `var videopressAjax = ${ JSON.stringify( window.videopressAjax ) };` ],\n\t\t{\n\t\t\ttype: 'text/javascript',\n\t\t}\n\t);\n\n\tglobalScripts.push(\n\t\tURL.createObjectURL( videopresAjaxURLBlob ),\n\t\twindow.videopressAjax.bridgeUrl\n\t);\n}\n\n// Define a debug instance for block bridge.\nwindow.debugBridgeInstance = debugFactory( 'jetpack:vp-block:bridge' );\n\n// Load VideoPressBlock bridge script.\nglobalScripts.push( vpBlockBridge );\n\n/**\n * VideoPlayer react component\n *\n * @param {object} props                 - Component props.\n * @param {object} props.html            - Player html to render in the sandbox.\n * @param {boolean} props.isSelected     - Whether the block is selected.\n * @param {object} props.attributes      - Block attributes.\n * @param {Function} props.setAttributes - Function to set block attributes.\n * @param {Array} props.scripts          - Scripts to pass trough to the sandbox.\n * @param {object} props.preview         - oEmbed preview data.\n * @returns {object}                     - React component.\n */\nexport default function VideoPressPlayer( {\n\thtml,\n\tisSelected,\n\tattributes,\n\tsetAttributes,\n\tscripts = [],\n\tpreview,\n} ) {\n\tconst ref = useRef();\n\tconst { maxWidth, caption, videoRatio } = attributes;\n\n\t// Pick up iFrame and sandbox window references.\n\tconst iFrameDomReference = ref?.current?.querySelector( 'iframe' );\n\tconst sandboxWindow = iFrameDomReference?.contentWindow;\n\n\t/*\n\t * Temporary height is used to set the height of the video\n\t * as soon as the block is rendered into the canvas,\n\t * while the preview fetching process is happening,\n\t * trying to reduce the flicker effects as much as possible\n\t *\n\t * Once the preview is fetched, the temporary heihgt is ignored.\n\t */\n\tconst [ temporaryHeight, setTemporaryHeight ] = useState();\n\tconst [ isVideoLoaded, setIsVideoLoaded ] = useState( false );\n\tuseEffect( () => {\n\t\tif ( ! ref?.current ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( preview ) {\n\t\t\t// Once the video is loaded, delegate the height to the player (iFrame)\n\t\t\treturn setTemporaryHeight( 'auto' );\n\t\t}\n\n\t\tif ( ! videoRatio ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// When no preview is available, set the height of the video.\n\t\tsetTemporaryHeight( ( ref.current.offsetWidth * videoRatio ) / 100 );\n\n\t\tsetTimeout( () => {\n\t\t\t// Recalculated in case the sidebar is opened.\n\t\t\tsetTemporaryHeight( ( ref.current.offsetWidth * videoRatio ) / 100 );\n\t\t}, 0 );\n\n\t\t/*\n\t\t * Also, when no preview, consider the video is no loaded yet.\n\t\t * note: videopress API does not provide\n\t\t * the event to know when the video is not loaded.\n\t\t */\n\t\tsetIsVideoLoaded( false );\n\t}, [ ref, videoRatio, preview ] );\n\n\tconst onVideoLoadingStateHandler = useCallback( ( { detail } ) => {\n\t\tsetIsVideoLoaded( detail?.state === 'loaded' );\n\t}, [] );\n\n\t// set video is loaded as False, when html is not available.\n\tuseEffect( () => {\n\t\tif ( html ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetIsVideoLoaded( false );\n\t}, [ html ] );\n\n\tuseEffect( () => {\n\t\tif ( ! sandboxWindow ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsandboxWindow.addEventListener( 'onVideoPressLoadingState', onVideoLoadingStateHandler );\n\n\t\treturn () =>\n\t\t\tsandboxWindow?.removeEventListener( 'onVideoPressLoadingState', onVideoLoadingStateHandler );\n\t}, [ onVideoLoadingStateHandler, sandboxWindow, html ] );\n\n\tconst onBlockResize = useCallback(\n\t\t( event, direction, domElement ) => {\n\t\t\tlet newMaxWidth = getComputedStyle( domElement ).width;\n\t\t\tconst parentElement = domElement.parentElement;\n\t\t\tif ( null !== parentElement ) {\n\t\t\t\tconst parentWidth = getComputedStyle( domElement.parentElement ).width;\n\t\t\t\tif ( newMaxWidth === parentWidth ) {\n\t\t\t\t\tnewMaxWidth = '100%';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetAttributes( { maxWidth: newMaxWidth } );\n\t\t},\n\t\t[ setAttributes ]\n\t);\n\n\tconst style = {};\n\tif ( temporaryHeight !== 'auto' ) {\n\t\tstyle.height = temporaryHeight || 200;\n\t\tstyle.paddingBottom = temporaryHeight ? 12 : 0;\n\t}\n\n\treturn (\n\t\t<figure className=\"jetpack-videopress-player\">\n\t\t\t<ResizableBox\n\t\t\t\tenable={ {\n\t\t\t\t\ttop: false,\n\t\t\t\t\tbottom: false,\n\t\t\t\t\tleft: true,\n\t\t\t\t\tright: true,\n\t\t\t\t} }\n\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\tsize={ { width: maxWidth } }\n\t\t\t\tstyle={ { margin: 'auto' } }\n\t\t\t\tonResizeStop={ onBlockResize }\n\t\t\t>\n\t\t\t\t{ ! isSelected && <div className=\"jetpack-videopress-player__overlay\" /> }\n\t\t\t\t<div className=\"jetpack-videopress-player__wrapper\" ref={ ref } style={ style }>\n\t\t\t\t\t<SandBox html={ html } scripts={ [ ...globalScripts, ...scripts ] } />\n\t\t\t\t\t{ ! isVideoLoaded && (\n\t\t\t\t\t\t<div className=\"jetpack-videopress-player__loading\">\n\t\t\t\t\t\t\t{ __( 'Loading', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t</ResizableBox>\n\n\t\t\t{ ( ! RichText.isEmpty( caption ) || isSelected ) && (\n\t\t\t\t<RichText\n\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\tplaceholder={ __( 'Write caption', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\tvalue={ caption }\n\t\t\t\t\tonChange={ value => setAttributes( { caption: value } ) }\n\t\t\t\t\tinlineToolbar\n\t\t\t\t/>\n\t\t\t) }\n\t\t</figure>\n\t);\n}\n","/**\n * External dependencies\n */\nimport { BlockIcon, MediaPlaceholder } from '@wordpress/block-editor';\nimport { Button, withNotices, ExternalLink } from '@wordpress/components';\nimport { createInterpolateElement, useCallback, useState } from '@wordpress/element';\nimport { escapeHTML } from '@wordpress/escape-html';\nimport { __, sprintf } from '@wordpress/i18n';\nimport filesize from 'filesize';\nimport { useRef } from 'react';\nimport { PlaceholderWrapper } from '../../edit.js';\n/**\n * Internal dependencies\n */\nimport { useResumableUploader } from '../../hooks/use-uploader.js';\nimport { description, title } from '../../index.js';\nimport { VideoPressIcon } from '../icons';\nimport './style.scss';\n\nconst ALLOWED_MEDIA_TYPES = [ 'video' ];\n\nconst UploadProgress = ( { progress, file, paused, onPauseOrResume } ) => {\n\tconst roundedProgress = Math.round( progress );\n\tconst cssWidth = { width: `${ roundedProgress }%` };\n\n\tconst resumeText = __( 'Resume', 'jetpack-videopress-pkg' );\n\tconst pauseText = __( 'Pause', 'jetpack-videopress-pkg' );\n\tconst fileSizeLabel = filesize( file?.size );\n\tconst escapedFileName = escapeHTML( file?.name );\n\tconst fileNameLabel = createInterpolateElement(\n\t\tsprintf(\n\t\t\t/* translators: Placeholder is a video file name. */\n\t\t\t__( 'Uploading <strong>%s</strong>', 'jetpack-videopress-pkg' ),\n\t\t\tescapedFileName\n\t\t),\n\t\t{ strong: <strong /> }\n\t);\n\n\treturn (\n\t\t<PlaceholderWrapper>\n\t\t\t<div className=\"videopress-uploader-progress\">\n\t\t\t\t<div className=\"videopress-uploader-progress__file-info\">\n\t\t\t\t\t<div className=\"videopress-uploader-progress__file-name\">{ fileNameLabel }</div>\n\t\t\t\t\t&nbsp;&#8212;&nbsp;\n\t\t\t\t\t<div className=\"videopress-uploader-progress__file-size\">{ fileSizeLabel }</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"videopress-uploader-progress__progress\">\n\t\t\t\t\t<div className=\"videopress-uploader-progress__progress-loaded\" style={ cssWidth } />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"videopress-uploader-progress__actions\">\n\t\t\t\t\t<div className=\"videopress-upload__percent-complete\">{ `${ roundedProgress }%` }</div>\n\t\t\t\t\t{ roundedProgress < 100 && (\n\t\t\t\t\t\t<Button variant=\"link\" onClick={ onPauseOrResume }>\n\t\t\t\t\t\t\t{ paused ? resumeText : pauseText }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</PlaceholderWrapper>\n\t);\n};\n\nconst UploadError = ( { message, onRetry, onCancel } ) => {\n\treturn (\n\t\t<PlaceholderWrapper errorMessage={ message } onNoticeRemove={ onCancel }>\n\t\t\t<div className=\"videopress-uploader__error-actions\">\n\t\t\t\t<Button variant=\"primary\" onClick={ onRetry }>\n\t\t\t\t\t{ __( 'Try again', 'jetpack-videopress-pkg' ) }\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"secondary\" onClick={ onCancel }>\n\t\t\t\t\t{ __( 'Cancel', 'jetpack-videopress-pkg' ) }\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</PlaceholderWrapper>\n\t);\n};\n\nconst VideoPressUploader = ( { attributes, setAttributes, noticeUI, noticeOperations } ) => {\n\tconst [ uploadPaused, setUploadPaused ] = useState( false );\n\tconst tusUploader = useRef( null );\n\n\t/*\n\t * Storing the file to get it name and size for progress.\n\t */\n\tconst [ uploadFile, setFile ] = useState( null );\n\n\t/*\n\t * Tracking state when uploading the video file.\n\t * uploadingProgress is an array with two items:\n\t *  - the first item is the upload progress\n\t *  - the second item is total\n\t */\n\tconst [ uploadingProgress, setUploadingProgressState ] = useState( [] );\n\n\t// Define a memoized function to register the upload progress.\n\tconst setUploadingProgress = useCallback( function ( ...args ) {\n\t\tsetUploadingProgressState( args );\n\t}, [] );\n\n\t/*\n\t * Tracking error data\n\t */\n\tconst [ uploadErrorData, setUploadErrorDataState ] = useState( null );\n\n\t// Define a memoized function to register the error data.\n\tconst setUploadErrorData = useCallback( function ( error ) {\n\t\tif ( error?.originalResponse ) {\n\t\t\ttry {\n\t\t\t\t// parse failed request response message\n\t\t\t\tconst body = error?.originalResponse?.getBody?.();\n\t\t\t\tconst parsedBody = JSON.parse( body );\n\t\t\t\tsetUploadErrorDataState( parsedBody );\n\t\t\t\treturn;\n\t\t\t} catch {}\n\t\t}\n\n\t\tsetUploadErrorDataState( error );\n\t}, [] );\n\n\t/*\n\t * It's considered the file is uploading\n\t * when the progress value is lower than the total.\n\t */\n\tconst isUploadingFile = !! (\n\t\tuploadingProgress?.length && uploadingProgress[ 0 ] < uploadingProgress[ 1 ]\n\t);\n\n\t// File has been upload when the progress value is equal to the total.\n\tconst fileHasBeenUploaded = !! (\n\t\tuploadingProgress?.length && uploadingProgress[ 0 ] === uploadingProgress[ 1 ]\n\t);\n\n\t// Helper instance to upload the video to the VideoPress infrastructure.\n\tconst [ videoPressUploader ] = useResumableUploader( {\n\t\tonError: setUploadErrorData,\n\t\tonProgress: setUploadingProgress,\n\t\tonSuccess: setAttributes,\n\t} );\n\n\t// Returns true if the object represents a valid host for a VideoPress video.\n\t// Private vidoes are hosted under video.wordpress.com\n\tconst isValidVideoPressUrl = urlObject => {\n\t\tconst validHosts = [ 'videopress.com', 'video.wordpress.com' ];\n\t\treturn urlObject.protocol === 'https:' && validHosts.includes( urlObject.host );\n\t};\n\n\t/**\n\t * Helper function to pick up the guid\n\t * from the VideoPress URL.\n\t *\n\t * @param {string} url - VideoPress URL.\n\t * @returns {void}       The guid picked up from the URL. Otherwise, False.\n\t */\n\tconst getGuidFromVideoUrl = url => {\n\t\ttry {\n\t\t\tconst urlObject = new URL( url );\n\t\t\tif ( isValidVideoPressUrl( urlObject ) ) {\n\t\t\t\tconst videoGuid = urlObject.pathname.match( /^\\/v\\/([a-zA-Z0-9]+)$/ );\n\t\t\t\treturn videoGuid.length === 2 ? videoGuid[ 1 ] : false;\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\t/**\n\t * Handler to add a video via an URL.\n\t *\n\t * @param {string} videoUrl - URL of the video to attach\n\t */\n\tfunction onSelectURL( videoUrl ) {\n\t\tconst videoGuid = getGuidFromVideoUrl( videoUrl );\n\t\tif ( ! videoGuid ) {\n\t\t\tsetUploadErrorDataState( {\n\t\t\t\tdata: { message: __( 'Invalid VideoPress URL', 'jetpack-videopress-pkg' ) },\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\t// Update guid based on the URL.\n\t\tsetAttributes( { guid: videoGuid, src: videoUrl } );\n\t}\n\n\tconst startUpload = file => {\n\t\t// reset error\n\t\tif ( uploadErrorData ) {\n\t\t\tsetUploadErrorData( null );\n\t\t}\n\n\t\tsetFile( file );\n\t\tsetUploadingProgress( 0, file.size );\n\n\t\t// Upload file to VideoPress infrastructure.\n\t\ttusUploader.current = videoPressUploader( file );\n\t};\n\n\tconst pauseOrResumeUpload = () => {\n\t\tconst uploader = tusUploader?.current;\n\n\t\tif ( uploader ) {\n\t\t\tconst uploaderCall = uploadPaused ? 'start' : 'abort';\n\t\t\tuploader[ uploaderCall ]();\n\t\t\tsetUploadPaused( ! uploadPaused );\n\t\t}\n\t};\n\n\t/**\n\t * Uploading file handler.\n\t *\n\t * @param {File} media - media file to upload\n\t * @returns {void}\n\t */\n\tfunction onSelectVideo( media ) {\n\t\tconst isFileUploading = null !== media && media instanceof FileList;\n\n\t\t// Handle upload by selecting a File\n\t\tif ( isFileUploading ) {\n\t\t\tconst file = media[ 0 ];\n\t\t\tstartUpload( file );\n\t\t\treturn;\n\t\t}\n\n\t\t// Handle selection of Media Library VideoPress attachment\n\t\tif ( media.videopress_guid ) {\n\t\t\tconst videoGuid = media.videopress_guid[ 0 ];\n\t\t\tconst videoUrl = `https://videopress.com/v/${ videoGuid }`;\n\t\t\tif ( getGuidFromVideoUrl( videoUrl ) ) {\n\t\t\t\treturn onSelectURL( videoUrl );\n\t\t\t}\n\t\t}\n\n\t\tsetUploadErrorDataState( {\n\t\t\tdata: {\n\t\t\t\tmessage: __(\n\t\t\t\t\t'Please select a VideoPress video from Library or upload a new one',\n\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t),\n\t\t\t},\n\t\t} );\n\t}\n\n\tconst getErrorMessage = () => {\n\t\tif ( ! uploadErrorData ) {\n\t\t\treturn '';\n\t\t}\n\n\t\tlet errorMessage =\n\t\t\tuploadErrorData?.data?.message ||\n\t\t\t__( 'Failed to upload your video. Please try again.', 'jetpack-videopress-pkg' );\n\n\t\t// Let's give this error a better message.\n\t\tif ( errorMessage === 'Invalid Mime' ) {\n\t\t\terrorMessage = (\n\t\t\t\t<>\n\t\t\t\t\t{ __(\n\t\t\t\t\t\t'The format of the video you uploaded is not supported.',\n\t\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t\t) }\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<ExternalLink\n\t\t\t\t\t\thref=\"https://wordpress.com/support/videopress/recommended-video-settings/\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Check the recommended video settings.', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t</ExternalLink>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\n\t\treturn errorMessage;\n\t};\n\n\t// Showing error if upload fails\n\tif ( uploadErrorData ) {\n\t\tconst onRetry = () => {\n\t\t\tstartUpload( uploadFile );\n\t\t};\n\n\t\tconst onCancel = () => {\n\t\t\tsetFile( null );\n\t\t\tsetUploadingProgress( [] );\n\t\t\tsetUploadErrorData( null );\n\t\t};\n\n\t\treturn <UploadError onRetry={ onRetry } onCancel={ onCancel } message={ getErrorMessage() } />;\n\t}\n\n\t// Uploading file to backend\n\tif ( isUploadingFile || fileHasBeenUploaded ) {\n\t\tconst progress = ( uploadingProgress[ 0 ] / uploadingProgress[ 1 ] ) * 100;\n\t\treturn (\n\t\t\t<UploadProgress\n\t\t\t\tfile={ uploadFile }\n\t\t\t\tprogress={ progress }\n\t\t\t\tpaused={ uploadPaused }\n\t\t\t\tonPauseOrResume={ pauseOrResumeUpload }\n\t\t\t/>\n\t\t);\n\t}\n\n\t// Default view to select file to upload\n\treturn (\n\t\t<MediaPlaceholder\n\t\t\thandleUpload={ false }\n\t\t\tclassName=\"is-videopress-placeholder\"\n\t\t\ticon={ <BlockIcon icon={ VideoPressIcon } /> }\n\t\t\tlabels={ {\n\t\t\t\ttitle,\n\t\t\t\tinstructions: description,\n\t\t\t} }\n\t\t\tonSelect={ onSelectVideo }\n\t\t\tonSelectURL={ onSelectURL }\n\t\t\taccept=\"video/*\"\n\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\tvalue={ attributes }\n\t\t\tnotices={ noticeUI }\n\t\t\tonError={ function ( error ) {\n\t\t\t\tnoticeOperations.removeAllNotices();\n\t\t\t\tnoticeOperations.createErrorNotice( error );\n\t\t\t} }\n\t\t/>\n\t);\n};\n\nexport default withNotices( VideoPressUploader );\n","/**\n * WordPress dependencies\n */\n\nimport { BlockIcon, useBlockProps } from '@wordpress/block-editor';\nimport { Spinner, Placeholder, Button, withNotices } from '@wordpress/components';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useEffect, useState, useCallback, useRef } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport classNames from 'classnames';\n/**\n * Internal dependencies\n */\nimport { VideoPressIcon } from './components/icons';\nimport VideoPressInspectorControls from './components/inspector-controls';\nimport PosterImageBlockControl from './components/poster-image-block-control';\nimport VideoPressPlayer from './components/videopress-player';\nimport VideoPressUploader from './components/videopress-uploader';\nimport { getVideoPressUrl } from './utils/url';\nimport { description, title } from '.';\n\nimport './editor.scss';\n\nconst VIDEO_PREVIEW_ATTEMPTS_LIMIT = 10;\n\nexport const PlaceholderWrapper = withNotices( function ( {\n\tchildren,\n\terrorMessage,\n\tnoticeUI,\n\tnoticeOperations,\n} ) {\n\tuseEffect( () => {\n\t\tif ( ! errorMessage ) {\n\t\t\treturn;\n\t\t}\n\n\t\tnoticeOperations.removeAllNotices();\n\t\tnoticeOperations.createErrorNotice( errorMessage );\n\t}, [ errorMessage, noticeOperations ] );\n\n\treturn (\n\t\t<Placeholder\n\t\t\ticon={ <BlockIcon icon={ VideoPressIcon } /> }\n\t\t\tlabel={ title }\n\t\t\tinstructions={ description }\n\t\t\tclassName=\"videopress-uploader is-videopress-placeholder\"\n\t\t\tnotices={ noticeUI }\n\t\t>\n\t\t\t{ children }\n\t\t</Placeholder>\n\t);\n} );\n\n/**\n * VideoPress block Edit react components\n *\n * @param {object} props                 - Component props.\n * @param {object} props.attributes      - Block attributes.\n * @param {Function} props.setAttributes - Function to set block attributes.\n * @param {boolean} props.isSelected     - Whether the block is selected.\n * @param {string} props.clientId        - Block client ID.\n * @returns {object}                     - React component.\n */\nexport default function VideoPressEdit( { attributes, setAttributes, isSelected, clientId } ) {\n\tconst {\n\t\tautoplay,\n\t\tloop,\n\t\tmuted,\n\t\tcontrols,\n\t\tplaysinline,\n\t\tpreload,\n\t\tuseAverageColor,\n\t\tseekbarColor,\n\t\tseekbarLoadingColor,\n\t\tseekbarPlayedColor,\n\t\tguid,\n\t\tcacheHtml,\n\t\tposter,\n\t\talign,\n\t\tvideoRatio,\n\t} = attributes;\n\n\tconst videoPressUrl = getVideoPressUrl( guid, {\n\t\tautoplay,\n\t\tcontrols,\n\t\tloop,\n\t\tmuted,\n\t\tplaysinline,\n\t\tpreload,\n\t\tseekbarColor,\n\t\tseekbarLoadingColor,\n\t\tseekbarPlayedColor,\n\t\tuseAverageColor,\n\t\tposter,\n\t} );\n\n\t// Get video preview status.\n\tconst { preview, isRequestingEmbedPreview } = useSelect(\n\t\tselect => {\n\t\t\treturn {\n\t\t\t\tpreview: select( coreStore ).getEmbedPreview( videoPressUrl ) || false,\n\t\t\t\tisRequestingEmbedPreview:\n\t\t\t\t\tselect( coreStore ).isRequestingEmbedPreview( videoPressUrl ) || false,\n\t\t\t};\n\t\t},\n\t\t[ videoPressUrl ]\n\t);\n\n\t// Pick video properties from preview.\n\tconst { html: previewHtml, scripts, width: previewWidth, height: previewHeight } = preview\n\t\t? preview\n\t\t: { html: null, scripts: [] };\n\n\t/*\n\t * Store the preview markup and video thumbnail image\n\t * into a block `html` and `thumbnail` attributes respectively.\n\t *\n\t * `html` will be used to render the player asap,\n\t * while a fresh preview is geing fetched from the server,\n\t * via the core store selectors.\n\t *\n\t * `thumbnail` will be shown as a fallback image\n\t * until the fetching preview process finishes.\n\t */\n\tuseEffect( () => {\n\t\tif ( ! previewHtml || previewHtml === cacheHtml ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetAttributes( { cacheHtml: previewHtml } );\n\t}, [ previewHtml, cacheHtml, setAttributes ] );\n\n\tconst html = previewHtml || cacheHtml;\n\n\t// Store the video ratio to define the initial height of the video.\n\tuseEffect( () => {\n\t\tif ( ! previewWidth || ! previewHeight ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ratio = ( previewHeight / previewWidth ) * 100;\n\t\tif ( ratio === videoRatio ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetAttributes( { videoRatio: ratio } );\n\t}, [ videoRatio, previewWidth, previewHeight, setAttributes ] );\n\n\t// Helper to invalidate the preview cache.\n\tconst invalidateResolution = useDispatch( coreStore ).invalidateResolution;\n\tconst invalidateCachedEmbedPreview = useCallback( () => {\n\t\tinvalidateResolution( 'getEmbedPreview', [ videoPressUrl ] );\n\t}, [ videoPressUrl, invalidateResolution ] );\n\n\t/*\n\t * Getting VideoPress preview.\n\t * The following code tries to handle issues\n\t * when the preview is not available even when\n\t * the VideoPress URL is gotten.\n\t * It attempts every two seconds to get the so desired video preview.\n\t */\n\tconst [ generatingPreviewCounter, setGeneratingPreviewCounter ] = useState( 0 );\n\n\tconst rePreviewAttemptTimer = useRef();\n\n\t/**\n\t * Clean the generating process timer.\n\t *\n\t * @todo improve doc\n\t */\n\tfunction cleanRegeneratingProcessTimer() {\n\t\tif ( ! rePreviewAttemptTimer?.current ) {\n\t\t\treturn;\n\t\t}\n\n\t\trePreviewAttemptTimer.current = clearInterval( rePreviewAttemptTimer.current );\n\t}\n\n\tuseEffect( () => {\n\t\t// Attempts limit achieved. Bail early.\n\t\tif ( generatingPreviewCounter >= VIDEO_PREVIEW_ATTEMPTS_LIMIT ) {\n\t\t\treturn cleanRegeneratingProcessTimer();\n\t\t}\n\n\t\t// VideoPress URL is not defined. Bail early and cleans the time.\n\t\tif ( ! videoPressUrl ) {\n\t\t\treturn cleanRegeneratingProcessTimer();\n\t\t}\n\n\t\t// Bail early (clean the timer) if the preview is already being requested.\n\t\tif ( isRequestingEmbedPreview ) {\n\t\t\treturn cleanRegeneratingProcessTimer();\n\t\t}\n\n\t\t// Bail early (clean the timer) when preview is defined.\n\t\tif ( preview ) {\n\t\t\tsetGeneratingPreviewCounter( 0 ); // reset counter.\n\t\t\treturn cleanRegeneratingProcessTimer();\n\t\t}\n\n\t\t// Bail early when it has been already started.\n\t\tif ( rePreviewAttemptTimer?.current ) {\n\t\t\treturn;\n\t\t}\n\n\t\trePreviewAttemptTimer.current = setTimeout( () => {\n\t\t\t// Abort whether the preview is already defined.\n\t\t\tif ( preview ) {\n\t\t\t\tsetGeneratingPreviewCounter( 0 ); // reset counter.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetGeneratingPreviewCounter( v => v + 1 );\n\t\t\tinvalidateCachedEmbedPreview();\n\t\t}, 2000 );\n\n\t\treturn cleanRegeneratingProcessTimer;\n\t}, [\n\t\tgeneratingPreviewCounter,\n\t\trePreviewAttemptTimer,\n\t\tinvalidateCachedEmbedPreview,\n\t\tpreview,\n\t\tvideoPressUrl,\n\t\tisRequestingEmbedPreview,\n\t] );\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classNames( 'wp-block-jetpack-videopress', {\n\t\t\t[ `align${ align }` ]: align,\n\t\t\t'is-updating-preview': ! previewHtml,\n\t\t} ),\n\t} );\n\n\tif ( ! isRequestingEmbedPreview && ! videoPressUrl ) {\n\t\treturn <VideoPressUploader setAttributes={ setAttributes } attributes={ attributes } />;\n\t}\n\n\t// Generating video preview.\n\tif (\n\t\t( isRequestingEmbedPreview || ! preview ) &&\n\t\tgeneratingPreviewCounter > 0 &&\n\t\tgeneratingPreviewCounter < VIDEO_PREVIEW_ATTEMPTS_LIMIT\n\t) {\n\t\treturn (\n\t\t\t<PlaceholderWrapper>\n\t\t\t\t<Spinner />\n\t\t\t\t{ __( 'Generating preview', 'jetpack-videopress-pkg' ) }\n\t\t\t\t<strong> { generatingPreviewCounter }</strong>\n\t\t\t</PlaceholderWrapper>\n\t\t);\n\t}\n\n\t// 5 - Generating video preview failed.\n\tif ( generatingPreviewCounter >= VIDEO_PREVIEW_ATTEMPTS_LIMIT && ! preview ) {\n\t\treturn (\n\t\t\t<PlaceholderWrapper\n\t\t\t\terrorMessage={ __(\n\t\t\t\t\t'Impossible to get a video preview after ten attempts.',\n\t\t\t\t\t'jetpack-videopress-pkg'\n\t\t\t\t) }\n\t\t\t\tonNoticeRemove={ invalidateResolution }\n\t\t\t>\n\t\t\t\t<div className=\"videopress-uploader__error-actions\">\n\t\t\t\t\t<Button variant=\"primary\" onClick={ invalidateResolution }>\n\t\t\t\t\t\t{ __( 'Try again', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tsetAttributes( { src: undefined, id: undefined, guid: undefined } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Cancel', 'jetpack-videopress-pkg' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</PlaceholderWrapper>\n\t\t);\n\t}\n\n\t// X - Show VideoPress player. @todo: finish\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<VideoPressInspectorControls attributes={ attributes } setAttributes={ setAttributes } />\n\t\t\t<PosterImageBlockControl\n\t\t\t\tattributes={ attributes }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\tclientId={ clientId }\n\t\t\t/>\n\t\t\t<VideoPressPlayer\n\t\t\t\thtml={ html }\n\t\t\t\tisUpdatingPreview={ ! previewHtml }\n\t\t\t\tscripts={ scripts }\n\t\t\t\tattributes={ attributes }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\tisSelected={ isSelected }\n\t\t\t\tclassName=\"wp-block-jetpack-videopress\"\n\t\t\t\tpreview={ preview }\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","/**\n * External dependencies\n */\nimport { useEffect, useState } from '@wordpress/element';\nimport * as tus from 'tus-js-client';\n\nconst jwtsForKeys = {};\n\nexport const getJWT = function ( key ) {\n\treturn new Promise( function ( resolve, reject ) {\n\t\tconst extras = key ? { data: { key } } : {};\n\t\t// eslint-disable-next-line no-undef\n\t\twp.media\n\t\t\t.ajax( 'videopress-get-upload-jwt', { async: true, ...extras } )\n\t\t\t.done( function ( response ) {\n\t\t\t\tresolve( {\n\t\t\t\t\ttoken: response.upload_token,\n\t\t\t\t\tblogId: response.upload_blog_id,\n\t\t\t\t\turl: response.upload_action_url,\n\t\t\t\t} );\n\t\t\t} )\n\t\t\t.fail( function ( reason ) {\n\t\t\t\treject( reason );\n\t\t\t} );\n\t} );\n};\n\nexport const useResumableUploader = ( { onError, onProgress, onSuccess, key } ) => {\n\tconst [ data, setData ] = useState( {} );\n\tconst [ error, setError ] = useState( null );\n\n\t// collect the jwt for the key\n\tuseEffect( () => {\n\t\tgetJWT( key ).then( setData ).catch( setError );\n\t}, [ key ] );\n\n\tconst uploaded = file => {\n\t\tconst upload = new tus.Upload( file, {\n\t\t\tonError: onError,\n\t\t\tonProgress: onProgress,\n\t\t\tendpoint: data.url,\n\t\t\tremoveFingerprintOnSuccess: true,\n\t\t\twithCredentials: false,\n\t\t\tautoRetry: true,\n\t\t\toverridePatchMethod: false,\n\t\t\tchunkSize: 10000000, // 10 Mb.\n\t\t\tallowedFileTypes: [ 'video/*' ],\n\t\t\tmetadata: {\n\t\t\t\tfilename: file.name,\n\t\t\t\tfiletype: file.type,\n\t\t\t},\n\t\t\tretryDelays: [ 0, 1000, 3000, 5000, 10000 ],\n\t\t\tonAfterResponse: function ( req, res ) {\n\t\t\t\t// Why is this not showing the x-headers?\n\t\t\t\tif ( res.getStatus() >= 400 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst GUID_HEADER = 'x-videopress-upload-guid';\n\t\t\t\tconst MEDIA_ID_HEADER = 'x-videopress-upload-media-id';\n\t\t\t\tconst SRC_URL_HEADER = 'x-videopress-upload-src-url';\n\t\t\t\tconst guid = res.getHeader( GUID_HEADER );\n\t\t\t\tconst mediaId = res.getHeader( MEDIA_ID_HEADER );\n\t\t\t\tconst src = res.getHeader( SRC_URL_HEADER );\n\t\t\t\tif ( guid && mediaId && src ) {\n\t\t\t\t\tonSuccess && onSuccess( { id: Number( mediaId ), guid, src } );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst headerMap = {\n\t\t\t\t\t'x-videopress-upload-key-token': 'token',\n\t\t\t\t\t'x-videopress-upload-key': 'key',\n\t\t\t\t};\n\n\t\t\t\tconst tokenData = {};\n\t\t\t\tObject.keys( headerMap ).forEach( function ( header ) {\n\t\t\t\t\tconst value = res.getHeader( header );\n\t\t\t\t\tif ( ! value ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ttokenData[ headerMap[ header ] ] = value;\n\t\t\t\t} );\n\n\t\t\t\tif ( tokenData.key && tokenData.token ) {\n\t\t\t\t\tjwtsForKeys[ tokenData.key ] = tokenData.token;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonBeforeRequest: function ( req ) {\n\t\t\t\t// make ALL requests be either POST or GET to honor the public-api.wordpress.com \"contract\".\n\t\t\t\tconst method = req._method;\n\t\t\t\tif ( [ 'HEAD', 'OPTIONS' ].indexOf( method ) >= 0 ) {\n\t\t\t\t\treq._method = 'GET';\n\t\t\t\t\treq.setHeader( 'X-HTTP-Method-Override', method );\n\t\t\t\t}\n\n\t\t\t\tif ( [ 'DELETE', 'PUT', 'PATCH' ].indexOf( method ) >= 0 ) {\n\t\t\t\t\treq._method = 'POST';\n\t\t\t\t\treq.setHeader( 'X-HTTP-Method-Override', method );\n\t\t\t\t}\n\n\t\t\t\treq._xhr.open( req._method, req._url, true );\n\t\t\t\t// Set the headers again, reopening the xhr resets them.\n\t\t\t\tObject.keys( req._headers ).map( function ( headerName ) {\n\t\t\t\t\treq.setHeader( headerName, req._headers[ headerName ] );\n\t\t\t\t} );\n\n\t\t\t\tif ( 'POST' === method ) {\n\t\t\t\t\tconst hasJWT = !! data.token;\n\t\t\t\t\tif ( hasJWT ) {\n\t\t\t\t\t\treq.setHeader( 'x-videopress-upload-token', data.token );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow 'should never happen';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( [ 'OPTIONS', 'GET', 'HEAD', 'DELETE', 'PUT', 'PATCH' ].indexOf( method ) >= 0 ) {\n\t\t\t\t\tconst url = new URL( req._url );\n\t\t\t\t\tconst path = url.pathname;\n\t\t\t\t\tconst parts = path.split( '/' );\n\t\t\t\t\tconst maybeUploadkey = parts[ parts.length - 1 ];\n\t\t\t\t\tif ( jwtsForKeys[ maybeUploadkey ] ) {\n\t\t\t\t\t\treq.setHeader( 'x-videopress-upload-token', jwtsForKeys[ maybeUploadkey ] );\n\t\t\t\t\t} else if ( 'HEAD' === method ) {\n\t\t\t\t\t\treturn getJWT( maybeUploadkey ).then( responseData => {\n\t\t\t\t\t\t\tjwtsForKeys[ maybeUploadkey ] = responseData.token;\n\t\t\t\t\t\t\treq.setHeader( 'x-videopress-upload-token', responseData.token );\n\t\t\t\t\t\t\treturn req;\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn Promise.resolve( req );\n\t\t\t},\n\t\t} );\n\n\t\tupload.findPreviousUploads().then( function ( previousUploads ) {\n\t\t\tif ( previousUploads.length ) {\n\t\t\t\tupload.resumeFromPreviousUpload( previousUploads[ 0 ] );\n\t\t\t}\n\n\t\t\tupload.start();\n\t\t} );\n\n\t\treturn upload;\n\t};\n\n\treturn [ uploaded, data, error ];\n};\n","/**\n * WordPress dependencies\n */\nimport { createBlock, registerBlockType } from '@wordpress/blocks';\n/**\n * Internal dependencies\n */\nimport metadata from './block.json';\nimport { VideoPressIcon as icon } from './components/icons';\nimport Edit from './edit';\nimport save from './save';\nimport './style.scss';\n\nexport const { name, title, description } = metadata;\n\nregisterBlockType( name, {\n\tedit: Edit,\n\tsave,\n\ticon,\n\ttransforms: {\n\t\tfrom: [\n\t\t\t{\n\t\t\t\ttype: 'block',\n\t\t\t\tblocks: [ 'core/video' ],\n\t\t\t\ttransform: attrs => createBlock( 'jetpack/videopress-block', attrs ),\n\t\t\t},\n\t\t],\n\t\tto: [\n\t\t\t{\n\t\t\t\ttype: 'block',\n\t\t\t\tblocks: [ 'core/video' ],\n\t\t\t\ttransform: attrs => createBlock( 'core/video', attrs ),\n\t\t\t},\n\t\t],\n\t},\n} );\n","/**\n * External dependencies\n */\nimport { RichText, useBlockProps } from '@wordpress/block-editor';\nimport classnames from 'classnames';\n/**\n * Internal dependencies\n */\nimport { getVideoPressUrl } from './utils/url';\n\n/**\n * VideoPress block save function\n *\n * @param {object} props             - Component props.\n * @param {object} props.attributes  - Block attributes.\n * @returns {object}                 - React component.\n */\nexport default function save( { attributes } ) {\n\tconst {\n\t\talign,\n\t\tautoplay,\n\t\tcaption,\n\t\tloop,\n\t\tmuted,\n\t\tcontrols,\n\t\tplaysinline,\n\t\tpreload,\n\t\tuseAverageColor,\n\t\tseekbarColor,\n\t\tseekbarLoadingColor,\n\t\tseekbarPlayedColor,\n\t\tguid,\n\t\tmaxWidth,\n\t\tposter,\n\t} = attributes;\n\n\tconst blockProps = useBlockProps.save( {\n\t\tclassName: classnames( 'wp-block-jetpack-videopress', 'jetpack-videopress-player', {\n\t\t\t[ `align${ align }` ]: align,\n\t\t} ),\n\t} );\n\n\tconst videoPressUrl = getVideoPressUrl( guid, {\n\t\tautoplay,\n\t\tcontrols,\n\t\tloop,\n\t\tmuted,\n\t\tplaysinline,\n\t\tpreload,\n\t\tseekbarColor,\n\t\tseekbarLoadingColor,\n\t\tseekbarPlayedColor,\n\t\tuseAverageColor,\n\t\tposter,\n\t} );\n\n\t// Adjust block with based on custom maxWidth.\n\tconst style = {};\n\tif ( maxWidth && maxWidth.length > 0 && '100%' !== maxWidth ) {\n\t\tstyle.maxWidth = maxWidth;\n\t\tstyle.margin = 'auto';\n\t}\n\n\treturn (\n\t\t<figure { ...blockProps } style={ style }>\n\t\t\t<div className=\"jetpack-videopress-player__wrapper\">\n\t\t\t\t{ `\\n${ videoPressUrl }\\n` /* URL needs to be on its own line. */ }\n\t\t\t</div>\n\n\t\t\t{ ! RichText.isEmpty( caption ) && (\n\t\t\t\t<RichText.Content tagName=\"figcaption\" value={ caption } />\n\t\t\t) }\n\t\t</figure>\n\t);\n}\n","const rawScript = `\n\tif ( ! window?.debug ) {\n\t\twindow.debug = window.parent?.debugBridgeInstance ?? ( () => {} );\n\t}\n\n\tfunction initWPBlockBridge() {\n\t\tdebug( '  building the bridge' );\n\n\t\tconst videoPressIFrame = document.querySelector('iframe');\n\t\tif ( ! videoPressIFrame?.contentWindow ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst videoPressWindow = videoPressIFrame.contentWindow;\n\n\t\t// Allowed events emitted by the videopress API.\n\t\tconst videoPressEventsMap = {\n\t\t\t'videopress_playing': {\n\t\t\t\tname: 'onVideoPressPlaying',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_pause': {\n\t\t\t\tname: 'onVideoPressPause',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_seeking': {\n\t\t\t\tname: 'onVideoPressSeeking',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_resize': {\n\t\t\t\tname: 'onVideoPressResize',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_volumechange': {\n\t\t\t\tname: 'onVideoPressVolumeChange',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_ended': {\n\t\t\t\tname: 'onVideoPressEnded',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_timeupdate': {\n\t\t\t\tname: 'onVideoPressTimeUpdate',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_durationchange': {\n\t\t\t\tname: 'onVideoPressDurationChange',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_progress': {\n\t\t\t\tname: 'onVideoPressProgress',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'videopress_loading_state': {\n\t\t\t\tname: 'onVideoPressLoadingState',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\tvideopress_toggle_fullscreen: {\n\t\t\t\tname: 'onVideoPressToggleFullscreen',\n\t\t\t\ttype: 'event',\n\t\t\t},\n\t\t\t'vpBlockActionPlay': {\n\t\t\t\tname: 'vpBlockActionPlay',\n\t\t\t\ttype: 'action',\n\t\t\t\tvideoPressAction: 'videopress_action_play',\n\t\t\t},\n\t\t\t'vpBlockActionPause': {\n\t\t\t\tname: 'vpBlockActionPause',\n\t\t\t\ttype: 'action',\n\t\t\t\tvideoPressAction: 'videopress_action_pause',\n\t\t\t},\n\t\t\t'vpBlockActionSetCurrentTime': {\n\t\t\t\tname: 'vpBlockActionPause',\n\t\t\t\ttype: 'action',\n\t\t\t\tvideoPressAction: 'videopress_action_set_currenttime',\n\t\t\t},\n\t\t};\n\n\t\tconst allowedVideoPressEvents = Object.keys( videoPressEventsMap );\n\n\t\twindow.addEventListener( 'message', ( ev ) => {\n\t\t\tconst { data } = ev;\n\t\t\tconst eventName = data.event;\n\t\t\tif ( ! allowedVideoPressEvents.includes( eventName ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\t// Rename event with the 'onVideoPress' prefix.\n\t\t\tconst vpEvent = videoPressEventsMap[ eventName ];\n\t\t\tconst { name: vpEventName, type: vpEventType, videoPressAction } = vpEvent;\n\n\t\t\t// Dispatch event to top when it's an event\n\t\t\tif ( vpEventType === 'event' ) {\n\t\t\t\t// It preferrs to use the guid instead of the id.\n\t\t\t\tconst guid = data.id;\n\t\t\t\tconst originalEventName = data.event;\n\t\n\t\t\t\t// clean event data object\n\t\t\t\tdelete data.event;\n\t\t\t\tdelete data.id;\n\t\n\t\t\t\t// Emite custom event with the event data.\n\t\t\t\tconst videoPressBlockEvent = new CustomEvent( vpEventName, {\n\t\t\t\t\tdetail: {\n\t\t\t\t\t\t...data,\n\t\t\t\t\t\toriginalEventName,\n\t\t\t\t\t\tguid,\n\t\t\t\t\t},\n\t\t\t\t} );\n\n\t\t\t\tdebug( ' %o [%s]  %o', originalEventName, guid, vpEventName );\n\n\t\t\t\t// Dispatch custom event in iFrame window...\n\t\t\t\twindow.dispatchEvent( videoPressBlockEvent );\n\n\t\t\t\t// ...and also dipatch to the parent window,\n\t\t\t\t// in case it exists.\n\t\t\t\tif ( window?.parent && window.parent !== window ) {\n\t\t\t\t\twindow.parent.dispatchEvent( videoPressBlockEvent );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( vpEventType === 'action' ) {\n\t\t\t\t// Overwrite event from -> to\n\t\t\t\tdata.event = videoPressAction;\n\n\t\t\t\tdebug( ' recieve %o -> dispatching %o [%o]', eventName, videoPressAction, data );\n\t\t\t\tvideoPressWindow.postMessage( data, '*' );\n\t\t\t}\n\t\t} );\n\t}\n\n\tinitWPBlockBridge();\n`;\n\nexport default URL.createObjectURL( new Blob( [ rawScript ], { type: 'text/javascript' } ) );\n","import { addQueryArgs } from '@wordpress/url';\n\nexport const getVideoPressUrl = (\n\tguid,\n\t{\n\t\tautoplay,\n\t\tcontrols,\n\t\tloop,\n\t\tmuted,\n\t\tplaysinline,\n\t\tposter,\n\t\tpreload,\n\t\tseekbarColor,\n\t\tseekbarPlayedColor,\n\t\tseekbarLoadingColor,\n\t\tuseAverageColor,\n\t}\n) => {\n\tif ( ! guid ) {\n\t\treturn null;\n\t}\n\n\t// In order to have a cleaner URL, we only set the options differing from the default VideoPress player settings:\n\t// - Autoplay: Turned off by default.\n\t// - Controls: Turned on by default.\n\t// - Loop: Turned off by default.\n\t// - Muted: Turned off by default.\n\t// - Plays Inline: Turned off by default.\n\t// - Poster: No image by default.\n\t// - Preload: None by default.\n\tconst options = {\n\t\tresizeToParent: true,\n\t\tcover: true,\n\t\t...( autoplay && { autoPlay: true } ),\n\t\t...( ! controls && { controls: false } ),\n\t\t...( loop && { loop: true } ),\n\t\t...( muted && { muted: true, persistVolume: false } ),\n\t\t...( playsinline && { playsinline: true } ),\n\t\t...( poster && { posterUrl: poster } ),\n\t\t...( preload !== 'none' && { preloadContent: preload } ),\n\t\t...( seekbarColor !== '' && { sbc: seekbarColor } ),\n\t\t...( seekbarPlayedColor !== '' && { sbpc: seekbarPlayedColor } ),\n\t\t...( seekbarLoadingColor !== '' && { sblc: seekbarLoadingColor } ),\n\t\t...( useAverageColor && { useAverageColor: true } ),\n\t};\n\treturn addQueryArgs( `https://videopress.com/v/${ guid }`, options );\n};\n","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport isReactNative from './isReactNative';\nimport uriToBlob from './uriToBlob';\nimport isCordova from './isCordova';\nimport readAsByteArray from './readAsByteArray';\n\nvar FileSource = /*#__PURE__*/function () {\n  // Make this.size a method\n  function FileSource(file) {\n    _classCallCheck(this, FileSource);\n\n    this._file = file;\n    this.size = file.size;\n  }\n\n  _createClass(FileSource, [{\n    key: \"slice\",\n    value: function slice(start, end) {\n      // In Apache Cordova applications, a File must be resolved using\n      // FileReader instances, see\n      // https://cordova.apache.org/docs/en/8.x/reference/cordova-plugin-file/index.html#read-a-file\n      if (isCordova()) {\n        return readAsByteArray(this._file.slice(start, end));\n      }\n\n      var value = this._file.slice(start, end);\n\n      return Promise.resolve({\n        value: value\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {// Nothing to do here since we don't need to release any resources.\n    }\n  }]);\n\n  return FileSource;\n}();\n\nvar StreamSource = /*#__PURE__*/function () {\n  function StreamSource(reader, chunkSize) {\n    _classCallCheck(this, StreamSource);\n\n    this._chunkSize = chunkSize;\n    this._buffer = undefined;\n    this._bufferOffset = 0;\n    this._reader = reader;\n    this._done = false;\n  }\n\n  _createClass(StreamSource, [{\n    key: \"slice\",\n    value: function slice(start, end) {\n      if (start < this._bufferOffset) {\n        return Promise.reject(new Error(\"Requested data is before the reader's current offset\"));\n      }\n\n      return this._readUntilEnoughDataOrDone(start, end);\n    }\n  }, {\n    key: \"_readUntilEnoughDataOrDone\",\n    value: function _readUntilEnoughDataOrDone(start, end) {\n      var _this = this;\n\n      var hasEnoughData = end <= this._bufferOffset + len(this._buffer);\n\n      if (this._done || hasEnoughData) {\n        var value = this._getDataFromBuffer(start, end);\n\n        var done = value == null ? this._done : false;\n        return Promise.resolve({\n          value: value,\n          done: done\n        });\n      }\n\n      return this._reader.read().then(function (_ref) {\n        var value = _ref.value,\n            done = _ref.done;\n\n        if (done) {\n          _this._done = true;\n        } else if (_this._buffer === undefined) {\n          _this._buffer = value;\n        } else {\n          _this._buffer = concat(_this._buffer, value);\n        }\n\n        return _this._readUntilEnoughDataOrDone(start, end);\n      });\n    }\n  }, {\n    key: \"_getDataFromBuffer\",\n    value: function _getDataFromBuffer(start, end) {\n      // Remove data from buffer before `start`.\n      // Data might be reread from the buffer if an upload fails, so we can only\n      // safely delete data when it comes *before* what is currently being read.\n      if (start > this._bufferOffset) {\n        this._buffer = this._buffer.slice(start - this._bufferOffset);\n        this._bufferOffset = start;\n      } // If the buffer is empty after removing old data, all data has been read.\n\n\n      var hasAllDataBeenRead = len(this._buffer) === 0;\n\n      if (this._done && hasAllDataBeenRead) {\n        return null;\n      } // We already removed data before `start`, so we just return the first\n      // chunk from the buffer.\n\n\n      return this._buffer.slice(0, end - start);\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (this._reader.cancel) {\n        this._reader.cancel();\n      }\n    }\n  }]);\n\n  return StreamSource;\n}();\n\nfunction len(blobOrArray) {\n  if (blobOrArray === undefined) return 0;\n  if (blobOrArray.size !== undefined) return blobOrArray.size;\n  return blobOrArray.length;\n}\n/*\n  Typed arrays and blobs don't have a concat method.\n  This function helps StreamSource accumulate data to reach chunkSize.\n*/\n\n\nfunction concat(a, b) {\n  if (a.concat) {\n    // Is `a` an Array?\n    return a.concat(b);\n  }\n\n  if (a instanceof Blob) {\n    return new Blob([a, b], {\n      type: a.type\n    });\n  }\n\n  if (a.set) {\n    // Is `a` a typed array?\n    var c = new a.constructor(a.length + b.length);\n    c.set(a);\n    c.set(b, a.length);\n    return c;\n  }\n\n  throw new Error('Unknown data type');\n}\n\nvar FileReader = /*#__PURE__*/function () {\n  function FileReader() {\n    _classCallCheck(this, FileReader);\n  }\n\n  _createClass(FileReader, [{\n    key: \"openFile\",\n    value: function openFile(input, chunkSize) {\n      // In React Native, when user selects a file, instead of a File or Blob,\n      // you usually get a file object {} with a uri property that contains\n      // a local path to the file. We use XMLHttpRequest to fetch\n      // the file blob, before uploading with tus.\n      if (isReactNative() && input && typeof input.uri !== 'undefined') {\n        return uriToBlob(input.uri).then(function (blob) {\n          return new FileSource(blob);\n        })[\"catch\"](function (err) {\n          throw new Error(\"tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. \".concat(err));\n        });\n      } // Since we emulate the Blob type in our tests (not all target browsers\n      // support it), we cannot use `instanceof` for testing whether the input value\n      // can be handled. Instead, we simply check is the slice() function and the\n      // size property are available.\n\n\n      if (typeof input.slice === 'function' && typeof input.size !== 'undefined') {\n        return Promise.resolve(new FileSource(input));\n      }\n\n      if (typeof input.read === 'function') {\n        chunkSize = +chunkSize;\n\n        if (!isFinite(chunkSize)) {\n          return Promise.reject(new Error('cannot create source for stream without a finite value for the `chunkSize` option'));\n        }\n\n        return Promise.resolve(new StreamSource(input, chunkSize));\n      }\n\n      return Promise.reject(new Error('source object may only be an instance of File, Blob, or Reader in this environment'));\n    }\n  }]);\n\n  return FileReader;\n}();\n\nexport { FileReader as default };","import isReactNative from './isReactNative'; // TODO: Differenciate between input types\n\n/**\n * Generate a fingerprint for a file which will be used the store the endpoint\n *\n * @param {File} file\n * @param {Object} options\n * @param {Function} callback\n */\n\nexport default function fingerprint(file, options) {\n  if (isReactNative()) {\n    return Promise.resolve(reactNativeFingerprint(file, options));\n  }\n\n  return Promise.resolve(['tus-br', file.name, file.type, file.size, file.lastModified, options.endpoint].join('-'));\n}\n\nfunction reactNativeFingerprint(file, options) {\n  var exifHash = file.exif ? hashCode(JSON.stringify(file.exif)) : 'noexif';\n  return ['tus-rn', file.name || 'noname', file.size || 'nosize', exifHash, options.endpoint].join('/');\n}\n\nfunction hashCode(str) {\n  // from https://stackoverflow.com/a/8831937/151666\n  var hash = 0;\n\n  if (str.length === 0) {\n    return hash;\n  }\n\n  for (var i = 0; i < str.length; i++) {\n    var _char = str.charCodeAt(i);\n\n    hash = (hash << 5) - hash + _char;\n    hash &= hash; // Convert to 32bit integer\n  }\n\n  return hash;\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* global window */\nvar XHRHttpStack = /*#__PURE__*/function () {\n  function XHRHttpStack() {\n    _classCallCheck(this, XHRHttpStack);\n  }\n\n  _createClass(XHRHttpStack, [{\n    key: \"createRequest\",\n    value: function createRequest(method, url) {\n      return new Request(method, url);\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return 'XHRHttpStack';\n    }\n  }]);\n\n  return XHRHttpStack;\n}();\n\nexport { XHRHttpStack as default };\n\nvar Request = /*#__PURE__*/function () {\n  function Request(method, url) {\n    _classCallCheck(this, Request);\n\n    this._xhr = new XMLHttpRequest();\n\n    this._xhr.open(method, url, true);\n\n    this._method = method;\n    this._url = url;\n    this._headers = {};\n  }\n\n  _createClass(Request, [{\n    key: \"getMethod\",\n    value: function getMethod() {\n      return this._method;\n    }\n  }, {\n    key: \"getURL\",\n    value: function getURL() {\n      return this._url;\n    }\n  }, {\n    key: \"setHeader\",\n    value: function setHeader(header, value) {\n      this._xhr.setRequestHeader(header, value);\n\n      this._headers[header] = value;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(header) {\n      return this._headers[header];\n    }\n  }, {\n    key: \"setProgressHandler\",\n    value: function setProgressHandler(progressHandler) {\n      // Test support for progress events before attaching an event listener\n      if (!('upload' in this._xhr)) {\n        return;\n      }\n\n      this._xhr.upload.onprogress = function (e) {\n        if (!e.lengthComputable) {\n          return;\n        }\n\n        progressHandler(e.loaded);\n      };\n    }\n  }, {\n    key: \"send\",\n    value: function send() {\n      var _this = this;\n\n      var body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      return new Promise(function (resolve, reject) {\n        _this._xhr.onload = function () {\n          resolve(new Response(_this._xhr));\n        };\n\n        _this._xhr.onerror = function (err) {\n          reject(err);\n        };\n\n        _this._xhr.send(body);\n      });\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      this._xhr.abort();\n\n      return Promise.resolve();\n    }\n  }, {\n    key: \"getUnderlyingObject\",\n    value: function getUnderlyingObject() {\n      return this._xhr;\n    }\n  }]);\n\n  return Request;\n}();\n\nvar Response = /*#__PURE__*/function () {\n  function Response(xhr) {\n    _classCallCheck(this, Response);\n\n    this._xhr = xhr;\n  }\n\n  _createClass(Response, [{\n    key: \"getStatus\",\n    value: function getStatus() {\n      return this._xhr.status;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(header) {\n      return this._xhr.getResponseHeader(header);\n    }\n  }, {\n    key: \"getBody\",\n    value: function getBody() {\n      return this._xhr.responseText;\n    }\n  }, {\n    key: \"getUnderlyingObject\",\n    value: function getUnderlyingObject() {\n      return this._xhr;\n    }\n  }]);\n\n  return Response;\n}();","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* global window */\nimport BaseUpload from '../upload';\nimport NoopUrlStorage from '../noopUrlStorage';\nimport { enableDebugLog } from '../logger';\nimport { canStoreURLs, WebStorageUrlStorage } from './urlStorage';\nimport HttpStack from './httpStack';\nimport FileReader from './fileReader';\nimport fingerprint from './fingerprint';\n\nvar defaultOptions = _objectSpread({}, BaseUpload.defaultOptions, {\n  httpStack: new HttpStack(),\n  fileReader: new FileReader(),\n  urlStorage: canStoreURLs ? new WebStorageUrlStorage() : new NoopUrlStorage(),\n  fingerprint: fingerprint\n});\n\nvar Upload = /*#__PURE__*/function (_BaseUpload) {\n  _inherits(Upload, _BaseUpload);\n\n  var _super = _createSuper(Upload);\n\n  function Upload() {\n    var file = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Upload);\n\n    options = _objectSpread({}, defaultOptions, {}, options);\n    return _super.call(this, file, options);\n  }\n\n  _createClass(Upload, null, [{\n    key: \"terminate\",\n    value: function terminate(url, options, cb) {\n      options = _objectSpread({}, defaultOptions, {}, options);\n      return BaseUpload.terminate(url, options, cb);\n    }\n  }]);\n\n  return Upload;\n}(BaseUpload);\n\nvar _window = window,\n    XMLHttpRequest = _window.XMLHttpRequest,\n    Blob = _window.Blob;\nvar isSupported = XMLHttpRequest && Blob && typeof Blob.prototype.slice === 'function';\nexport { Upload, canStoreURLs, defaultOptions, isSupported, enableDebugLog, HttpStack };","var isCordova = function isCordova() {\n  return typeof window != 'undefined' && (typeof window.PhoneGap != 'undefined' || typeof window.Cordova != 'undefined' || typeof window.cordova != 'undefined');\n};\n\nexport default isCordova;","var isReactNative = function isReactNative() {\n  return typeof navigator !== 'undefined' && typeof navigator.product === 'string' && navigator.product.toLowerCase() === 'reactnative';\n};\n\nexport default isReactNative;","/**\n * readAsByteArray converts a File object to a Uint8Array.\n * This function is only used on the Apache Cordova platform.\n * See https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-file/index.html#read-a-file\n */\nexport default function readAsByteArray(chunk) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      var value = new Uint8Array(reader.result);\n      resolve({\n        value: value\n      });\n    };\n\n    reader.onerror = function (err) {\n      reject(err);\n    };\n\n    reader.readAsArrayBuffer(chunk);\n  });\n}","/**\n * uriToBlob resolves a URI to a Blob object. This is used for\n * React Native to retrieve a file (identified by a file://\n * URI) as a blob.\n */\nexport default function uriToBlob(uri) {\n  return new Promise(function (resolve, reject) {\n    var xhr = new XMLHttpRequest();\n    xhr.responseType = 'blob';\n\n    xhr.onload = function () {\n      var blob = xhr.response;\n      resolve(blob);\n    };\n\n    xhr.onerror = function (err) {\n      reject(err);\n    };\n\n    xhr.open('GET', uri);\n    xhr.send();\n  });\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* global window, localStorage */\nvar hasStorage = false;\n\ntry {\n  hasStorage = 'localStorage' in window; // Attempt to store and read entries from the local storage to detect Private\n  // Mode on Safari on iOS (see #49)\n\n  var key = 'tusSupport';\n  localStorage.setItem(key, localStorage.getItem(key));\n} catch (e) {\n  // If we try to access localStorage inside a sandboxed iframe, a SecurityError\n  // is thrown. When in private mode on iOS Safari, a QuotaExceededError is\n  // thrown (see #49)\n  if (e.code === e.SECURITY_ERR || e.code === e.QUOTA_EXCEEDED_ERR) {\n    hasStorage = false;\n  } else {\n    throw e;\n  }\n}\n\nexport var canStoreURLs = hasStorage;\nexport var WebStorageUrlStorage = /*#__PURE__*/function () {\n  function WebStorageUrlStorage() {\n    _classCallCheck(this, WebStorageUrlStorage);\n  }\n\n  _createClass(WebStorageUrlStorage, [{\n    key: \"findAllUploads\",\n    value: function findAllUploads() {\n      var results = this._findEntries('tus::');\n\n      return Promise.resolve(results);\n    }\n  }, {\n    key: \"findUploadsByFingerprint\",\n    value: function findUploadsByFingerprint(fingerprint) {\n      var results = this._findEntries(\"tus::\".concat(fingerprint, \"::\"));\n\n      return Promise.resolve(results);\n    }\n  }, {\n    key: \"removeUpload\",\n    value: function removeUpload(urlStorageKey) {\n      localStorage.removeItem(urlStorageKey);\n      return Promise.resolve();\n    }\n  }, {\n    key: \"addUpload\",\n    value: function addUpload(fingerprint, upload) {\n      var id = Math.round(Math.random() * 1e12);\n      var key = \"tus::\".concat(fingerprint, \"::\").concat(id);\n      localStorage.setItem(key, JSON.stringify(upload));\n      return Promise.resolve(key);\n    }\n  }, {\n    key: \"_findEntries\",\n    value: function _findEntries(prefix) {\n      var results = [];\n\n      for (var i = 0; i < localStorage.length; i++) {\n        var _key = localStorage.key(i);\n\n        if (_key.indexOf(prefix) !== 0) continue;\n\n        try {\n          var upload = JSON.parse(localStorage.getItem(_key));\n          upload.urlStorageKey = _key;\n          results.push(upload);\n        } catch (e) {// The JSON parse error is intentionally ignored here, so a malformed\n          // entry in the storage cannot prevent an upload.\n        }\n      }\n\n      return results;\n    }\n  }]);\n\n  return WebStorageUrlStorage;\n}();","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar DetailedError = /*#__PURE__*/function (_Error) {\n  _inherits(DetailedError, _Error);\n\n  var _super = _createSuper(DetailedError);\n\n  function DetailedError(message) {\n    var _this;\n\n    var causingErr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var req = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var res = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n    _classCallCheck(this, DetailedError);\n\n    _this = _super.call(this, message);\n    _this.originalRequest = req;\n    _this.originalResponse = res;\n    _this.causingError = causingErr;\n\n    if (causingErr != null) {\n      message += \", caused by \".concat(causingErr.toString());\n    }\n\n    if (req != null) {\n      var requestId = req.getHeader('X-Request-ID') || 'n/a';\n      var method = req.getMethod();\n      var url = req.getURL();\n      var status = res ? res.getStatus() : 'n/a';\n      var body = res ? res.getBody() || '' : 'n/a';\n      message += \", originated from request (method: \".concat(method, \", url: \").concat(url, \", response code: \").concat(status, \", response text: \").concat(body, \", request id: \").concat(requestId, \")\");\n    }\n\n    _this.message = message;\n    return _this;\n  }\n\n  return DetailedError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\nexport default DetailedError;","/* eslint no-console: \"off\" */\nvar isEnabled = false;\nexport function enableDebugLog() {\n  isEnabled = true;\n}\nexport function log(msg) {\n  if (!isEnabled) return;\n  console.log(msg);\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* eslint no-unused-vars: \"off\" */\nvar NoopUrlStorage = /*#__PURE__*/function () {\n  function NoopUrlStorage() {\n    _classCallCheck(this, NoopUrlStorage);\n  }\n\n  _createClass(NoopUrlStorage, [{\n    key: \"listAllUploads\",\n    value: function listAllUploads() {\n      return Promise.resolve([]);\n    }\n  }, {\n    key: \"findUploadsByFingerprint\",\n    value: function findUploadsByFingerprint(fingerprint) {\n      return Promise.resolve([]);\n    }\n  }, {\n    key: \"removeUpload\",\n    value: function removeUpload(urlStorageKey) {\n      return Promise.resolve();\n    }\n  }, {\n    key: \"addUpload\",\n    value: function addUpload(fingerprint, upload) {\n      return Promise.resolve(null);\n    }\n  }]);\n\n  return NoopUrlStorage;\n}();\n\nexport { NoopUrlStorage as default };","function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* global window */\nimport { Base64 } from 'js-base64';\nimport URL from 'url-parse';\nimport DetailedError from './error';\nimport { log } from './logger';\nimport uuid from './uuid';\nvar defaultOptions = {\n  endpoint: null,\n  uploadUrl: null,\n  metadata: {},\n  fingerprint: null,\n  uploadSize: null,\n  onProgress: null,\n  onChunkComplete: null,\n  onSuccess: null,\n  onError: null,\n  _onUploadUrlAvailable: null,\n  overridePatchMethod: false,\n  headers: {},\n  addRequestId: false,\n  onBeforeRequest: null,\n  onAfterResponse: null,\n  onShouldRetry: null,\n  chunkSize: Infinity,\n  retryDelays: [0, 1000, 3000, 5000],\n  parallelUploads: 1,\n  storeFingerprintForResuming: true,\n  removeFingerprintOnSuccess: false,\n  uploadLengthDeferred: false,\n  uploadDataDuringCreation: false,\n  urlStorage: null,\n  fileReader: null,\n  httpStack: null\n};\n\nvar BaseUpload = /*#__PURE__*/function () {\n  function BaseUpload(file, options) {\n    _classCallCheck(this, BaseUpload);\n\n    // Warn about removed options from previous versions\n    if ('resume' in options) {\n      console.log('tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead.'); // eslint-disable-line no-console\n    } // The default options will already be added from the wrapper classes.\n\n\n    this.options = options; // The storage module used to store URLs\n\n    this._urlStorage = this.options.urlStorage; // The underlying File/Blob object\n\n    this.file = file; // The URL against which the file will be uploaded\n\n    this.url = null; // The underlying request object for the current PATCH request\n\n    this._req = null; // The fingerpinrt for the current file (set after start())\n\n    this._fingerprint = null; // The key that the URL storage returned when saving an URL with a fingerprint,\n\n    this._urlStorageKey = null; // The offset used in the current PATCH request\n\n    this._offset = null; // True if the current PATCH request has been aborted\n\n    this._aborted = false; // The file's size in bytes\n\n    this._size = null; // The Source object which will wrap around the given file and provides us\n    // with a unified interface for getting its size and slice chunks from its\n    // content allowing us to easily handle Files, Blobs, Buffers and Streams.\n\n    this._source = null; // The current count of attempts which have been made. Zero indicates none.\n\n    this._retryAttempt = 0; // The timeout's ID which is used to delay the next retry\n\n    this._retryTimeout = null; // The offset of the remote upload before the latest attempt was started.\n\n    this._offsetBeforeRetry = 0; // An array of BaseUpload instances which are used for uploading the different\n    // parts, if the parallelUploads option is used.\n\n    this._parallelUploads = null; // An array of upload URLs which are used for uploading the different\n    // parts, if the parallelUploads option is used.\n\n    this._parallelUploadUrls = null;\n  }\n  /**\n   * Use the Termination extension to delete an upload from the server by sending a DELETE\n   * request to the specified upload URL. This is only possible if the server supports the\n   * Termination extension. If the `options.retryDelays` property is set, the method will\n   * also retry if an error ocurrs.\n   *\n   * @param {String} url The upload's URL which will be terminated.\n   * @param {object} options Optional options for influencing HTTP requests.\n   * @return {Promise} The Promise will be resolved/rejected when the requests finish.\n   */\n\n\n  _createClass(BaseUpload, [{\n    key: \"findPreviousUploads\",\n    value: function findPreviousUploads() {\n      var _this = this;\n\n      return this.options.fingerprint(this.file, this.options).then(function (fingerprint) {\n        return _this._urlStorage.findUploadsByFingerprint(fingerprint);\n      });\n    }\n  }, {\n    key: \"resumeFromPreviousUpload\",\n    value: function resumeFromPreviousUpload(previousUpload) {\n      this.url = previousUpload.uploadUrl || null;\n      this._parallelUploadUrls = previousUpload.parallelUploadUrls || null;\n      this._urlStorageKey = previousUpload.urlStorageKey;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this2 = this;\n\n      var file = this.file;\n\n      if (!file) {\n        this._emitError(new Error('tus: no file or stream to upload provided'));\n\n        return;\n      }\n\n      if (!this.options.endpoint && !this.options.uploadUrl) {\n        this._emitError(new Error('tus: neither an endpoint or an upload URL is provided'));\n\n        return;\n      }\n\n      var retryDelays = this.options.retryDelays;\n\n      if (retryDelays != null && Object.prototype.toString.call(retryDelays) !== '[object Array]') {\n        this._emitError(new Error('tus: the `retryDelays` option must either be an array or null'));\n\n        return;\n      }\n\n      if (this.options.parallelUploads > 1) {\n        // Test which options are incompatible with parallel uploads.\n        ['uploadUrl', 'uploadSize', 'uploadLengthDeferred'].forEach(function (optionName) {\n          if (_this2.options[optionName]) {\n            _this2._emitError(new Error(\"tus: cannot use the \".concat(optionName, \" option when parallelUploads is enabled\")));\n          }\n        });\n      }\n\n      this.options.fingerprint(file, this.options).then(function (fingerprint) {\n        if (fingerprint == null) {\n          log('No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.');\n        } else {\n          log(\"Calculated fingerprint: \".concat(fingerprint));\n        }\n\n        _this2._fingerprint = fingerprint;\n\n        if (_this2._source) {\n          return _this2._source;\n        }\n\n        return _this2.options.fileReader.openFile(file, _this2.options.chunkSize);\n      }).then(function (source) {\n        _this2._source = source; // If the upload was configured to use multiple requests or if we resume from\n        // an upload which used multiple requests, we start a parallel upload.\n\n        if (_this2.options.parallelUploads > 1 || _this2._parallelUploadUrls != null) {\n          _this2._startParallelUpload();\n        } else {\n          _this2._startSingleUpload();\n        }\n      })[\"catch\"](function (err) {\n        _this2._emitError(err);\n      });\n    }\n    /**\n     * Initiate the uploading procedure for a parallelized upload, where one file is split into\n     * multiple request which are run in parallel.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_startParallelUpload\",\n    value: function _startParallelUpload() {\n      var _this3 = this;\n\n      var totalSize = this._size = this._source.size;\n      var totalProgress = 0;\n      this._parallelUploads = [];\n      var partCount = this._parallelUploadUrls != null ? this._parallelUploadUrls.length : this.options.parallelUploads; // The input file will be split into multiple slices which are uploaded in separate\n      // requests. Here we generate the start and end position for the slices.\n\n      var parts = splitSizeIntoParts(this._source.size, partCount, this._parallelUploadUrls); // Create an empty list for storing the upload URLs\n\n      this._parallelUploadUrls = new Array(parts.length); // Generate a promise for each slice that will be resolve if the respective\n      // upload is completed.\n\n      var uploads = parts.map(function (part, index) {\n        var lastPartProgress = 0;\n        return _this3._source.slice(part.start, part.end).then(function (_ref) {\n          var value = _ref.value;\n          return new Promise(function (resolve, reject) {\n            // Merge with the user supplied options but overwrite some values.\n            var options = _objectSpread({}, _this3.options, {\n              // If available, the partial upload should be resumed from a previous URL.\n              uploadUrl: part.uploadUrl || null,\n              // We take manually care of resuming for partial uploads, so they should\n              // not be stored in the URL storage.\n              storeFingerprintForResuming: false,\n              removeFingerprintOnSuccess: false,\n              // Reset the parallelUploads option to not cause recursion.\n              parallelUploads: 1,\n              metadata: {},\n              // Add the header to indicate the this is a partial upload.\n              headers: _objectSpread({}, _this3.options.headers, {\n                'Upload-Concat': 'partial'\n              }),\n              // Reject or resolve the promise if the upload errors or completes.\n              onSuccess: resolve,\n              onError: reject,\n              // Based in the progress for this partial upload, calculate the progress\n              // for the entire final upload.\n              onProgress: function onProgress(newPartProgress) {\n                totalProgress = totalProgress - lastPartProgress + newPartProgress;\n                lastPartProgress = newPartProgress;\n\n                _this3._emitProgress(totalProgress, totalSize);\n              },\n              // Wait until every partial upload has an upload URL, so we can add\n              // them to the URL storage.\n              _onUploadUrlAvailable: function _onUploadUrlAvailable() {\n                _this3._parallelUploadUrls[index] = upload.url; // Test if all uploads have received an URL\n\n                if (_this3._parallelUploadUrls.filter(function (u) {\n                  return !!u;\n                }).length === parts.length) {\n                  _this3._saveUploadInUrlStorage();\n                }\n              }\n            });\n\n            var upload = new BaseUpload(value, options);\n            upload.start(); // Store the upload in an array, so we can later abort them if necessary.\n\n            _this3._parallelUploads.push(upload);\n          });\n        });\n      });\n      var req; // Wait until all partial uploads are finished and we can send the POST request for\n      // creating the final upload.\n\n      Promise.all(uploads).then(function () {\n        req = _this3._openRequest('POST', _this3.options.endpoint);\n        req.setHeader('Upload-Concat', \"final;\".concat(_this3._parallelUploadUrls.join(' '))); // Add metadata if values have been added\n\n        var metadata = encodeMetadata(_this3.options.metadata);\n\n        if (metadata !== '') {\n          req.setHeader('Upload-Metadata', metadata);\n        }\n\n        return _this3._sendRequest(req, null);\n      }).then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this3._emitHttpError(req, res, 'tus: unexpected response while creating upload');\n\n          return;\n        }\n\n        var location = res.getHeader('Location');\n\n        if (location == null) {\n          _this3._emitHttpError(req, res, 'tus: invalid or missing Location header');\n\n          return;\n        }\n\n        _this3.url = resolveUrl(_this3.options.endpoint, location);\n        log(\"Created upload at \".concat(_this3.url));\n\n        _this3._emitSuccess();\n      })[\"catch\"](function (err) {\n        _this3._emitError(err);\n      });\n    }\n    /**\n     * Initiate the uploading procedure for a non-parallel upload. Here the entire file is\n     * uploaded in a sequential matter.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_startSingleUpload\",\n    value: function _startSingleUpload() {\n      // First, we look at the uploadLengthDeferred option.\n      // Next, we check if the caller has supplied a manual upload size.\n      // Finally, we try to use the calculated size from the source object.\n      if (this.options.uploadLengthDeferred) {\n        this._size = null;\n      } else if (this.options.uploadSize != null) {\n        this._size = +this.options.uploadSize;\n\n        if (isNaN(this._size)) {\n          this._emitError(new Error('tus: cannot convert `uploadSize` option into a number'));\n\n          return;\n        }\n      } else {\n        this._size = this._source.size;\n\n        if (this._size == null) {\n          this._emitError(new Error(\"tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option\"));\n\n          return;\n        }\n      } // Reset the aborted flag when the upload is started or else the\n      // _performUpload will stop before sending a request if the upload has been\n      // aborted previously.\n\n\n      this._aborted = false; // The upload had been started previously and we should reuse this URL.\n\n      if (this.url != null) {\n        log(\"Resuming upload from previous URL: \".concat(this.url));\n\n        this._resumeUpload();\n\n        return;\n      } // A URL has manually been specified, so we try to resume\n\n\n      if (this.options.uploadUrl != null) {\n        log(\"Resuming upload from provided URL: \".concat(this.options.url));\n        this.url = this.options.uploadUrl;\n\n        this._resumeUpload();\n\n        return;\n      } // An upload has not started for the file yet, so we start a new one\n\n\n      log('Creating a new upload');\n\n      this._createUpload();\n    }\n    /**\n     * Abort any running request and stop the current upload. After abort is called, no event\n     * handler will be invoked anymore. You can use the `start` method to resume the upload\n     * again.\n     * If `shouldTerminate` is true, the `terminate` function will be called to remove the\n     * current upload from the server.\n     *\n     * @param {boolean} shouldTerminate True if the upload should be deleted from the server.\n     * @return {Promise} The Promise will be resolved/rejected when the requests finish.\n     */\n\n  }, {\n    key: \"abort\",\n    value: function abort(shouldTerminate) {\n      var _this4 = this;\n\n      // Count the number of arguments to see if a callback is being provided in the old style required by tus-js-client 1.x, then throw an error if it is.\n      // `arguments` is a JavaScript built-in variable that contains all of the function's arguments.\n      if (arguments.length > 1 && typeof arguments[1] === 'function') {\n        throw new Error('tus: the abort function does not accept a callback since v2 anymore; please use the returned Promise instead');\n      } // Stop any parallel partial uploads, that have been started in _startParallelUploads.\n\n\n      if (this._parallelUploads != null) {\n        this._parallelUploads.forEach(function (upload) {\n          upload.abort(shouldTerminate);\n        });\n      } // Stop any current running request.\n\n\n      if (this._req !== null) {\n        this._req.abort();\n\n        this._source.close();\n      }\n\n      this._aborted = true; // Stop any timeout used for initiating a retry.\n\n      if (this._retryTimeout != null) {\n        clearTimeout(this._retryTimeout);\n        this._retryTimeout = null;\n      }\n\n      if (!shouldTerminate || this.url == null) {\n        return Promise.resolve();\n      }\n\n      return BaseUpload.terminate(this.url, this.options) // Remove entry from the URL storage since the upload URL is no longer valid.\n      .then(function () {\n        return _this4._removeFromUrlStorage();\n      });\n    }\n  }, {\n    key: \"_emitHttpError\",\n    value: function _emitHttpError(req, res, message, causingErr) {\n      this._emitError(new DetailedError(message, causingErr, req, res));\n    }\n  }, {\n    key: \"_emitError\",\n    value: function _emitError(err) {\n      var _this5 = this;\n\n      // Do not emit errors, e.g. from aborted HTTP requests, if the upload has been stopped.\n      if (this._aborted) return; // Check if we should retry, when enabled, before sending the error to the user.\n\n      if (this.options.retryDelays != null) {\n        // We will reset the attempt counter if\n        // - we were already able to connect to the server (offset != null) and\n        // - we were able to upload a small chunk of data to the server\n        var shouldResetDelays = this._offset != null && this._offset > this._offsetBeforeRetry;\n\n        if (shouldResetDelays) {\n          this._retryAttempt = 0;\n        }\n\n        if (shouldRetry(err, this._retryAttempt, this.options)) {\n          var delay = this.options.retryDelays[this._retryAttempt++];\n          this._offsetBeforeRetry = this._offset;\n          this._retryTimeout = setTimeout(function () {\n            _this5.start();\n          }, delay);\n          return;\n        }\n      }\n\n      if (typeof this.options.onError === 'function') {\n        this.options.onError(err);\n      } else {\n        throw err;\n      }\n    }\n    /**\n     * Publishes notification if the upload has been successfully completed.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_emitSuccess\",\n    value: function _emitSuccess() {\n      if (this.options.removeFingerprintOnSuccess) {\n        // Remove stored fingerprint and corresponding endpoint. This causes\n        // new uploads of the same file to be treated as a different file.\n        this._removeFromUrlStorage();\n      }\n\n      if (typeof this.options.onSuccess === 'function') {\n        this.options.onSuccess();\n      }\n    }\n    /**\n     * Publishes notification when data has been sent to the server. This\n     * data may not have been accepted by the server yet.\n     *\n     * @param {number} bytesSent  Number of bytes sent to the server.\n     * @param {number} bytesTotal Total number of bytes to be sent to the server.\n     * @api private\n     */\n\n  }, {\n    key: \"_emitProgress\",\n    value: function _emitProgress(bytesSent, bytesTotal) {\n      if (typeof this.options.onProgress === 'function') {\n        this.options.onProgress(bytesSent, bytesTotal);\n      }\n    }\n    /**\n     * Publishes notification when a chunk of data has been sent to the server\n     * and accepted by the server.\n     * @param {number} chunkSize  Size of the chunk that was accepted by the server.\n     * @param {number} bytesAccepted Total number of bytes that have been\n     *                                accepted by the server.\n     * @param {number} bytesTotal Total number of bytes to be sent to the server.\n     * @api private\n     */\n\n  }, {\n    key: \"_emitChunkComplete\",\n    value: function _emitChunkComplete(chunkSize, bytesAccepted, bytesTotal) {\n      if (typeof this.options.onChunkComplete === 'function') {\n        this.options.onChunkComplete(chunkSize, bytesAccepted, bytesTotal);\n      }\n    }\n    /**\n     * Create a new upload using the creation extension by sending a POST\n     * request to the endpoint. After successful creation the file will be\n     * uploaded\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_createUpload\",\n    value: function _createUpload() {\n      var _this6 = this;\n\n      if (!this.options.endpoint) {\n        this._emitError(new Error('tus: unable to create upload because no endpoint is provided'));\n\n        return;\n      }\n\n      var req = this._openRequest('POST', this.options.endpoint);\n\n      if (this.options.uploadLengthDeferred) {\n        req.setHeader('Upload-Defer-Length', 1);\n      } else {\n        req.setHeader('Upload-Length', this._size);\n      } // Add metadata if values have been added\n\n\n      var metadata = encodeMetadata(this.options.metadata);\n\n      if (metadata !== '') {\n        req.setHeader('Upload-Metadata', metadata);\n      }\n\n      var promise;\n\n      if (this.options.uploadDataDuringCreation && !this.options.uploadLengthDeferred) {\n        this._offset = 0;\n        promise = this._addChunkToRequest(req);\n      } else {\n        promise = this._sendRequest(req, null);\n      }\n\n      promise.then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this6._emitHttpError(req, res, 'tus: unexpected response while creating upload');\n\n          return;\n        }\n\n        var location = res.getHeader('Location');\n\n        if (location == null) {\n          _this6._emitHttpError(req, res, 'tus: invalid or missing Location header');\n\n          return;\n        }\n\n        _this6.url = resolveUrl(_this6.options.endpoint, location);\n        log(\"Created upload at \".concat(_this6.url));\n\n        if (typeof _this6.options._onUploadUrlAvailable === 'function') {\n          _this6.options._onUploadUrlAvailable();\n        }\n\n        if (_this6._size === 0) {\n          // Nothing to upload and file was successfully created\n          _this6._emitSuccess();\n\n          _this6._source.close();\n\n          return;\n        }\n\n        _this6._saveUploadInUrlStorage();\n\n        if (_this6.options.uploadDataDuringCreation) {\n          _this6._handleUploadResponse(req, res);\n        } else {\n          _this6._offset = 0;\n\n          _this6._performUpload();\n        }\n      })[\"catch\"](function (err) {\n        _this6._emitHttpError(req, null, 'tus: failed to create upload', err);\n      });\n    }\n    /*\n     * Try to resume an existing upload. First a HEAD request will be sent\n     * to retrieve the offset. If the request fails a new upload will be\n     * created. In the case of a successful response the file will be uploaded.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_resumeUpload\",\n    value: function _resumeUpload() {\n      var _this7 = this;\n\n      var req = this._openRequest('HEAD', this.url);\n\n      var promise = this._sendRequest(req, null);\n\n      promise.then(function (res) {\n        var status = res.getStatus();\n\n        if (!inStatusCategory(status, 200)) {\n          if (inStatusCategory(status, 400)) {\n            // Remove stored fingerprint and corresponding endpoint,\n            // on client errors since the file can not be found\n            _this7._removeFromUrlStorage();\n          } // If the upload is locked (indicated by the 423 Locked status code), we\n          // emit an error instead of directly starting a new upload. This way the\n          // retry logic can catch the error and will retry the upload. An upload\n          // is usually locked for a short period of time and will be available\n          // afterwards.\n\n\n          if (status === 423) {\n            _this7._emitHttpError(req, res, 'tus: upload is currently locked; retry later');\n\n            return;\n          }\n\n          if (!_this7.options.endpoint) {\n            // Don't attempt to create a new upload if no endpoint is provided.\n            _this7._emitHttpError(req, res, 'tus: unable to resume upload (new upload cannot be created without an endpoint)');\n\n            return;\n          } // Try to create a new upload\n\n\n          _this7.url = null;\n\n          _this7._createUpload();\n\n          return;\n        }\n\n        var offset = parseInt(res.getHeader('Upload-Offset'), 10);\n\n        if (isNaN(offset)) {\n          _this7._emitHttpError(req, res, 'tus: invalid or missing offset value');\n\n          return;\n        }\n\n        var length = parseInt(res.getHeader('Upload-Length'), 10);\n\n        if (isNaN(length) && !_this7.options.uploadLengthDeferred) {\n          _this7._emitHttpError(req, res, 'tus: invalid or missing length value');\n\n          return;\n        }\n\n        if (typeof _this7.options._onUploadUrlAvailable === 'function') {\n          _this7.options._onUploadUrlAvailable();\n        } // Upload has already been completed and we do not need to send additional\n        // data to the server\n\n\n        if (offset === length) {\n          _this7._emitProgress(length, length);\n\n          _this7._emitSuccess();\n\n          return;\n        }\n\n        _this7._offset = offset;\n\n        _this7._performUpload();\n      })[\"catch\"](function (err) {\n        _this7._emitHttpError(req, null, 'tus: failed to resume upload', err);\n      });\n    }\n    /**\n     * Start uploading the file using PATCH requests. The file will be divided\n     * into chunks as specified in the chunkSize option. During the upload\n     * the onProgress event handler may be invoked multiple times.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_performUpload\",\n    value: function _performUpload() {\n      var _this8 = this;\n\n      // If the upload has been aborted, we will not send the next PATCH request.\n      // This is important if the abort method was called during a callback, such\n      // as onChunkComplete or onProgress.\n      if (this._aborted) {\n        return;\n      }\n\n      var req; // Some browser and servers may not support the PATCH method. For those\n      // cases, you can tell tus-js-client to use a POST request with the\n      // X-HTTP-Method-Override header for simulating a PATCH request.\n\n      if (this.options.overridePatchMethod) {\n        req = this._openRequest('POST', this.url);\n        req.setHeader('X-HTTP-Method-Override', 'PATCH');\n      } else {\n        req = this._openRequest('PATCH', this.url);\n      }\n\n      req.setHeader('Upload-Offset', this._offset);\n\n      var promise = this._addChunkToRequest(req);\n\n      promise.then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this8._emitHttpError(req, res, 'tus: unexpected response while uploading chunk');\n\n          return;\n        }\n\n        _this8._handleUploadResponse(req, res);\n      })[\"catch\"](function (err) {\n        // Don't emit an error if the upload was aborted manually\n        if (_this8._aborted) {\n          return;\n        }\n\n        _this8._emitHttpError(req, null, \"tus: failed to upload chunk at offset \".concat(_this8._offset), err);\n      });\n    }\n    /**\n     * _addChunktoRequest reads a chunk from the source and sends it using the\n     * supplied request object. It will not handle the response.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_addChunkToRequest\",\n    value: function _addChunkToRequest(req) {\n      var _this9 = this;\n\n      var start = this._offset;\n      var end = this._offset + this.options.chunkSize;\n      req.setProgressHandler(function (bytesSent) {\n        _this9._emitProgress(start + bytesSent, _this9._size);\n      });\n      req.setHeader('Content-Type', 'application/offset+octet-stream'); // The specified chunkSize may be Infinity or the calcluated end position\n      // may exceed the file's size. In both cases, we limit the end position to\n      // the input's total size for simpler calculations and correctness.\n\n      if ((end === Infinity || end > this._size) && !this.options.uploadLengthDeferred) {\n        end = this._size;\n      }\n\n      return this._source.slice(start, end).then(function (_ref2) {\n        var value = _ref2.value,\n            done = _ref2.done;\n\n        // If the upload length is deferred, the upload size was not specified during\n        // upload creation. So, if the file reader is done reading, we know the total\n        // upload size and can tell the tus server.\n        if (_this9.options.uploadLengthDeferred && done) {\n          _this9._size = _this9._offset + (value && value.size ? value.size : 0);\n          req.setHeader('Upload-Length', _this9._size);\n        }\n\n        if (value === null) {\n          return _this9._sendRequest(req);\n        }\n\n        _this9._emitProgress(_this9._offset, _this9._size);\n\n        return _this9._sendRequest(req, value);\n      });\n    }\n    /**\n     * _handleUploadResponse is used by requests that haven been sent using _addChunkToRequest\n     * and already have received a response.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_handleUploadResponse\",\n    value: function _handleUploadResponse(req, res) {\n      var offset = parseInt(res.getHeader('Upload-Offset'), 10);\n\n      if (isNaN(offset)) {\n        this._emitHttpError(req, res, 'tus: invalid or missing offset value');\n\n        return;\n      }\n\n      this._emitProgress(offset, this._size);\n\n      this._emitChunkComplete(offset - this._offset, offset, this._size);\n\n      this._offset = offset;\n\n      if (offset == this._size) {\n        // Yay, finally done :)\n        this._emitSuccess();\n\n        this._source.close();\n\n        return;\n      }\n\n      this._performUpload();\n    }\n    /**\n     * Create a new HTTP request object with the given method and URL.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_openRequest\",\n    value: function _openRequest(method, url) {\n      var req = openRequest(method, url, this.options);\n      this._req = req;\n      return req;\n    }\n    /**\n     * Remove the entry in the URL storage, if it has been saved before.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_removeFromUrlStorage\",\n    value: function _removeFromUrlStorage() {\n      var _this10 = this;\n\n      if (!this._urlStorageKey) return;\n\n      this._urlStorage.removeUpload(this._urlStorageKey)[\"catch\"](function (err) {\n        _this10._emitError(err);\n      });\n\n      this._urlStorageKey = null;\n    }\n    /**\n     * Add the upload URL to the URL storage, if possible.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_saveUploadInUrlStorage\",\n    value: function _saveUploadInUrlStorage() {\n      var _this11 = this;\n\n      // Only if a fingerprint was calculated for the input (i.e. not a stream), we can store the upload URL.\n      if (!this.options.storeFingerprintForResuming || !this._fingerprint) {\n        return;\n      }\n\n      var storedUpload = {\n        size: this._size,\n        metadata: this.options.metadata,\n        creationTime: new Date().toString()\n      };\n\n      if (this._parallelUploads) {\n        // Save multiple URLs if the parallelUploads option is used ...\n        storedUpload.parallelUploadUrls = this._parallelUploadUrls;\n      } else {\n        // ... otherwise we just save the one available URL.\n        storedUpload.uploadUrl = this.url;\n      }\n\n      this._urlStorage.addUpload(this._fingerprint, storedUpload).then(function (urlStorageKey) {\n        return _this11._urlStorageKey = urlStorageKey;\n      })[\"catch\"](function (err) {\n        _this11._emitError(err);\n      });\n    }\n    /**\n     * Send a request with the provided body.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_sendRequest\",\n    value: function _sendRequest(req) {\n      var body = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      return sendRequest(req, body, this.options);\n    }\n  }], [{\n    key: \"terminate\",\n    value: function terminate(url, options) {\n      // Count the number of arguments to see if a callback is being provided as the last\n      // argument in the old style required by tus-js-client 1.x, then throw an error if it is.\n      // `arguments` is a JavaScript built-in variable that contains all of the function's arguments.\n      if (arguments.length > 1 && typeof arguments[arguments.length - 1] === 'function') {\n        throw new Error('tus: the terminate function does not accept a callback since v2 anymore; please use the returned Promise instead');\n      } // Note that in order for the trick above to work, a default value cannot be set for `options`,\n      // so the check below replaces the old default `{}`.\n\n\n      if (options === undefined) {\n        options = {};\n      }\n\n      var req = openRequest('DELETE', url, options);\n      return sendRequest(req, null, options).then(function (res) {\n        // A 204 response indicates a successfull request\n        if (res.getStatus() === 204) {\n          return;\n        }\n\n        throw new DetailedError('tus: unexpected response while terminating upload', null, req, res);\n      })[\"catch\"](function (err) {\n        if (!(err instanceof DetailedError)) {\n          err = new DetailedError('tus: failed to terminate upload', err, req, null);\n        }\n\n        if (!shouldRetry(err, 0, options)) {\n          throw err;\n        } // Instead of keeping track of the retry attempts, we remove the first element from the delays\n        // array. If the array is empty, all retry attempts are used up and we will bubble up the error.\n        // We recursively call the terminate function will removing elements from the retryDelays array.\n\n\n        var delay = options.retryDelays[0];\n        var remainingDelays = options.retryDelays.slice(1);\n\n        var newOptions = _objectSpread({}, options, {\n          retryDelays: remainingDelays\n        });\n\n        return new Promise(function (resolve) {\n          return setTimeout(resolve, delay);\n        }).then(function () {\n          return BaseUpload.terminate(url, newOptions);\n        });\n      });\n    }\n  }]);\n\n  return BaseUpload;\n}();\n\nfunction encodeMetadata(metadata) {\n  var encoded = [];\n\n  for (var key in metadata) {\n    encoded.push(\"\".concat(key, \" \").concat(Base64.encode(metadata[key])));\n  }\n\n  return encoded.join(',');\n}\n/**\n * Checks whether a given status is in the range of the expected category.\n * For example, only a status between 200 and 299 will satisfy the category 200.\n *\n * @api private\n */\n\n\nfunction inStatusCategory(status, category) {\n  return status >= category && status < category + 100;\n}\n/**\n * Create a new HTTP request with the specified method and URL.\n * The necessary headers that are included in every request\n * will be added, including the request ID.\n *\n * @api private\n */\n\n\nfunction openRequest(method, url, options) {\n  var req = options.httpStack.createRequest(method, url);\n  req.setHeader('Tus-Resumable', '1.0.0');\n  var headers = options.headers || {};\n\n  for (var name in headers) {\n    req.setHeader(name, headers[name]);\n  }\n\n  if (options.addRequestId) {\n    var requestId = uuid();\n    req.setHeader('X-Request-ID', requestId);\n  }\n\n  return req;\n}\n/**\n * Send a request with the provided body while invoking the onBeforeRequest\n * and onAfterResponse callbacks.\n *\n * @api private\n */\n\n\nfunction sendRequest(req, body, options) {\n  var onBeforeRequestPromise = typeof options.onBeforeRequest === 'function' ? Promise.resolve(options.onBeforeRequest(req)) : Promise.resolve();\n  return onBeforeRequestPromise.then(function () {\n    return req.send(body).then(function (res) {\n      var onAfterResponsePromise = typeof options.onAfterResponse === 'function' ? Promise.resolve(options.onAfterResponse(req, res)) : Promise.resolve();\n      return onAfterResponsePromise.then(function () {\n        return res;\n      });\n    });\n  });\n}\n/**\n * Checks whether the browser running this code has internet access.\n * This function will always return true in the node.js environment\n *\n * @api private\n */\n\n\nfunction isOnline() {\n  var online = true;\n\n  if (typeof window !== 'undefined' && 'navigator' in window && window.navigator.onLine === false) {\n    online = false;\n  }\n\n  return online;\n}\n/**\n * Checks whether or not it is ok to retry a request.\n * @param {Error} err the error returned from the last request\n * @param {number} retryAttempt the number of times the request has already been retried\n * @param {object} options tus Upload options\n *\n * @api private\n */\n\n\nfunction shouldRetry(err, retryAttempt, options) {\n  // We only attempt a retry if\n  // - retryDelays option is set\n  // - we didn't exceed the maxium number of retries, yet, and\n  // - this error was caused by a request or it's response and\n  // - the error is server error (i.e. not a status 4xx except a 409 or 423) or\n  // a onShouldRetry is specified and returns true\n  // - the browser does not indicate that we are offline\n  if (options.retryDelays == null || retryAttempt >= options.retryDelays.length || err.originalRequest == null) {\n    return false;\n  }\n\n  if (options && typeof options.onShouldRetry === 'function') {\n    return options.onShouldRetry(err, retryAttempt, options);\n  }\n\n  var status = err.originalResponse ? err.originalResponse.getStatus() : 0;\n  return (!inStatusCategory(status, 400) || status === 409 || status === 423) && isOnline();\n}\n/**\n * Resolve a relative link given the origin as source. For example,\n * if a HTTP request to http://example.com/files/ returns a Location\n * header with the value /upload/abc, the resolved URL will be:\n * http://example.com/upload/abc\n */\n\n\nfunction resolveUrl(origin, link) {\n  return new URL(link, origin).toString();\n}\n/**\n * Calculate the start and end positions for the parts if an upload\n * is split into multiple parallel requests.\n *\n * @param {number} totalSize The byte size of the upload, which will be split.\n * @param {number} partCount The number in how many parts the upload will be split.\n * @param {string[]} previousUrls The upload URLs for previous parts.\n * @return {object[]}\n * @api private\n */\n\n\nfunction splitSizeIntoParts(totalSize, partCount, previousUrls) {\n  var partSize = Math.floor(totalSize / partCount);\n  var parts = [];\n\n  for (var i = 0; i < partCount; i++) {\n    parts.push({\n      start: partSize * i,\n      end: partSize * (i + 1)\n    });\n  }\n\n  parts[partCount - 1].end = totalSize; // Attach URLs from previous uploads, if available.\n\n  if (previousUrls) {\n    parts.forEach(function (part, index) {\n      part.uploadUrl = previousUrls[index] || null;\n    });\n  }\n\n  return parts;\n}\n\nBaseUpload.defaultOptions = defaultOptions;\nexport default BaseUpload;","/**\n * Generate a UUID v4 based on random numbers. We intentioanlly use the less\n * secure Math.random function here since the more secure crypto.getRandomNumbers\n * is not available on all platforms.\n * This is not a problem for us since we use the UUID only for generating a\n * request ID, so we can correlate server logs to client errors.\n *\n * This function is taken from following site:\n * https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n *\n * @return {string} The generate UUID\n */\nexport default function uuid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c == 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , controlOrWhitespace = /^[\\x00-\\x20\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+/\n  , CRHTLF = /[\\n\\r\\t]/g\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//\n  , port = /:\\d+$/\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\\\/]+)?([\\S\\s]*)/i\n  , windowsDriveLetter = /^[a-zA-Z]:/;\n\n/**\n * Remove control characters and whitespace from the beginning of a string.\n *\n * @param {Object|String} str String to trim.\n * @returns {String} A new string representing `str` stripped of control\n *     characters and whitespace from its beginning.\n * @public\n */\nfunction trimLeft(str) {\n  return (str ? str : '').toString().replace(controlOrWhitespace, '');\n}\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  function sanitize(address, url) {     // Sanitize what is left of the address\n    return isSpecial(url.protocol) ? address.replace(/\\\\/g, '/') : address;\n  },\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d*)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @public\n */\nfunction lolcation(loc) {\n  var globalVar;\n\n  if (typeof window !== 'undefined') globalVar = window;\n  else if (typeof global !== 'undefined') globalVar = global;\n  else if (typeof self !== 'undefined') globalVar = self;\n  else globalVar = {};\n\n  var location = globalVar.location || {};\n  loc = loc || location;\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new Url(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new Url(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * Check whether a protocol scheme is special.\n *\n * @param {String} The protocol scheme of the URL\n * @return {Boolean} `true` if the protocol scheme is special, else `false`\n * @private\n */\nfunction isSpecial(scheme) {\n  return (\n    scheme === 'file:' ||\n    scheme === 'ftp:' ||\n    scheme === 'http:' ||\n    scheme === 'https:' ||\n    scheme === 'ws:' ||\n    scheme === 'wss:'\n  );\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @param {Object} location\n * @return {ProtocolExtract} Extracted information.\n * @private\n */\nfunction extractProtocol(address, location) {\n  address = trimLeft(address);\n  address = address.replace(CRHTLF, '');\n  location = location || {};\n\n  var match = protocolre.exec(address);\n  var protocol = match[1] ? match[1].toLowerCase() : '';\n  var forwardSlashes = !!match[2];\n  var otherSlashes = !!match[3];\n  var slashesCount = 0;\n  var rest;\n\n  if (forwardSlashes) {\n    if (otherSlashes) {\n      rest = match[2] + match[3] + match[4];\n      slashesCount = match[2].length + match[3].length;\n    } else {\n      rest = match[2] + match[4];\n      slashesCount = match[2].length;\n    }\n  } else {\n    if (otherSlashes) {\n      rest = match[3] + match[4];\n      slashesCount = match[3].length;\n    } else {\n      rest = match[4]\n    }\n  }\n\n  if (protocol === 'file:') {\n    if (slashesCount >= 2) {\n      rest = rest.slice(2);\n    }\n  } else if (isSpecial(protocol)) {\n    rest = match[4];\n  } else if (protocol) {\n    if (forwardSlashes) {\n      rest = rest.slice(2);\n    }\n  } else if (slashesCount >= 2 && isSpecial(location.protocol)) {\n    rest = match[4];\n  }\n\n  return {\n    protocol: protocol,\n    slashes: forwardSlashes || isSpecial(protocol),\n    slashesCount: slashesCount,\n    rest: rest\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @private\n */\nfunction resolve(relative, base) {\n  if (relative === '') return base;\n\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * It is worth noting that we should not use `URL` as class name to prevent\n * clashes with the global URL instance that got introduced in browsers.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} [location] Location defaults for relative paths.\n * @param {Boolean|Function} [parser] Parser for the query string.\n * @private\n */\nfunction Url(address, location, parser) {\n  address = trimLeft(address);\n  address = address.replace(CRHTLF, '');\n\n  if (!(this instanceof Url)) {\n    return new Url(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '', location);\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (\n    extracted.protocol === 'file:' && (\n      extracted.slashesCount !== 2 || windowsDriveLetter.test(address)) ||\n    (!extracted.slashes &&\n      (extracted.protocol ||\n        extracted.slashesCount < 2 ||\n        !isSpecial(url.protocol)))\n  ) {\n    instructions[3] = [/(.*)/, 'pathname'];\n  }\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n\n    if (typeof instruction === 'function') {\n      address = instruction(address, url);\n      continue;\n    }\n\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      index = parse === '@'\n        ? address.lastIndexOf(parse)\n        : address.indexOf(parse);\n\n      if (~index) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // Default to a / for pathname if none exists. This normalizes the URL\n  // to always have a /\n  //\n  if (url.pathname.charAt(0) !== '/' && isSpecial(url.protocol)) {\n    url.pathname = '/' + url.pathname;\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n\n  if (url.auth) {\n    index = url.auth.indexOf(':');\n\n    if (~index) {\n      url.username = url.auth.slice(0, index);\n      url.username = encodeURIComponent(decodeURIComponent(url.username));\n\n      url.password = url.auth.slice(index + 1);\n      url.password = encodeURIComponent(decodeURIComponent(url.password))\n    } else {\n      url.username = encodeURIComponent(decodeURIComponent(url.auth));\n    }\n\n    url.auth = url.password ? url.username +':'+ url.password : url.username;\n  }\n\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL} URL instance for chaining.\n * @public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (port.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n    case 'hash':\n      if (value) {\n        var char = part === 'pathname' ? '/' : '#';\n        url[part] = value.charAt(0) !== char ? char + value : value;\n      } else {\n        url[part] = value;\n      }\n      break;\n\n    case 'username':\n    case 'password':\n      url[part] = encodeURIComponent(value);\n      break;\n\n    case 'auth':\n      var index = value.indexOf(':');\n\n      if (~index) {\n        url.username = value.slice(0, index);\n        url.username = encodeURIComponent(decodeURIComponent(url.username));\n\n        url.password = value.slice(index + 1);\n        url.password = encodeURIComponent(decodeURIComponent(url.password));\n      } else {\n        url.username = encodeURIComponent(decodeURIComponent(value));\n      }\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.auth = url.password ? url.username +':'+ url.password : url.username;\n\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String} Compiled version of the URL.\n * @public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , host = url.host\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result =\n    protocol +\n    ((url.protocol && url.slashes) || isSpecial(url.protocol) ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  } else if (url.password) {\n    result += ':'+ url.password;\n    result += '@';\n  } else if (\n    url.protocol !== 'file:' &&\n    isSpecial(url.protocol) &&\n    !host &&\n    url.pathname !== '/'\n  ) {\n    //\n    // Add back the empty userinfo, otherwise the original invalid URL\n    // might be transformed into a valid one with `url.pathname` as host.\n    //\n    result += '@';\n  }\n\n  //\n  // Trailing colon is removed from `url.host` when it is parsed. If it still\n  // ends with a colon, then add back the trailing colon that was removed. This\n  // prevents an invalid URL from being transformed into a valid one.\n  //\n  if (host[host.length - 1] === ':' || (port.test(url.hostname) && !url.port)) {\n    host += ':';\n  }\n\n  result += host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nUrl.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nUrl.extractProtocol = extractProtocol;\nUrl.location = lolcation;\nUrl.trimLeft = trimLeft;\nUrl.qs = qs;\n\nmodule.exports = Url;\n","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"coreData\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"escapeHtml\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"primitives\"];","module.exports = window[\"wp\"][\"url\"];","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _extends() {\n  module.exports = _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Internal dependencies\n */\nimport './blocks/videopress/';\n"],"names":["Path","SVG","VideoPressIcon","InspectorControls","PanelBody","ToggleControl","Tooltip","SelectControl","useCallback","SeekbarColorSettings","VideoPressInspectorControls","attributes","setAttributes","autoplay","loop","muted","controls","playsinline","preload","useAverageColor","renderControlLabelWithTooltip","label","tooltipText","handleAttributeChange","attributeName","newValue","__","value","_x","MediaUploadCheck","BlockControls","MediaUpload","ToolbarButton","Dropdown","NavigableMenu","MenuItem","sprintf","linkOff","image","imageIcon","styles","VIDEO_POSTER_ALLOWED_MEDIA_TYPES","PosterImageBlockControl","clientId","poster","onSelectPoster","url","onRemovePoster","currentImage","dropdown_content","isOpen","onToggle","onClose","videoPosterDescription","open","current_media","PanelColorSettings","Button","Component","React","constructor","arguments","newColor","setState","seekbarColor","seekbarLoadingColor","seekbarPlayedColor","state","props","render","toggleAttribute","showTitle","onChange","handleChangeSeekbarColor","handleChangeSeekbarLoadingColor","handleChangeSeekbarPlayedColor","saveColors","RichText","ResizableBox","SandBox","useRef","useEffect","useState","debugFactory","vpBlockBridge","globalScripts","window","videopressAjax","videopresAjaxURLBlob","Blob","JSON","stringify","type","push","URL","createObjectURL","bridgeUrl","debugBridgeInstance","VideoPressPlayer","html","isSelected","scripts","preview","ref","maxWidth","caption","videoRatio","iFrameDomReference","current","querySelector","sandboxWindow","contentWindow","temporaryHeight","setTemporaryHeight","isVideoLoaded","setIsVideoLoaded","offsetWidth","setTimeout","onVideoLoadingStateHandler","detail","addEventListener","removeEventListener","onBlockResize","event","direction","domElement","newMaxWidth","getComputedStyle","width","parentElement","parentWidth","style","height","paddingBottom","top","bottom","left","right","margin","isEmpty","BlockIcon","MediaPlaceholder","withNotices","ExternalLink","createInterpolateElement","escapeHTML","filesize","PlaceholderWrapper","useResumableUploader","description","title","ALLOWED_MEDIA_TYPES","UploadProgress","progress","file","paused","onPauseOrResume","roundedProgress","Math","round","cssWidth","resumeText","pauseText","fileSizeLabel","size","escapedFileName","name","fileNameLabel","strong","UploadError","message","onRetry","onCancel","VideoPressUploader","noticeUI","noticeOperations","uploadPaused","setUploadPaused","tusUploader","uploadFile","setFile","uploadingProgress","setUploadingProgressState","setUploadingProgress","args","uploadErrorData","setUploadErrorDataState","setUploadErrorData","error","originalResponse","body","getBody","parsedBody","parse","isUploadingFile","length","fileHasBeenUploaded","videoPressUploader","onError","onProgress","onSuccess","isValidVideoPressUrl","urlObject","validHosts","protocol","includes","host","getGuidFromVideoUrl","videoGuid","pathname","match","e","onSelectURL","videoUrl","data","guid","src","startUpload","pauseOrResumeUpload","uploader","uploaderCall","onSelectVideo","media","isFileUploading","FileList","videopress_guid","getErrorMessage","errorMessage","instructions","removeAllNotices","createErrorNotice","useBlockProps","Spinner","Placeholder","store","coreStore","useSelect","useDispatch","classNames","getVideoPressUrl","VIDEO_PREVIEW_ATTEMPTS_LIMIT","children","VideoPressEdit","cacheHtml","align","videoPressUrl","isRequestingEmbedPreview","select","getEmbedPreview","previewHtml","previewWidth","previewHeight","ratio","invalidateResolution","invalidateCachedEmbedPreview","generatingPreviewCounter","setGeneratingPreviewCounter","rePreviewAttemptTimer","cleanRegeneratingProcessTimer","clearInterval","v","blockProps","className","undefined","id","tus","jwtsForKeys","getJWT","key","Promise","resolve","reject","extras","wp","ajax","async","done","response","token","upload_token","blogId","upload_blog_id","upload_action_url","fail","reason","setData","setError","then","catch","uploaded","upload","Upload","endpoint","removeFingerprintOnSuccess","withCredentials","autoRetry","overridePatchMethod","chunkSize","allowedFileTypes","metadata","filename","filetype","retryDelays","onAfterResponse","req","res","getStatus","GUID_HEADER","MEDIA_ID_HEADER","SRC_URL_HEADER","getHeader","mediaId","Number","headerMap","tokenData","Object","keys","forEach","header","onBeforeRequest","method","_method","indexOf","setHeader","_xhr","_url","_headers","map","headerName","hasJWT","path","parts","split","maybeUploadkey","responseData","findPreviousUploads","previousUploads","resumeFromPreviousUpload","start","createBlock","registerBlockType","icon","Edit","save","edit","transforms","from","blocks","transform","attrs","to","classnames","rawScript","addQueryArgs","options","resizeToParent","cover","autoPlay","persistVolume","posterUrl","preloadContent","sbc","sbpc","sblc"],"sourceRoot":""}