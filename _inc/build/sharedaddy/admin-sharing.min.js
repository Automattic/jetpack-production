(()=>{var e;(e=jQuery)(document).ready((function(){function i(){e(".preview a.sharing-anchor").unbind("mouseenter mouseenter").hover((function(){if(!0!==e(this).data("hasappeared")){var i=e(".sharing-hidden .inner"),s=e(this).parents("li"),a=setTimeout((function(){e(i).css({left:e(s).position().left+"px",top:e(s).position().top+e(s).height()+3+"px"}).slideDown(200,(function(){e(s).data("hasappeared",!0).data("hasoriginal",!0).data("hasitem",!1),e(i).mouseleave(a).mouseenter(n),e(s).mouseleave(r).mouseenter(t),e(s).click(l)}));var a=function(){if(e(s).data("hasitem",!1),!1===e(s).data("hasoriginal")){var i=setTimeout(l,800);e(s).data("timer2",i)}},n=function(){e(s).data("hasitem",!0),clearTimeout(e(s).data("timer2"))},r=function(){if(e(s).data("hasoriginal",!1),!1===e(s).data("hasitem")){var i=setTimeout(l,800);e(s).data("timer2",i)}},t=function(){e(s).data("hasoriginal",!0),clearTimeout(e(s).data("timer2"))},l=function(){return i.slideUp(200),e(s).unbind("mouseleave",r).unbind("mouseenter",t),e(i).unbind("mouseleave",a).unbind("mouseenter",a),e(s).data("hasappeared",!1),e(s).unbind("click",l),!1}}),200);e(this).data("timer",a)}}),(function(){clearTimeout(e(this).data("timer")),e(this).data("timer",!1)}))}function s(){var s=e("#button_style").val(),a=e(".sharedaddy"),n="sd-social-official";if("official"===s)a.addClass(n);else a.removeClass(n);if(e("#live-preview ul.preview li").remove(),e("#save-enabled-shares input[name=visible]").val()||e("#save-enabled-shares input[name=hidden]").val())e("#live-preview ul.preview").append(e("#live-preview ul.archive .sharing-label").clone());if(e("ul.services-enabled li").each((function(){if(e(this).hasClass("service")){var i=e(this).attr("id");e("#live-preview ul.preview").append(e("#live-preview ul.archive li.preview-"+i).clone())}})),e("#save-enabled-shares input[name=hidden]").val())e("#live-preview ul.preview").append(e("#live-preview ul.archive .share-more").parent().clone()),e(".sharing-hidden ul li").remove(),e("ul.services-hidden li").each((function(){if(e(this).hasClass("service")){var i=e(this).attr("id");e(".sharing-hidden .inner ul").append(e("#live-preview ul.archive .preview-"+i).clone())}})),i();if(e("#live-preview div.sharedaddy").removeClass("sd-social-icon"),e("#live-preview li.advanced").removeClass("no-icon"),"icon"===s)e("#live-preview ul.preview div span, .sharing-hidden .inner ul div span").html("&nbsp;").parent().addClass("no-text"),e("#live-preview div.sharedaddy").addClass("sd-social-icon");else if("official"===s)e("#live-preview ul.preview .advanced, .sharing-hidden .inner ul .advanced").each((function(){if(!(e(this).hasClass("preview-press-this")||e(this).hasClass("preview-email")||e(this).hasClass("preview-mastodon")||e(this).hasClass("preview-nextdoor")||e(this).hasClass("preview-bluesky")||e(this).hasClass("preview-print")||e(this).hasClass("preview-reddit")||e(this).hasClass("preview-telegram")||e(this).hasClass("preview-threads")||e(this).hasClass("preview-jetpack-whatsapp")||e(this).hasClass("share-custom")||e(this).hasClass("share-deprecated")))e(this).find(".option a span").html("").parent().removeClass("sd-button").parent().attr("class","option option-smart-on")}));else if("text"===s)e("#live-preview li.advanced").addClass("no-icon")}function a(e){jQuery("."+e+"-extra-options").css({backgroundColor:"#ffffcc"}).fadeIn()}function n(){if(e("#enabled-services h3 img").show(),e("#enabled-services ul.services-enabled li.service").length>0)e("#drag-instructions").hide();else e("#drag-instructions").show();if(e("#enabled-services li.service").length>0)e("#live-preview .services h2").hide();else e("#live-preview .services h2").show();var i=[],n=[];e("ul.services-enabled li").each((function(){if(e(this).hasClass("service"))i[i.length]=e(this).attr("id"),a(e(this).attr("id"))})),e("ul.services-available li").each((function(){if(e(this).hasClass("service"))i=e(this).attr("id"),jQuery("."+i+"-extra-options").fadeOut("slow");var i})),e("ul.services-hidden li").each((function(){if(e(this).hasClass("service"))n[n.length]=e(this).attr("id"),a(e(this).attr("id"))})),e("#save-enabled-shares input[name=visible]").val(i.join(",")),e("#save-enabled-shares input[name=hidden]").val(n.join(",")),s(),e("#save-enabled-shares").ajaxSubmit((function(){e("#enabled-services h3 img").hide()}))}function r(e,i){var s,a=e.parent(),r=a.find("li"),t=r.index(e)+1,l=r.length-1;if(!a.hasClass("services-available")){if("left"===i){if(1===t)return;var d=e.prev();s=e.detach(),d.before(s),d.prev().focus()}if("right"===i){if(t===l)return;var o=e.next();s=e.detach(),o.after(s),o.next().focus()}n()}}function t(i){var s,a=i.parent();if(a.hasClass("services-available"))s="services-enabled";else if(a.hasClass("services-enabled"))s="services-hidden";else s="services-available";var r=i.detach();e("."+s).prepend(r).find("li:first-child").focus(),n()}window.sharing_option_changed=function(){var i=this;if(e(this).parents("li:first").css("backgroundImage",'url("'+sharing_loading_icon+'")'),e(this).parents("form").ajaxSubmit((function(a){if(a.indexOf("\x3c!---")>=0){var n=a.substring(0,a.indexOf("\x3c!---\x3e")),r=a.substring(a.indexOf("\x3c!---\x3e")+6);if(!0===e(i).is(":submit"))e(i).parents("li:first").replaceWith(n);e("#live-preview ul.archive li.preview-"+e(i).parents("form").find("input[name=service]").val()).replaceWith(r)}s(),e(i).parents("li:first").removeAttr("style")})),!0===e(i).is(":submit"))return!1;else return!0},e("#enabled-services .services ul").sortable({receive:function(){n()},stop:function(){n(),e("li.service").enableSelection()},over:function(){e(this).find("ul").addClass("dropping"),e("#enabled-services li.end-fix").remove(),e("#enabled-services ul").append('<li class="end-fix"></li>')},out:function(){e(this).find("ul").removeClass("dropping"),e("#enabled-services li.end-fix").remove(),e("#enabled-services ul").append('<li class="end-fix"></li>')},helper:function(e,i){return i.find(".advanced-form").hide(),i.clone()},start:function(){e(".advanced-form").hide(),e("li.service").disableSelection()},placeholder:"dropzone",opacity:.8,delay:150,forcePlaceholderSize:!0,items:"li",connectWith:"#available-services ul, #enabled-services .services ul",cancel:".advanced-form"}),e("#available-services ul").sortable({opacity:.8,delay:150,cursor:"move",connectWith:"#enabled-services .services ul",placeholder:"dropzone",forcePlaceholderSize:!0,start:function(){e(".advanced-form").hide()}}),e(".service").on("keydown",(function(i){switch(i.keyCode){case 13:case 32:t(e(this));break;case 37:r(e(this),"left");break;case 39:r(e(this),"right");break;default:return!0}i.preventDefault()})),e(".preview-hidden a").click((function(){return e(this).parent().find(".preview").toggle(),!1})),e("#new-service form").ajaxForm({beforeSubmit:function(){e("#new-service-form .error").hide(),e("#new-service-form img").show(),e("#new-service-form input[type=submit]").prop("disabled",!0)},success:function(i){if(e("#new-service-form img").hide(),""+i=="1")e("#new-service-form .inerror").removeClass("inerror").addClass("error"),e("#new-service-form .error").show(),e("#new-service-form input[type=submit]").prop("disabled",!1);else document.location.reload()}}),e("#button_style").change((function(){return s(),!0})).change(),e("input[name=sharing_label]").blur((function(){e("#live-preview h3.sd-title").text(e("<div/>").text(e(this).val()).html())})),e("#services-config a.remove").unbind("click").click((function(){var i=e(this).parent().next();return e(this).parents("li:first").css("backgroundImage",'url("'+sharing_loading_icon+'")'),i.ajaxSubmit((function(){i.parents("li:first").fadeOut((function(){e(this).remove(),s()}))})),!1})),i()}))})();