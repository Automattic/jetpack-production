/* Do not modify this file directly. It is compiled from other files. */
/* globals wp, lodash */
wp.apiFetch.use(function(e,t){var o=e.path,a=e.method,r=e.body,i=r?r.get("file"):null;if(!o||-1===o.indexOf("/wp/v2/media"))return t(e);if(!a||"post"!==a.toLowerCase())return t(e);if(!i||0!==i.type.indexOf("video/"))return t(e);wp.media.ajax("videopress-get-upload-token",{async:!1,data:{filename:i.name}}).done(function(t){var o=e.headers||{};o.Authorization='X_UPLOAD_TOKEN token="'+t.upload_token+'" blog_id="'+t.upload_blog_id+'"',e.headers=o,delete e.path,e.url=t.upload_action_url,e.credentials="omit",r.set("media[]",i),r.delete("file"),e.body=r});var n=t(e);return new Promise(function(e,t){n.then(function(t){var o=lodash.get(t,"media[0]"),a=lodash.get(o,"ID"),r=wp.apiFetch({path:"/wp/v2/media/"+a});e(r)}).catch(function(e){"errors"in e&&"object"==typeof e.errors&&e.errors.length>0&&(e=e.errors.shift()),t(e)})})});