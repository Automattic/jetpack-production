/* Do not modify this file directly. It is compiled from other files. */
/* global wpcom, jetpackCarouselStrings, DocumentTouch */
!function(){"use strict";var e=function(){return{noop:function(){},unique:function(e){var t=[];return e.forEach(function(e){void 0!==e&&-1===t.indexOf(e)&&t.push(e)}),t},texturize:function(e){return(e=(e=(e=(e+="").replace(/'/g,"&#8217;").replace(/&#039;/g,"&#8217;").replace(/[\u2019]/g,"&#8217;")).replace(/"/g,"&#8221;").replace(/&#034;/g,"&#8221;").replace(/&quot;/g,"&#8221;").replace(/[\u201D]/g,"&#8221;")).replace(/([\w]+)=&#[\d]+;(.+?)&#[\d]+;/g,'$1="$2"')).trim()},applyReplacements:function(e,t){if(e)return t?e.replace(/{(\d+)}/g,function(e,r){return void 0!==t[r]?t[r]:e}):e}}}(),t=function(){function t(e,t){return Element.prototype.matches?e.matches(t):Element.prototype.msMatchesSelector?e.msMatchesSelector(t):void 0}function r(e,t,r,n){if(!e)return n();e.style.removeProperty("display"),e.style.opacity=t,e.style.transition="opacity 0.2s",e.style.pointerEvents="none";var i=function(t){t.target===e&&"opacity"===t.propertyName&&(e.style.removeProperty("transition"),e.style.removeProperty("opacity"),e.style.removeProperty("pointer-events"),e.removeEventListener("transitionend",i),e.removeEventListener("transitioncancel",i),n())};requestAnimationFrame(function(){requestAnimationFrame(function(){e.addEventListener("transitionend",i),e.addEventListener("transitioncancel",i),e.style.opacity=r})})}return{closest:function(e,r){if(e.closest)return e.closest(r);var n=e;do{if(t(n,r))return n;n=n.parentElement||n.parentNode}while(null!==n&&1===n.nodeType);return null},matches:t,hide:function(e){e&&(e.style.display="none")},show:function(e){e&&(e.style.display="block")},fadeIn:function(t,n){r(t,"0","1",n=n||e.noop)},fadeOut:function(t,n){n=n||e.noop,r(t,"1","0",function(){t&&(t.style.display="none"),n()})},scrollToY:function(e,t){e&&("function"==typeof e.scrollTo&&"scrollBehavior"in document.documentElement.style?e.scrollTo({top:t,behavior:"smooth"}):e.scrollTop=t)},scrollToElement:function(e){e&&"function"==typeof e.scrollIntoView&&("scrollBehavior"in document.documentElement.style?e.scrollIntoView({behavior:"smooth"}):e.scrollIntoView())},getJSONAttribute:function(e,t){if(e&&e.hasAttribute(t))try{return JSON.parse(e.getAttribute(t))}catch(e){return}},convertToPlainText:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},emitEvent:function(e,t,r){var n;try{n=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r||null})}catch(e){(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,r||null)}e.dispatchEvent(n)}}}(),r=function(){return{addWipeHandler:function(e){e=e||{};var t,r,n,i,o={root:document.body,threshold:150,restraint:100,allowedTime:300,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){}};for(var a in e)o[a]=e[a];function l(){o.root.removeEventListener("touchmove",c),t=null,n=!1}function c(e){if(n){var a=e.touches[0].pageX,c=e.touches[0].pageY,s=t-a,u=r-c;(new Date).getTime()-i<=o.allowedTime&&(Math.abs(s)>=o.threshold&&Math.abs(u)<=o.restraint?(l(),s>0?o.wipeLeft(e):o.wipeRight(e)):Math.abs(u)>=o.threshold&&Math.abs(s)<=o.restraint&&(l(),u>0?o.wipeDown(e):o.wipeUp(e)))}}"ontouchstart"in document.documentElement&&o.root.addEventListener("touchstart",function(e){1===e.touches.length&&(i=(new Date).getTime(),t=e.touches[0].pageX,r=e.touches[0].pageY,n=!0,o.root.addEventListener("touchmove",c,!1))},!1)}}}();function n(){var n,i,o,a,l,c,s="",u=!1,d="div.gallery, div.tiled-gallery, ul.wp-block-gallery, ul.blocks-gallery-grid, figure.blocks-gallery-grid, div.wp-block-jetpack-tiled-gallery, a.single-image-gallery",m=".gallery-item, .tiled-gallery-item, .blocks-gallery-item,  .tiled-gallery__item, .wp-block-image",p={},h="undefined"!=typeof wpcom&&wpcom.carousel&&wpcom.carousel.stat?wpcom.carousel.stat:e.noop,g="undefined"!=typeof wpcom&&wpcom.carousel&&wpcom.carousel.pageview?wpcom.carousel.pageview:e.noop;function f(e){if(!u)switch(e.which){case 38:e.preventDefault(),p.container.scrollTop-=100;break;case 40:e.preventDefault(),p.container.scrollTop+=100;break;case 39:e.preventDefault(),L();break;case 37:case 8:e.preventDefault(),_();break;case 27:e.preventDefault(),M()}}function v(){u=!0}function y(){u=!1}function w(){if(o=110,window.innerWidth<=760){o=Math.round(window.innerWidth/760*110);var e="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;o<40&&e&&(o=0)}}function b(){clearTimeout(n),n=setTimeout(function(){w(),R(p.slides),O(),S()},200)}function S(){p.info.style.left=o+"px",p.info.style.right=o+"px"}function A(){p.overlay||(p.container=document.querySelector(".jp-carousel-wrap"),p.overlay=p.container.querySelector(".jp-carousel-overlay"),p.gallery=p.container.querySelector(".jp-carousel"),p.info=p.container.querySelector(".jp-carousel-info"),p.caption=p.container.querySelector(".jp-carousel-caption"),p.nextButton=p.container.querySelector(".jp-carousel-next-button"),p.prevButton=p.container.querySelector(".jp-carousel-previous-button"),p.commentField=p.container.querySelector("#jp-carousel-comment-form-comment-field"),p.emailField=p.container.querySelector("#jp-carousel-comment-form-email-field"),p.authorField=p.container.querySelector("#jp-carousel-comment-form-author-field"),p.urlField=p.container.querySelector("#jp-carousel-comment-form-url-field"),w(),S(),[p.commentField,p.emailField,p.authorField,p.urlField].forEach(function(e){e&&(e.addEventListener("focus",v),e.addEventListener("blur",y))}),p.container.addEventListener("click",function(e){var r,n,i=e.target,o=!!t.closest(i,".jp-carousel-close-hint"),a=!!window.matchMedia("(max-device-width: 760px)").matches;i===p.gallery?a?x(e):M():o?M():i.classList.contains("jp-carousel-image-download")?h("download_original_click"):i.classList.contains("jp-carousel-commentlink")?function(e){e.preventDefault(),e.stopPropagation(),v(),t.scrollToElement(p.info),t.show(p.container.querySelector("#jp-carousel-comment-form-submit-and-info-wrapper")),p.commentField.focus()}(e):i.classList.contains("jp-carousel-comment-login")?(r=p.currentSlide,n=r?r.attrs.attachmentId:"0",window.location.href=jetpackCarouselStrings.login_url+"%23jp-carousel-"+n):t.closest(i,"#jp-carousel-comment-form-container")?function(e){var r=e.target,n=t.getJSONAttribute(p.container,"data-carousel-extra")||{},i=p.currentSlide.attrs.attachmentId,o=document.querySelector("#jp-carousel-comment-form-submit-and-info-wrapper"),a=document.querySelector("#jp-carousel-comment-form-spinner"),l=document.querySelector("#jp-carousel-comment-form-button-submit");if(p.commentField&&p.commentField.getAttribute("id")===r.getAttribute("id"))v(),t.show(o);else if(t.matches(r,'input[type="submit"]')){e.preventDefault(),e.stopPropagation(),t.show(a);var c={action:"post_attachment_comment",nonce:jetpackCarouselStrings.nonce,blog_id:n.blog_id,id:i,comment:p.commentField.value};if(!c.comment.length)return void j(jetpackCarouselStrings.no_comment_text,!1);if(1!==Number(jetpackCarouselStrings.is_logged_in)&&(c.email=p.emailField.value,c.author=p.authorField.value,c.url=p.urlField.value,1===Number(jetpackCarouselStrings.require_name_email))){if(!c.email.length||!c.email.match("@"))return void j(jetpackCarouselStrings.no_comment_email,!1);if(!c.author.length)return void j(jetpackCarouselStrings.no_comment_author,!1)}var s=new XMLHttpRequest;s.open("POST",jetpackCarouselStrings.ajaxurl,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&this.status>=200&&this.status<300){var e;try{e=JSON.parse(this.response)}catch(e){return void j(jetpackCarouselStrings.comment_post_error,!1)}"approved"===e.comment_status?j(jetpackCarouselStrings.comment_approved,!0):"unapproved"===e.comment_status?j(jetpackCarouselStrings.comment_unapproved,!0):j(jetpackCarouselStrings.comment_post_error,!1),z(),X(i),l.value=jetpackCarouselStrings.post_comment,t.hide(a)}else j(jetpackCarouselStrings.comment_post_error,!1)};var u=[];for(var d in c)if(d){var m=encodeURIComponent(d)+"="+encodeURIComponent(c[d]);u.push(m.replace(/%20/g,"+"))}var h=u.join("&");s.send(h)}}(e):t.closest(i,".jp-carousel-info")||(a?x(e):L())}),window.addEventListener("keydown",f),p.container.addEventListener("jp_carousel.beforeOpen",function(){window.addEventListener("resize",b),b()}),p.container.addEventListener("jp_carousel.afterOpen",function(){y()}),p.container.addEventListener("jp_carousel.beforeClose",function(){v(),window.removeEventListener("resize",b),t.hide(p.prevButton),t.hide(p.nextButton),document.documentElement.style.removeProperty("height")}),p.container.addEventListener("jp_carousel.afterClose",function(){window.location.hash&&history.back&&history.back(),s="",p.isOpen=!1}),r.addWipeHandler({root:p.container,wipeLeft:function(e){e.preventDefault(),L()},wipeRight:function(e){e.preventDefault(),_()}}),p.nextButton.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),L()}),p.prevButton.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),_()}))}function x(e){void 0!==e.pageX&&(e.pageX<=70&&_(),window.innerWidth-e.pageX<=70&&L())}function j(e,r){var n=p.container.querySelector("#jp-carousel-comment-post-results"),i="jp-carousel-comment-post-"+(r?"success":"error");n.innerHTML='<span class="'+i+'">'+e+"</span>",t.hide(p.container.querySelector("#jp-carousel-comment-form-spinner")),t.show(n)}function E(){var e=document.querySelectorAll("a img[data-attachment-id]");Array.prototype.forEach.call(e,function(e){var t=e.parentElement;if(!t.parentElement.classList.contains("gallery-icon")&&t.hasAttribute("href")){var r=!1;t.getAttribute("href").split("?")[0]===e.getAttribute("data-orig-file").split("?")[0]&&1===Number(jetpackCarouselStrings.single_image_gallery_media_file)&&(r=!0),t.getAttribute("href")===e.getAttribute("data-permalink")&&(r=!0),r&&(t.classList.add("single-image-gallery"),t.setAttribute("data-carousel-extra",JSON.stringify({blog_id:Number(jetpackCarouselStrings.blog_id)})))}})}function k(r){(!r||r<0||r>p.slides.length)&&(r=0),p.currentSlide&&(p.lastSlide=p.currentSlide,p.currentSlide.el.classList.remove("selected")),p.currentSlide=p.slides[r];var n,i=p.currentSlide,o=i.attrs.attachmentId,a=T(p.currentSlide),l=q(p.currentSlide),c=T(a),u=q(l);p.slides.forEach(function(e){e.el.style.position="fixed"}),i.el.classList.add("selected"),i.el.style.position="relative",$(p.slides[r]),t.hide(p.caption),!l||l.index<i.index&&p.slides.length<=2?t.hide(p.nextButton):t.show(p.nextButton),!a||a.index>i.index&&p.slides.length<=2?t.hide(p.prevButton):t.show(p.prevButton);var d,m,h,f,v,y=e.unique([i,a,c,l,u]);if(function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.el.querySelector("img");n.addEventListener("load",function(){R([r])})}}(y),p.slides.forEach(function(e){-1===y.indexOf(e)&&t.hide(e.el)}),O(),t.emitEvent(p.container,"jp_carousel.selectSlide",i.el),function(e){var r,n="",i="",o="";r=p.container.querySelector(".jp-carousel-titleanddesc"),t.hide(r),n=N(e.title)||"",i=N(e.desc)||"",(n||i)&&(t.convertToPlainText(n)===t.convertToPlainText(i)&&(n=""),o=n?'<div class="jp-carousel-titleanddesc-title">'+n+"</div>":"",o+=i?'<div class="jp-carousel-titleanddesc-desc">'+i+"</div>":"",r.innerHTML=o,t.fadeIn(r))}({title:i.attrs.title,desc:i.attrs.desc}),function(e){if(!e||1!==Number(jetpackCarouselStrings.display_exif))return!1;var t=p.info.querySelector(".jp-carousel-image-meta ul.jp-carousel-image-exif"),r="";for(var n in e){var i=e[n],o=jetpackCarouselStrings.meta_data||[];if(0!==parseFloat(i)&&i.length&&-1!==o.indexOf(n)){switch(n){case"focal_length":i+="mm";break;case"shutter_speed":i=B(i);break;case"aperture":i="f/"+i}r+="<li><h5>"+jetpackCarouselStrings[n]+"</h5>"+i+"</li>"}}t.innerHTML=r,t.style.removeProperty("display")}(p.slides[r].attrs.imageMeta),function(t){if(!t)return!1;var r,n=[t.attrs.origWidth,t.attrs.origHeight],i=document.createElement("a");i.href=t.attrs.src.replace(/\?.+$/,""),r=null!==i.hostname.match(/^i[\d]{1}\.wp\.com$/i)?i.href:t.attrs.origFile.replace(/\?.+$/,"");var o=p.info.querySelector(".jp-carousel-image-download");o.innerHTML=e.applyReplacements(jetpackCarouselStrings.download_original,n),o.setAttribute("href",r),o.style.removeProperty("display")}(i),1===Number(jetpackCarouselStrings.display_comments)&&(d=p.slides[r].attrs.commentsOpened,m=p.container.querySelector(".jp-carousel-comment-form-container"),h=p.container.querySelector(".jp-carousel-commentlink"),f=p.container.querySelector(".jp-carousel-buttons"),v=1===Number(jetpackCarouselStrings.is_logged_in)?h:f,1===parseInt(d,10)?(t.fadeIn(v),t.fadeIn(m)):(t.fadeOut(v),t.fadeOut(m)),X(o),t.hide(p.container.querySelector("#jp-carousel-comment-post-results"))),i.attrs.caption){if(n=t.convertToPlainText(i.attrs.caption),t.convertToPlainText(i.attrs.title)===n){var w=p.container.querySelector(".jp-carousel-titleanddesc-title");t.fadeOut(w,function(){w.innerHTML=""})}if(t.convertToPlainText(i.attrs.desc)===n){var b=p.container.querySelector(".jp-carousel-titleanddesc-desc");t.fadeOut(b,function(){b.innerHTML=""})}p.caption.innerHTML=i.attrs.caption,t.fadeIn(p.caption)}else t.fadeOut(p.caption,function(){p.caption.innerHTML=""});jetpackCarouselStrings.stats&&((new Image).src=document.location.protocol+"//pixel.wp.com/g.gif?"+jetpackCarouselStrings.stats+"&post="+encodeURIComponent(o)+"&rand="+Math.random()),g(o),setTimeout(function(){l&&$(l),a&&$(l)}),window.location.hash=s="#jp-carousel-"+o}function L(){I(q)}function _(){I(T)}function I(e){if(p.slides.length<=1)return!1;var r=e(p.currentSlide).index;r>=0&&(t.scrollToY(p.container,0),z(),k(r),h(["previous","view_image"]))}function q(e){var t=e&&e.index===p.slides.length-1;return void 0===e||p.slides.length>2&&t?p.slides[0]:p.slides[e.index+1]}function T(e){var t=e&&0===e.index;return void 0===e||p.slides.length>2&&t?p.slides[p.slides.length-1]:p.slides[e.index-1]}function C(){window.scrollTo(window.scrollX||window.pageXOffset||0,c||0)}function M(){document.body.style.overflow=a,document.documentElement.style.overflow=l,z(),v(),t.emitEvent(p.container,"jp_carousel.beforeClose"),C(),t.fadeOut(p.container,function(){p.slides=[],p.currentSlide=void 0,p.gallery.innerHTML="",C(),t.emitEvent(p.container,"jp_carousel.afterClose")})}function H(e,t){e&&(e.style.transform="translate3d("+t+"px,0,0)")}function F(e){return parseInt(getComputedStyle(e.el).width,10)}function O(){var e,r,n=p.currentSlide,i=p.lastSlide,a=p.gallery.offsetWidth,l=F(n),c=T(n),s=q(n),u=T(c),d=q(s),m=Math.floor(.5*(a-l));H(n.el,m),t.show(n.el),e=P(p.currentSlide),r=p.container.querySelectorAll(".jp-carousel-photo-info"),Array.prototype.forEach.call(r,function(t){t.style.left=Math.floor(.5*(p.info.offsetWidth-e.width))+"px",t.style.width=Math.floor(e.width)+"px"});var h=n&&i&&i.index<n.index?1:-1;p.slides.length>1&&(1===h?(d!==c&&(H(d.el,a+F(s)),t.show(d.el)),u!==s&&(H(u.el,-F(u)-l),t.show(u.el))):d!==c&&(H(d.el,a+l),t.show(d.el)),H(c.el,Math.floor(-F(c)+.75*o)),t.show(c.el),H(s.el,Math.ceil(a-.75*o)),t.show(s.el))}function W(){return{width:window.innerWidth-2*o,height:Math.floor(window.innerHeight/100*80-60)}}function P(e){var t,r,n=W(),i=e.attrs.origWidth/e.attrs.origHeight,o=1,a=1;return e.attrs.origWidth>n.width&&(o=n.width/e.attrs.origWidth),e.attrs.origHeight>n.height&&(a=n.height/e.attrs.origHeight),o<a?(t=n.width,r=Math.floor(t/i)):a<o?(r=n.height,t=Math.floor(r*i)):(t=e.attrs.origWidth,r=e.attrs.origHeight),{width:t,height:r}}function R(e){e&&e.forEach(function(e){var t=P(e),r=W();for(var n in t.left=0,t.top=Math.floor(.5*(r.height-t.height))+40,t)e.el.style.setProperty(n,t[n]+"px")})}function D(e,t,r){var n=r?e.replace(/.*=([\d]+%2C[\d]+).*$/,"$1"):e.replace(/.*-([\d]+x[\d]+)\..+$/,"$1"),i=n!==e?r?n.split("%2C"):n.split("x"):[t,0];return"9999"===i[0]&&(i[0]="0"),"9999"===i[1]&&(i[1]="0"),i}function B(e){return e>=1?Math.round(10*e)/10+"s":"1/"+Math.round(1/e)+"s"}function N(e){return!e.match(" ")&&e.match("_")?"":e}function X(e,r){var n=void 0===r;if(clearInterval(i),e){(!r||r<1)&&(r=0);var o=p.container.querySelector(".jp-carousel-comments"),a=p.container.querySelector("#jp-carousel-comments-loading");t.show(a),n&&(t.hide(o),o.innerHTML="");var l=new XMLHttpRequest,c=jetpackCarouselStrings.ajaxurl+"?action=get_attachment_comments&nonce="+jetpackCarouselStrings.nonce+"&id="+e+"&offset="+r;l.open("GET",c),l.setRequestHeader("X-Requested-With","XMLHttpRequest");var s=function(){t.fadeIn(o),t.fadeOut(a)};l.onload=function(){if(p.currentSlide&&p.currentSlide.attrs.attachmentId===e){var c,u=l.status>=200&&l.status<300;try{c=JSON.parse(l.responseText)}catch(e){}if(!u||!c||!Array.isArray(c))return s();n&&(o.innerHTML="");for(var d=0;d<c.length;d++){var m=c[d],h=document.createElement("div");h.classList.add("jp-carousel-comment"),h.setAttribute("id","jp-carousel-comment-"+m.id),h.innerHTML='<div class="comment-gravatar">'+m.gravatar_markup+'</div><div class="comment-author">'+m.author_markup+'</div><div class="comment-date">'+m.date_gmt+'</div><div class="comment-content">'+m.content+"</div>",o.appendChild(h),clearInterval(i),i=setInterval(function(){p.container.scrollTop+150>window.innerHeight&&(X(e,r+10),clearInterval(i))},300)}t.show(o),t.hide(a)}},l.onerror=s,l.send()}}function z(){p.commentField&&(p.commentField.value="")}function $(e){var t=e.el,r=e.attrs,n=t.querySelector("img");if(!n.hasAttribute("data-loaded")){var i=function(){n.removeEventListener("load",i),t.style.backgroundImage=""};n.addEventListener("load",i);var o=!!r.previewImage,a=r.thumbSize;!o||a&&t.offsetWidth>a.width?n.src=r.src:n.src=r.previewImage,n.setAttribute("itemprop","image"),n.setAttribute("data-loaded",1)}}function J(r,n){p.slides=[],r.length<2?(t.hide(p.nextButton),t.hide(p.prevButton)):(t.show(p.nextButton),t.show(p.prevButton));var i=W();0!==n&&((new Image).src=r[n].getAttribute("data-gallery-src"));var o=!!t.closest(r[0],".tiled-gallery.type-rectangular");Array.prototype.forEach.call(r,function(r,a){var l=t.closest(r,".gallery-item"),c=l&&l.querySelector(".gallery-caption"),s=t.closest(r,"a"),u=r.getAttribute("data-orig-file")||r.getAttribute("src-orig"),d={attachmentId:r.getAttribute("data-attachment-id")||r.getAttribute("data-id")||"0",commentsOpened:r.getAttribute("data-comments-opened")||"0",imageMeta:t.getJSONAttribute(r,"data-image-meta")||{},title:r.getAttribute("data-image-title")||"",desc:r.getAttribute("data-image-description")||"",mediumFile:r.getAttribute("data-medium-file")||"",largeFile:r.getAttribute("data-large-file")||"",origFile:u||"",thumbSize:{width:r.naturalWidth,height:r.naturalHeight},caption:c&&c.innerHTML||"",permalink:s&&s.getAttribute("href"),src:u||r.getAttribute("src")||""},m=t.closest(r,".tiled-gallery-item"),h=m&&m.querySelector(".tiled-gallery-caption"),g=h&&h.innerHTML;g&&(d.caption=g);var f=function(e){var t=e.getAttribute("data-orig-size")||"";if(t){var r=t.split(",");return{width:parseInt(r[0],10),height:parseInt(r[1],10)}}return{width:e.getAttribute("data-original-width")||e.getAttribute("width")||void 0,height:e.getAttribute("data-original-height")||e.getAttribute("height")||void 0}}(r);if(d.origWidth=f.width,d.origHeight=f.height,"undefined"!=typeof wpcom&&wpcom.carousel&&wpcom.carousel.generateImgSrc?d.src=wpcom.carousel.generateImgSrc(r,i):d.src=function(e){if("object"!=typeof e&&(e={}),void 0===e.origFile)return"";if(void 0===e.origWidth||void 0===e.maxWidth)return e.origFile;if(void 0===e.mediumFile||void 0===e.largeFile)return e.origFile;var t=document.createElement("a");t.href=e.largeFile;var r=/^i[0-2]\.wp\.com$/i.test(t.hostname),n=D(e.mediumFile,e.origWidth,r),i=D(e.largeFile,e.origWidth,r),o=parseInt(i[0],10),a=parseInt(i[1],10),l=parseInt(n[0],10),c=parseInt(n[1],10);if(e.origMaxWidth=e.maxWidth,e.origMaxHeight=e.maxHeight,void 0!==window.devicePixelRatio&&window.devicePixelRatio>1&&(e.maxWidth=e.maxWidth*window.devicePixelRatio,e.maxHeight=e.maxHeight*window.devicePixelRatio),o>=e.maxWidth||a>=e.maxHeight)return e.largeFile;if(l>=e.maxWidth||c>=e.maxHeight)return e.mediumFile;if(r){var s=e.largeFile.lastIndexOf("?"),u=e.largeFile;return-1!==s&&(u=e.largeFile.substring(0,s),(e.origWidth>e.maxWidth||e.origHeight>e.maxHeight)&&(u+="?fit="+e.origMaxWidth+"%2C"+e.origMaxHeight)),u}return e.origFile}({origFile:d.src,origWidth:d.origWidth,origHeight:d.origHeight,maxWidth:i.width,maxHeight:i.height,mediumFile:d.mediumFile,largeFile:d.largeFile}),r.setAttribute("data-gallery-src",d.src),"0"!==d.attachmentId){d.title=e.texturize(d.title),d.desc=e.texturize(d.desc),d.caption=e.texturize(d.caption);var v=new Image;v.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",v.style.width="100%",v.style.height="100%";var y=document.createElement("div");y.classList.add("jp-carousel-slide"),y.setAttribute("itemprop","associatedMedia"),y.setAttribute("itemscope",""),y.setAttribute("itemtype","https://schema.org/ImageObject"),t.hide(y),y.style.left=a<n?-1e3:p.gallery.offsetWidth,p.gallery.appendChild(y),y.appendChild(v),y.setAttribute("data-attachment-id",d.attachmentId),y.setAttribute("data-permalink",d.permalink),y.setAttribute("data-orig-file",d.origFile),o&&(d.previewImage=d.src,y.style.backgroundImage='url("'+d.src+'")',y.style.backgroundSize="100% 100%",y.style.backgroundPosition="center center");var w={el:y,attrs:d,index:a};p.slides.push(w),R([w])}})}function U(e,r){var n={imgSelector:".gallery-item [data-attachment-id], .tiled-gallery-item [data-attachment-id], img[data-attachment-id], img[data-id]",startIndex:0},i=t.getJSONAttribute(e,"data-carousel-extra");if(i&&(A(),!p.isOpen)){for(var o in p.isOpen=!0,a=getComputedStyle(document.body).overflow,document.body.style.overflow="hidden",l=getComputedStyle(document.documentElement).overflow,document.documentElement.style.overflow="hidden",c=window.scrollY||window.pageYOffset||0,p.container.setAttribute("data-carousel-extra",JSON.stringify(i)),h(["open","view_image"]),r||{})n[o]=r[o];-1===n.startIndex&&(n.startIndex=0),t.emitEvent(p.container,"jp_carousel.beforeOpen"),t.fadeIn(p.container,function(){t.emitEvent(p.container,"jp_carousel.afterOpen")}),p.gallery.innerHTML="",J(e.querySelectorAll(n.imgSelector),n.startIndex),k(n.startIndex)}}document.body.addEventListener("click",function(e){var r,n=e.target,i=t.closest(n,d);if(i){if(!(r=i)||!r.getAttribute("data-carousel-extra"))return;var o=n.parentElement,a=o.parentElement;if(a&&a.classList.contains("wp-block-image")){var l=o.getAttribute("href");if(l.split("?")[0]!==n.getAttribute("data-orig-file").split("?")[0]&&l!==n.getAttribute("data-permalink"))return}if(o.classList.contains("gallery-caption"))return;if(t.matches(o,"figcaption"))return;document.documentElement.style.height="auto",e.preventDefault(),e.stopPropagation();var c=t.closest(n,m),s=Array.prototype.indexOf.call(i.querySelectorAll(m),c);U(i,{startIndex:s})}}),1===Number(jetpackCarouselStrings.single_image_gallery)&&(E(),document.body.addEventListener("is.post-load",function(){E()})),window.addEventListener("hashchange",function(){var e=/jp-carousel-(\d+)/;if(window.location.hash&&e.test(window.location.hash)){if(window.location.hash!==s||!p.isOpen)if(window.location.hash&&p.gallery&&!p.isOpen&&history.back)history.back();else{s=window.location.hash;for(var t,r,n=window.location.hash.match(e),i=parseInt(n[1],10),o=document.querySelectorAll(d),a=0;a<o.length;a++){for(var l,c=o[a],u=c.querySelectorAll("img"),m=0;m<u.length;m++)if(parseInt(u[m].getAttribute("data-attachment-id"),10)===i||parseInt(u[m].getAttribute("data-id"),10)===i){l=m;break}if(void 0!==l){t=c,r=l,p.isOpen?k(r):U(t,{startIndex:r});break}}}}else p.isOpen&&M()}),window.location.hash&&t.emitEvent(window,"hashchange")}"loading"!==document.readyState?n():document.addEventListener("DOMContentLoaded",n)}();