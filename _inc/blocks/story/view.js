!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,n),l.l=!0,l.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(r,l,function(t){return e[t]}.bind(null,l));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=492)}({0:function(e,t){e.exports=window.wp.element},1:function(e,t){e.exports=window.wp.i18n},10:function(e,t){e.exports=window.wp.compose},104:function(e,t,n){"use strict";function r(e,t){var n;if(Array.isArray(t))for(n=0;n<t.length;n++)r(e,t[n]);else for(n in t)e[n]=(e[n]||[]).concat(t[n])}e.exports=function(e){var t,n={};return r(n,e),(t=function(e){return function(t){return function(r){var l,c,s=n[r.type],a=t(r);if(s)for(l=0;l<s.length;l++)(c=s[l](r,e))&&e.dispatch(c);return a}}}).effects=n,t}},11:function(e,t){e.exports=window.React},12:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},16:function(e,t){e.exports=window.wp.keycodes},17:function(e,t,n){"use strict";var r=n(0),l=n(2);t.a=(e,t=24,n=24,c="0 0 24 24")=>Object(r.createElement)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",width:t,height:n,viewBox:c},Object(r.createElement)(l.Path,{fill:"none",d:"M0 0h24v24H0V0z"}),e)},175:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.size,n=void 0===t?24:t,l=e.onClick,c=(e.icon,e.className),a=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["size","onClick","icon","className"]),i=["gridicon","gridicons-fullscreen",c,!1,!1,!1].filter(Boolean).join(" ");return s.default.createElement("svg",r({className:i,height:n,width:n,onClick:l},a,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}),s.default.createElement("g",null,s.default.createElement("path",{d:"M21 3v6h-2V6.41l-3.29 3.3-1.42-1.42L17.59 5H15V3zM3 3v6h2V6.41l3.29 3.3 1.42-1.42L6.41 5H9V3zm18 18v-6h-2v2.59l-3.29-3.29-1.41 1.41L17.59 19H15v2zM9 21v-2H6.41l3.29-3.29-1.41-1.42L5 17.59V15H3v6z"})))};var l,c=n(11),s=(l=c)&&l.__esModule?l:{default:l};e.exports=t.default},186:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ve}));var r={};n.r(r),n.d(r,"setMuted",(function(){return i})),n.d(r,"setPlaying",(function(){return o})),n.d(r,"showSlide",(function(){return u})),n.d(r,"slideReady",(function(){return d})),n.d(r,"setCurrentSlideProgress",(function(){return p})),n.d(r,"resetCurrentSlideProgress",(function(){return m})),n.d(r,"setCurrentSlideEnded",(function(){return b})),n.d(r,"setFullscreen",(function(){return f})),n.d(r,"setEnded",(function(){return y})),n.d(r,"init",(function(){return g})),n.d(r,"setBuffering",(function(){return E}));var l={};n.r(l),n.d(l,"isPlayerReady",(function(){return O})),n.d(l,"getCurrentSlideIndex",(function(){return j})),n.d(l,"getCurrentSlideProgress",(function(){return h})),n.d(l,"getCurrentSlideProgressPercentage",(function(){return S})),n.d(l,"isPlaying",(function(){return w})),n.d(l,"isMuted",(function(){return v})),n.d(l,"isBuffering",(function(){return k})),n.d(l,"getCurrentMediaElement",(function(){return x})),n.d(l,"getCurrentMediaDuration",(function(){return N})),n.d(l,"hasCurrentSlideEnded",(function(){return _})),n.d(l,"isCurrentSlideReady",(function(){return C})),n.d(l,"getPreviousSlideMediaElement",(function(){return P})),n.d(l,"isFullscreen",(function(){return R})),n.d(l,"hasEnded",(function(){return I})),n.d(l,"getSettings",(function(){return T})),n.d(l,"getSlideCount",(function(){return L}));var c=n(0),s=n(7),a=n(16);n(351);function i(e,t){return{type:"SET_MUTED",value:t,playerId:e}}function o(e,t){return{type:"SET_PLAYING",value:t,playerId:e}}function u(e,t){return{type:"SHOW_SLIDE",index:t,playerId:e}}function d(e,t,n){return{type:"SLIDE_READY",mediaElement:t,duration:n,playerId:e}}function p(e,t){return{type:"SET_CURRENT_SLIDE_PROGRESS",value:t,playerId:e}}function m(e){return{type:"RESET_CURRENT_SLIDE_PROGRESS",playerId:e}}function b(e){return{type:"SET_CURRENT_SLIDE_ENDED",playerId:e}}function f(e,t){return{type:"SET_FULLSCREEN",playerId:e,fullscreen:t}}function y(e){return{type:"ENDED",playerId:e}}function g(e,t={}){return{type:"INIT",playerId:e,settings:t}}function E(e,t){return{type:"SET_BUFFERING",value:t,playerId:e}}function O(e,t){return!!e[t]}function j(e,t){return e[t].currentSlide.index}function h(e,t){return e[t].currentSlide.progress}function S(e,t){const n=e[t].currentSlide.progress.currentTime,r=e[t].currentSlide.progress.duration,l=Math.round(100*n/r);return l>=100?100:l}function w(e,t){return e[t].playing}function v(e,t){return e[t].muted}function k(e,t){return e[t].buffering}function x(e,t){return e[t].currentSlide.mediaElement}function N(e,t){return e[t].currentSlide.duration}function _(e,t){return e[t].currentSlide.ended}function C(e,t){return e[t].currentSlide.ready}function P(e,t){var n;return null===(n=e[t].previousSlide)||void 0===n?void 0:n.mediaElement}function R(e,t){return e[t].fullscreen}function I(e,t){return e[t].ended}function T(e,t){return e[t].settings}function L(e,t){return e[t].settings.slideCount}var M=n(104),z=n.n(M),F=n(3);const D=e=>e&&e.src&&"video"===e.tagName.toLowerCase();function A(e,t){const{getState:n}=t,r=e.playerId,l=v(n(),r),c=w(n(),r),s=x(n(),r),a=P(n(),r),i=T(n(),r);D(a)&&(a.currentTime=0,a.onwaiting=null,a.onplaying=null,a.pause()),D(s)&&(l!==s.muted&&(s.muted=l,l||(s.volume=i.volume)),c?s.play():s.pause())}function U(e,t){const{getState:n,dispatch:r}=t,l=e.playerId,c=C(n(),l),s=w(n(),l),a=h(n(),l);if(clearTimeout(a.timeout),!s||!c)return void(a.lastUpdate&&r(p(l,{...a,lastUpdate:null})));const i=x(n(),l),o=N(n(),l),u=a.lastUpdate?Date.now()-a.lastUpdate:100,d=D(i)?i.currentTime:a.currentTime+u/1e3;if(d>=o){r(b(l));const e=L(n(),l);j(n(),l)===e-1&&r(y(l))}else r(p(l,{timeout:setTimeout((()=>U(e,t)),100),lastUpdate:Date.now(),duration:o,currentTime:d}))}var B={SET_PLAYING:[U,A],SLIDE_READY:[function(e,t){const{getState:n,dispatch:r}=t,l=e.playerId,c=x(n(),l);if(!D(c))return;const s=h(n(),l);0===c.currentTime&&s.currentTime>0&&(c.currentTime=s.currentTime),c.onwaiting=()=>r(E(l,!0)),c.onplaying=()=>r(E(l,!1))},U,A],SET_MUTED:A,SHOW_SLIDE:A};const H={currentTime:0,duration:null,timeout:null,lastUpdate:null},q={progress:H,index:0,mediaElement:null,duration:null,ended:!1,ready:!1},G={slideCount:0,currentSlide:q,previousSlide:null,muted:!1,playing:!1,ended:!1,buffering:!1,fullscreen:!1,settings:{imageTime:5,startMuted:!1,playInFullscreen:!0,playOnNextSlide:!0,playOnLoad:!1,exitFullscreenOnEnd:!0,loadInFullscreen:!1,blurredBackground:!0,showSlideCount:!1,showProgressBar:!0,shadowDOM:{enabled:!0,mode:"open",globalStyleElements:'#jetpack-block-story-css, link[href*="jetpack/_inc/blocks/story/view.css"]'},defaultAspectRatio:.5625,cropUpTo:.2,volume:.8,maxBullets:7,maxBulletsFullscreen:14}};function V(e=G,t){switch(t.type){case"SHOW_SLIDE":{const n=e.currentSlide===t.index+1;return{...e,currentSlide:{...q,index:t.index},previousSlide:e.currentSlide,playing:n?e.settings.playOnNextSlide:e.playing}}case"SLIDE_READY":return{...e,buffering:!1,currentSlide:{...e.currentSlide,mediaElement:t.mediaElement,duration:t.duration,ready:!0},previousSlide:null};case"SET_CURRENT_SLIDE_PROGRESS":return{...e,currentSlide:{...e.currentSlide,progress:t.value}};case"SET_CURRENT_SLIDE_ENDED":return{...e,currentSlide:{...e.currentSlide,ended:!0}};case"RESET_CURRENT_SLIDE_PROGRESS":return{...e,currentSlide:{...e.currentSlide,progress:{...H}}};case"SET_MUTED":return{...e,muted:t.value};case"SET_PLAYING":{const n=t.value&&e.ended;return{...e,playing:t.value,buffering:!!t.value&&e.buffering,fullscreen:!e.playing&&t.value?e.settings.playInFullscreen:e.fullscreen,ended:!n&&e.ended,currentSlide:n?{...q,index:0}:e.currentSlide,previousSlide:n?null:e.previousSlide}}case"SET_BUFFERING":return{...e,buffering:t.value};case"SET_FULLSCREEN":return{...e,fullscreen:t.fullscreen,playing:!(e.fullscreen&&!t.fullscreen&&e.settings.playInFullscreen)&&e.playing};case"INIT":{const n=Object(F.merge)({},e.settings,t.settings);return{...e,settings:n,playing:n.playOnLoad,fullscreen:n.loadInFullscreen}}case"ENDED":return{...e,currentSlide:{...q,index:e.settings.slideCount-1,progress:{...H,currentTime:100,duration:100}},ended:!0,playing:!1,fullscreen:!e.settings.exitFullscreenOnEnd}}return e}const $=Object(s.registerStore)("jetpack/story/player",{actions:r,reducer:function(e={},t){return t.playerId?{...e,[t.playerId]:V(e[t.playerId],t)}:e},selectors:l});!function(e){const t=[z()(B)];let n=()=>{throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},r=[];const l={getState:e.getState,dispatch:(...e)=>n(...e)};r=t.map((e=>e(l))),n=Object(F.flowRight)(...r)(e.dispatch),e.dispatch=n}($);var W=n(12),K=n.n(W),Y=n(6),J=n.n(Y),Q=n(20),X=n(10),Z=n(1);var ee=n(2);function te({isEllipsis:e,disabled:t,index:n,isSelected:r,progress:l,onClick:s}){const a=t||e;let i=null;return e||(i=r?Object(Z.sprintf)(Object(Z.__)("Slide %d, currently selected","jetpack"),n+1):Object(Z.sprintf)(Object(Z.__)("Go to slide %d","jetpack"),n+1)),Object(c.createElement)(ee.Button,{role:a?"presentation":"tab",key:n,className:J()("wp-story-pagination-bullet",{"wp-story-pagination-ellipsis":e}),"aria-label":i,"aria-disabled":a||r,onClick:a||r?void 0:s,disabled:a},Object(c.createElement)("div",{className:"wp-story-pagination-bullet-bar"},Object(c.createElement)("div",{className:"wp-story-pagination-bullet-bar-progress",style:{width:`${l}%`}})))}n(352);const ne=({className:e,size:t,label:n,isPressed:r,...l})=>Object(c.createElement)("button",K()({type:"button","aria-label":n,"aria-pressed":r,className:J()("jetpack-mdc-icon-button","circle-icon","outlined","bordered",e),style:{width:`${t}px`,height:`${t}px`}},l)),re=({className:e,size:t=24,label:n,isPressed:r,...l})=>Object(c.createElement)("button",K()({type:"button","aria-label":n,"aria-pressed":r,className:J()("jetpack-mdc-icon-button",e),style:{width:`${t}px`,height:`${t}px`}},l));var le=n(17);const ce=({children:e,size:t})=>Object(le.a)(e,t,t),se=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M8 5v14l11-7z"})),ae=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})),ie=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),oe=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})),ue=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})),de=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),pe=({size:e})=>Object(c.createElement)(ce,{size:e},Object(c.createElement)(ee.Path,{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}));function me({playing:e,muted:t,onPlayPressed:n,onMutePressed:r,showMute:l}){return Object(c.createElement)("div",{className:"wp-story-controls"},Object(c.createElement)(re,{isPressed:e,label:e?Object(Z.__)("pause","jetpack"):Object(Z.__)("play","jetpack"),onClick:n},e?Object(c.createElement)(ae,null):Object(c.createElement)(se,null)),l&&Object(c.createElement)(re,{isPressed:t,label:t?Object(Z.__)("unmute","jetpack"):Object(Z.__)("mute","jetpack"),onClick:r},t?Object(c.createElement)(ue,null):Object(c.createElement)(oe,null)))}function be({fullscreen:e,onExitFullscreen:t,siteIconUrl:n,storyTitle:r}){return e?Object(c.createElement)("div",{className:"wp-story-meta"},Object(c.createElement)("div",{className:"wp-story-icon"},Object(c.createElement)("img",{alt:Object(Z.__)("Site icon","jetpack"),src:n,width:"40",height:"40"})),Object(c.createElement)("div",null,Object(c.createElement)("div",{className:"wp-story-title"},r)),Object(c.createElement)(re,{className:"wp-story-exit-fullscreen",label:Object(Z.__)("Exit Fullscreen","jetpack"),onClick:t},Object(c.createElement)(ie,null))):null}var fe=n(175),ye=n.n(fe);function ge({ended:e,hasPrevious:t,onNextSlide:n,onPreviousSlide:r,icon:l,slideCount:s,showSlideCount:a}){const i=Object(c.useCallback)((t=>{e||(t.stopPropagation(),r())}),[r,e]),o=Object(c.useCallback)((t=>{e||(t.stopPropagation(),n())}),[n,e]);return Object(c.createElement)("div",{className:"wp-story-overlay"},a&&Object(c.createElement)("div",{className:"wp-story-embed-icon"},l,Object(c.createElement)("span",null,s)),!a&&Object(c.createElement)("div",{className:"wp-story-embed-icon-expand"},Object(c.createElement)(ye.a,{role:"img"})),t&&Object(c.createElement)("div",{className:"wp-story-prev-slide",onClick:i},Object(c.createElement)(ne,{size:44,label:Object(Z.__)("Previous Slide","jetpack"),className:"outlined-w"},Object(Z.isRTL)()?Object(c.createElement)(pe,{size:24}):Object(c.createElement)(de,{size:24}))),Object(c.createElement)("div",{className:"wp-story-next-slide",onClick:o},Object(c.createElement)(ne,{size:44,label:Object(Z.__)("Next Slide","jetpack"),className:"outlined-w"},Object(Z.isRTL)()?Object(c.createElement)(de,{size:24}):Object(c.createElement)(pe,{size:24}))))}function Ee({currentMedia:e}){const t=e&&"image"===e.type?e.url:null;return Object(c.createElement)("div",{className:"wp-story-background"},Object(c.createElement)("div",{className:"wp-story-background-image",style:{backgroundImage:t?`url("${t}")`:"none"}}),Object(c.createElement)("div",{className:"wp-story-background-blur"}),Object(c.createElement)(ee.SVG,{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"0",height:"0"},Object(c.createElement)("filter",{id:"gaussian-blur-18"},Object(c.createElement)("feGaussianBlur",{stdDeviation:"18"}))))}var Oe=()=>Object(c.createElement)("div",{className:"wp-story-loading-spinner"},Object(c.createElement)("div",{className:"wp-story-loading-spinner__outer"},Object(c.createElement)("div",{className:"wp-story-loading-spinner__inner"})));const je=({title:e,alt:t,className:n,id:r,mediaRef:l,mime:s,sizes:a,srcset:i,url:o})=>Object(c.createElement)("img",{ref:l,"data-id":r,"data-mime":s,title:e,alt:t,src:o,className:J()("wp-story-image",`wp-image-${r}`,n),srcSet:i,sizes:a}),he=({title:e,className:t,id:n,mediaRef:r,mime:l,url:s,poster:a})=>Object(c.createElement)("video",{className:J()("wp-story-video","intrinsic-ignore",`wp-video-${n}`,t),ref:r,"data-id":n,title:e,type:l,src:s,poster:a,tabIndex:-1,preload:"auto",playsInline:!0}),Se=({targetAspectRatio:e,cropUpTo:t,type:n,width:r,height:l,...s})=>{let a=null;if(r&&l){const n=r/l;if(n>=e){n>e/(1-t)||(a="wp-story-crop-wide")}else{n<e*(1-t)||(a="wp-story-crop-narrow")}}const i="video"===n||(s.mime||"").startsWith("video/");return Object(c.createElement)("figure",null,i?Object(c.createElement)(he,K()({},s,{className:a})):Object(c.createElement)(je,K()({},s,{className:a})))};var we=({playerId:e,media:t,index:n,playing:r,uploading:l,settings:a,targetAspectRatio:i})=>{const{currentSlideIndex:o,buffering:u}=Object(s.useSelect)((t=>({currentSlideIndex:t("jetpack/story/player").getCurrentSlideIndex(e),buffering:t("jetpack/story/player").isBuffering(e)})),[]),{slideReady:d}=Object(s.useDispatch)("jetpack/story/player"),p=n===o,m=Object(c.useRef)(null),[b,f]=Object(c.useState)(!1),[y,g]=Object(c.useState)(!0);return Object(c.useEffect)((()=>{if(p&&!y){const t=m.current&&m.current.src&&"video"===m.current.tagName.toLowerCase()?m.current:null;d(e,m.current,t?t.duration:a.imageTime)}}),[p,y]),Object(c.useEffect)((()=>{n<=o+(r?1:0)&&f(!0)}),[r,o]),Object(c.useLayoutEffect)((()=>{m.current&&async function(e){const t=e.tagName.toLowerCase();if("img"===t){if(e.complete)return;await new Promise((t=>{e.addEventListener("load",t,{once:!0})}))}else if("video"===t||"audio"===t){if(e.HAVE_ENOUGH_DATA===e.readyState)return;await new Promise((t=>{e.addEventListener("canplaythrough",t,{once:!0}),e.addEventListener("load",t,{once:!0}),e.HAVE_NOTHING===e.readyState&&e.networkState!==e.NETWORK_LOADING&&e.load()}))}}(m.current).then((()=>{g(!1)}))}),[b,l]),Object(c.createElement)(c.Fragment,null,p&&(y||l||u)&&Object(c.createElement)("div",{className:J()("wp-story-slide","is-loading",{transparent:r&&u,"semi-transparent":l||!r&&u})},Object(c.createElement)(Oe,null)),Object(c.createElement)("div",{role:"figure",className:"wp-story-slide",style:{display:p&&!y?"block":"none"},tabIndex:p?0:-1},b&&Object(c.createElement)(Se,K()({},t,{targetAspectRatio:i,cropUpTo:a.cropUpTo,index:n,mediaRef:m}))))},ve=n(83);const ke=({key:e,playerId:t,index:n,disabled:r,isSelected:l,onClick:a})=>{const i=Object(s.useSelect)((e=>e("jetpack/story/player").getCurrentSlideProgressPercentage(t)),[]);return Object(c.createElement)(te,{key:e,index:n,progress:i,disabled:r,isSelected:l,onClick:a})};var xe=({playerId:e,slides:t,disabled:n,onSlideSeek:r,maxBullets:l})=>{const{currentSlideIndex:a}=Object(s.useSelect)((t=>({currentSlideIndex:t("jetpack/story/player").getCurrentSlideIndex(e)})),[]),i=Math.min(t.length,l),o=Math.floor(i/2);let u,d=0,p=t.length-1;return t.length<=l||a<o?(u=a,p=i-1):a>=t.length-o?(u=a-t.length+i,d=t.length-i):(u=o,d=a-o,p=a+o),Object(c.createElement)("div",{className:"wp-story-pagination wp-story-pagination-bullets",role:"tablist"},d>0&&Object(c.createElement)(te,{key:"bullet-0",index:d-1,progress:100,isEllipsis:!0}),Object(F.range)(1,i+1).map(((t,l)=>{const s=l+d;let i=null;if(s<a)i=100;else{if(!(s>a))return Object(c.createElement)(ke,{playerId:e,key:`bullet-${l}`,index:s,disabled:n,isSelected:u===l,onClick:()=>r(s)});i=0}return Object(c.createElement)(te,{key:`bullet-${l}`,index:s,progress:i,disabled:n,isSelected:u===l,onClick:()=>r(s)})})),p<t.length-1&&Object(c.createElement)(te,{key:`bullet-${i+1}`,index:p+1,progress:0,isEllipsis:!0}))};var Ne=e=>{const t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(e),l=Object(c.useCallback)((e=>{e.touches&&1===e.touches.length&&e.preventDefault()}),[]);return Object(c.useEffect)((()=>{r.current=e}),[e]),{onTouchStart:Object(c.useCallback)((e=>{e.target&&(e.target.addEventListener("touchend",l,{passive:!1}),n.current=e.target),t.current=setTimeout((()=>{r.current&&r.current(!0),t.current=null}),200)}),[]),onTouchEnd:Object(c.useCallback)((e=>{t.current?clearTimeout(t.current):(r.current&&r.current(!1),e.stopPropagation()),n.current&&n.current.removeEventListener("touchend",l)}),[])}};function _e({id:e,slides:t,metadata:n,disabled:r}){const{setFullscreen:l,setEnded:a,setPlaying:i,setMuted:o,showSlide:u}=Object(s.useDispatch)("jetpack/story/player"),{playing:d,muted:p,currentSlideIndex:m,currentSlideEnded:b,ended:f,fullscreen:y,settings:g}=Object(s.useSelect)((t=>{const{getCurrentSlideIndex:n,getSettings:r,hasCurrentSlideEnded:l,hasEnded:c,isFullscreen:s,isMuted:a,isPlaying:i}=t("jetpack/story/player");return{playing:i(e),muted:a(e),currentSlideIndex:n(e),currentSlideEnded:l(e),ended:c(e),fullscreen:s(e),settings:r(e)}}),[e]),E=Object(c.useRef)(),[O,j]=Object(c.useState)(null),[h,{width:S,height:w}]=Object(X.useResizeObserver)(),[v,k]=Object(c.useState)(g.defaultAspectRatio),x=Object(F.some)(t,(e=>Object(Q.isBlobURL)(e.url))),N=t=>{u(e,t)},_=Object(c.useCallback)((()=>{r||y||g.playInFullscreen&&!d&&i(e,!0)}),[d,r,y]),{onTouchStart:C,onTouchEnd:P}=Ne((t=>{i(e,!t)}),[]),R=Object(c.useCallback)((()=>{m>0&&N(m-1)}),[m]),I=Object(c.useCallback)((()=>{m<t.length-1?N(m+1):a(e)}),[m,t]),T=Object(c.useCallback)((()=>{l(e,!1)}),[]);let L,M;return Object(c.useEffect)((()=>{r&&d&&i(e,!1)}),[r,d]),Object(c.useEffect)((()=>{d&&b&&I()}),[d,b]),Object(c.useLayoutEffect)((()=>{if(!E.current)return;let e=Math.round(g.defaultAspectRatio*E.current.offsetHeight);y&&(e=Math.abs(1-e/S)<g.cropUpTo?S:e),j(e)}),[S,w,y]),Object(c.useLayoutEffect)((()=>{O&&E.current&&E.current.offsetHeight>0&&k(O/E.current.offsetHeight)}),[O]),L=y?[Object(Z.__)("You are currently playing a story.","jetpack"),d?Object(Z.__)("Press space to pause.","jetpack"):Object(Z.__)("Press space to play.","jetpack"),Object(Z.__)("Press escape to exit.","jetpack")].join(" "):Object(Z.__)("Play story","jetpack"),M=r?"presentation":y?"dialog":"button",Object(c.createElement)("div",{className:"wp-story-display-contents"},h,Object(c.createElement)("div",{role:M,"aria-label":L,tabIndex:y?-1:0,className:J()("wp-story-container",{"wp-story-with-controls":!r&&!y&&!g.playInFullscreen,"wp-story-fullscreen":y,"wp-story-ended":f,"wp-story-disabled":r,"wp-story-clickable":!r&&!y}),style:{maxWidth:`${O}px`},onClick:_,onTouchStart:C,onTouchEnd:P},Object(c.createElement)(be,K()({},n,{fullscreen:y,onExitFullscreen:T})),Object(c.createElement)("div",{ref:E,className:"wp-story-wrapper"},t.map(((t,n)=>Object(c.createElement)(we,{playerId:e,key:n,media:t,index:n,playing:!r&&d,uploading:x,settings:g,targetAspectRatio:v})))),Object(c.createElement)(ge,{icon:ve.a,slideCount:t.length,showSlideCount:g.showSlideCount,ended:f,hasPrevious:m>0,onPreviousSlide:R,onNextSlide:I}),g.showProgressBar&&Object(c.createElement)(xe,{playerId:e,slides:t,disabled:!y,onSlideSeek:N,maxBullets:y?g.maxBulletsFullscreen:g.maxBullets}),Object(c.createElement)(me,{playing:d,muted:p,onPlayPressed:()=>i(e,!d),onMutePressed:()=>o(e,!p),showMute:(e=>{const n=e<t.length?t[e]:null;return!!n&&("video"===n.type||(n.mime||"").startsWith("video/"))})(m)})),y&&Object(c.createElement)(Ee,{currentMedia:g.blurredBackground&&t.length>m&&t[m]}))}const Ce=window&&window.Element&&window.Element.prototype.hasOwnProperty("attachShadow");function Pe({enabled:e,delegatesFocus:t=!1,mode:n="open",globalStyleElements:r=[],adoptedStyleSheets:l=null,mountOnElement:s=null,children:a}){const[i,o]=Object(c.useState)(null),u=s||i,[d,p]=Object(c.useState)(null),m="string"==typeof r?[...document.querySelectorAll(r)]:r,b=Ce&&e&&m.length>0,f=Object(c.useCallback)((e=>{null!==e&&o(e.parentNode)}),[]);if(Object(c.useEffect)((()=>{if(!u)return;if(u.shadowRoot)return void p(u.shadowRoot);const e=u.attachShadow({delegatesFocus:t,mode:n});l&&(e.adoptedStyleSheets=l),p(e)}),[u]),b&&!d)return s?null:Object(c.createElement)("span",{ref:f});const y=Object(c.createElement)(c.Fragment,null,b&&Object(c.createElement)(Re,{globalStyleElements:m}),a);return b?Object(c.createPortal)(y,d):y}function Re({globalStyleElements:e}){return Object(c.createElement)(c.Fragment,null,e.map((({id:e,tagName:t,attributes:n,innerHTML:r},l)=>"LINK"===t?Object(c.createElement)("link",{key:e||l,id:e,rel:n.rel.value,href:n.href.value}):"STYLE"===t?Object(c.createElement)("style",{key:e||l,id:e},r):void 0)))}function Ie(e){const t=Object(c.useRef)(null),n=Object(c.useRef)(!1),r=Object(c.useRef)(e),l=Object(c.useRef)(e);return l.current=e,Object(c.useLayoutEffect)((()=>{e.forEach(((e,l)=>{const c=r.current[l];"function"==typeof e&&e!==c&&!1===n.current&&(c(null),e(t.current))})),r.current=e}),e),Object(c.useLayoutEffect)((()=>{n.current=!1})),Object(c.useCallback)((e=>{t.current=e,n.current=!0;(e?l.current:r.current).forEach((t=>{"function"==typeof t?t(e):t&&t.hasOwnProperty("current")&&(t.current=e)}))}),[])}function Te({overlayClassName:e,children:t,className:n,focusOnMount:r,shouldCloseOnEsc:l=!0,onRequestClose:s,onKeyDown:i,modalRef:o}){const u=Object(X.useFocusOnMount)(r),d=Object(X.useConstrainedTabbing)(),p=Object(X.useFocusReturn)();return Object(c.createElement)("div",{className:e,onKeyDown:function(e){l&&e.keyCode===a.ESCAPE&&(e.stopPropagation(),s&&s(e)),e.target&&"button"===e.target.tagName.toLowerCase()&&e.keyCode===a.SPACE||i&&i(e)}},Object(c.createElement)("div",{className:n,ref:Ie([d,p,u,o])},t))}const Le=new Set(["alert","status","log","marquee","timer"]);let Me=[],ze=!1;function Fe(e){if(ze)return;const t=document.body.children;Object(F.forEach)(t,(t=>{t!==e&&function(e){const t=e.getAttribute("role");return!("SCRIPT"===e.tagName||e.hasAttribute("aria-hidden")||e.hasAttribute("aria-live")||Le.has(t))}(t)&&(t.setAttribute("aria-hidden","true"),Me.push(t))})),ze=!0}let De,Ae=0;const Ue=()=>{};class Be extends c.Component{constructor(e){super(e),this.prepareDOM()}componentDidMount(){Ae++,1===Ae&&this.openFirstModal()}componentWillUnmount(){Ae--,0===Ae&&this.closeLastModal(),this.cleanDOM()}prepareDOM(){De||(De=document.createElement("div"),document.body.appendChild(De)),this.node=document.createElement("div"),De.appendChild(this.node),this.node.ontouchstart=Ue,this.node.ontouchend=Ue}cleanDOM(){De.removeChild(this.node)}openFirstModal(){Fe(De)}closeLastModal(){ze&&(Object(F.forEach)(Me,(e=>{e.removeAttribute("aria-hidden")})),Me=[],ze=!1)}render(){const{children:e,isOpened:t,shadowDOM:n,...r}=this.props;return Object(c.createElement)(Pe,K()({},n,{mountOnElement:this.node}),t&&Object(c.createElement)(Te,r,e))}}Be.defaultProps={shouldCloseOnEsc:!0,isOpened:!1,focusOnMount:!0};var He=Object(X.withInstanceId)(Be);const qe=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent);function Ge({className:e,fullscreenClassName:t,bodyFullscreenClassName:n,fullscreen:r,shadowDOM:l,onKeyDown:s,onExitFullscreen:a,playerQuerySelector:i,children:o}){const u=Object(c.useRef)(),d=Object(c.useRef)(),[p,m]=Object(c.useState)(null),b=qe&&(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled),f=r&&!b,y=r&&b;return Object(c.useLayoutEffect)((()=>{if(b)r?u.current&&((e,t)=>{if((e.requestFullscreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen).call(e),t){const e=()=>{document.fullscreenElement||(document.removeEventListener("fullscreenchange",e),t())};document.addEventListener("fullscreenchange",e)}})(u.current,a):(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullScreenElement)&&(document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen).call(document);else if(r){if(m([document.documentElement.scrollLeft,document.documentElement.scrollTop]),document.body.classList.add(n),document.getElementsByTagName("html")[0].classList.add(n),d.current){const e=d.current.querySelector(i);e&&e.focus()}}else if(document.body.classList.remove(n),document.getElementsByTagName("html")[0].classList.remove(n),p){window.scrollTo(...p);const e=u.current.querySelector(i);e&&e.focus()}}),[r]),Object(c.createElement)(c.Fragment,null,Object(c.createElement)(Pe,l,Object(c.createElement)("div",{ref:u,className:J()(e,{[t]:y}),onKeyDown:s},!f&&o)),Object(c.createElement)(He,{className:J()(e,{[t]:f}),isOpened:f,onRequestClose:a,shadowDOM:l,onKeyDown:f&&s,focusOnMount:!1,modalRef:d},f&&o))}function Ve({id:e,slides:t,metadata:n,disabled:r,...l}){const i=Object(c.useMemo)((()=>e||Math.random().toString(36)),[e]),{init:o,setEnded:u,setPlaying:d,setFullscreen:p,showSlide:m}=Object(s.useDispatch)("jetpack/story/player"),{playing:b,currentSlideIndex:f,fullscreen:y,isReady:g,playerSettings:E}=Object(s.useSelect)((e=>{const{getCurrentSlideIndex:t,getSettings:n,isFullscreen:r,isPlayerReady:l,isPlaying:c}=e("jetpack/story/player");return l(i)?{playing:c(i),currentSlideIndex:t(i),isReady:!0,fullscreen:r(i),playerSettings:n(i)}:{isReady:!1}}),[i]);Object(c.useEffect)((()=>{g||o(i,{slideCount:t.length,...l})}),[g,i]);const O=Object(c.useCallback)((e=>{switch(e.keyCode){case a.ENTER:if(y)break;case a.SPACE:d(i,!b);break;case a.LEFT:f>0&&m(i,f-1);break;case a.RIGHT:f<t.length-1?m(i,f+1):u(i)}}),[i,f,y,b]),j=Object(c.useCallback)((()=>{p(i,!1)}),[i]);return g?Object(c.createElement)(Ge,{shadowDOM:E.shadowDOM,className:"wp-story-app",fullscreenClassName:"wp-story-fullscreen",bodyFullscreenClassName:"wp-story-in-fullscreen",playerQuerySelector:".wp-story-container",fullscreen:y,onExitFullscreen:j,onKeyDown:O},Object(c.createElement)(_e,{id:i,slides:t,metadata:n,disabled:r})):null}},2:function(e,t){e.exports=window.wp.components},20:function(e,t){e.exports=window.wp.blob},3:function(e,t){e.exports=window.lodash},351:function(e,t,n){},352:function(e,t,n){},38:function(e,t,n){"object"==typeof window&&window.Jetpack_Block_Assets_Base_Url&&window.Jetpack_Block_Assets_Base_Url.url&&(n.p=window.Jetpack_Block_Assets_Base_Url.url)},42:function(e,t,n){"use strict";n.r(t);n(38)},47:function(e,t){e.exports=window.wp.domReady},492:function(e,t,n){n(42),e.exports=n(493)},493:function(e,t,n){"use strict";n.r(t);var r=n(12),l=n.n(r),c=n(0),s=n(47),a=n.n(s),i=n(186);if("undefined"!=typeof window){const e=Array.from(new URLSearchParams(window.location.search).entries()).filter((e=>e[0].startsWith("wp-story-"))).reduce(((e,t)=>{const n=t[0].replace(/^wp-story-/,"").replace(/-([a-z])/g,(e=>e[1].toUpperCase()));try{e[n]=JSON.parse(t[1])}catch(r){e[n]=JSON.parse(`"${t[1]}"`)}return e}),{});a()((function(){const t=[...document.querySelectorAll(":not(#debug-bar-wp-query) .wp-story")];t.forEach((n=>{if("true"===n.getAttribute("data-block-initialized"))return;let r=null;1===t.length&&(r={...e});const s=n.getAttribute("data-settings");if(s)try{r={...r,...JSON.parse(s)}}catch(a){}!function(e,t){"string"==typeof e&&(e=document.querySelectorAll(e));const n=e.querySelector(".wp-story-wrapper"),r=e.querySelector(".wp-story-meta");let s=[];n&&n.children.length>0&&(s=function(e){return[...e.querySelectorAll("li > figure > :first-child")].map((e=>({alt:e.getAttribute("alt")||e.getAttribute("title"),mime:e.getAttribute("data-mime")||e.getAttribute("type"),url:e.getAttribute("src"),id:e.getAttribute("data-id"),type:"img"===e.tagName.toLowerCase()?"image":"video",srcset:e.getAttribute("srcset"),sizes:e.getAttribute("sizes")})))}(n));let a={};r&&r.children.length>0&&(a=function(e){const t=e.querySelector("div:first-child > img"),n=e.querySelector(".wp-story-title"),r=t&&t.src;return{storyTitle:n&&n.innerText,siteIconUrl:r}}(r));const o=function(e){return e.getAttribute("data-id")}(e);Object(c.render)(Object(c.createElement)(i.a,l()({id:o,slides:s,metadata:a,disabled:!1},t)),e)}(n,r)}))}))}},6:function(e,t,n){var r;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function l(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var c=typeof r;if("string"===c||"number"===c)e.push(r);else if(Array.isArray(r)){if(r.length){var s=l.apply(null,r);s&&e.push(s)}}else if("object"===c)if(r.toString===Object.prototype.toString)for(var a in r)n.call(r,a)&&r[a]&&e.push(a);else e.push(r.toString())}}return e.join(" ")}e.exports?(l.default=l,e.exports=l):void 0===(r=function(){return l}.apply(t,[]))||(e.exports=r)}()},7:function(e,t){e.exports=window.wp.data},83:function(e,t,n){"use strict";var r=n(0),l=n(2),c=n(17);const s=Object(c.a)(Object(r.createElement)(l.G,null,Object(r.createElement)(l.Path,{d:"M17 5a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2h9z"}),Object(r.createElement)(l.Path,{d:"M13 4H5a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2z"}),Object(r.createElement)(l.Path,{d:"M7 16h8a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"})));t.a=s}}));